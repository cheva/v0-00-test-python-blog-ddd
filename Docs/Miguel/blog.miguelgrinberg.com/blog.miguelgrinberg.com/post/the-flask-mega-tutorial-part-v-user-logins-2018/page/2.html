<!doctype html>
<html lang="en">
  
<!-- Mirrored from blog.miguelgrinberg.com/post/the-flask-mega-tutorial-part-v-user-logins-2018/page/2 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 22 Oct 2024 09:39:44 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    
  <script type="text/javascript">
    function getPreferredTheme() {
      const storedTheme = localStorage.getItem('theme')
      if (storedTheme) {
        return storedTheme
      }
      return 'auto';
    }

    function setTheme(theme) {
      if (theme === 'auto') {
        theme = window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light'
      }
      document.documentElement.setAttribute('data-bs-theme', theme);
    };

    setTheme(getPreferredTheme());
  </script>
  
    <title>
  
    The Flask Mega-Tutorial Part V: User Logins (2018) - miguelgrinberg.com
  
</title>
  
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="description" content="miguelgrinberg.com">
  <meta name="copyright" content="Copyright (c) 2012-2024 Miguel Grinberg">
  <meta name="author" content="Miguel Grinberg">
  
  <meta name="keywords" content="programming, security, password, python, flask, flask-login, tokens">
  
  
  <link rel="canonical" href="../../the-flask-mega-tutorial-part-v-user-logins-2018.html">
  

  
    <link href="../../../../cdn.jsdelivr.net/npm/bootstrap%405.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
  <link rel="preconnect" href="https://fonts.googleapis.com/">
  <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400&amp;display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@700&amp;display=swap" rel="stylesheet">

  <link href="../../../static/tomorrow.min.css" type="text/css" rel="stylesheet" />
  <link href="../../../static/tomorrow-night.min.css" type="text/css" rel="stylesheet" />
  <link href="../../../static/social.css" rel="stylesheet" type="text/css" />
  <link href="../../../static/style_20231230.css" rel="stylesheet" type="text/css" />

  <link rel="shortcut icon" href="https://blog.miguelgrinberg.com/static/favicon.ico">
  <link rel="alternate" type="application/rss+xml" href="https://blog.miguelgrinberg.com/feed" title="miguelgrinberg.com RSS feed">

    <meta property="og:title" content="The Flask Mega-Tutorial Part V: User Logins (2018)">
    <meta property="og:description" content="(Great news! There is a new version of this tutorial!)This is the fifth installment of the Flask Mega-Tutorial series, in which I&#39;m going to tell you how to create a user login subsystem.For your…">
    <meta property="og:image" content="https://blog.miguelgrinberg.com/static/cards/the-flask-mega-tutorial-part-v-user-logins-2018.jpg">
    <meta property="og:url" content="https://blog.miguelgrinberg.com/post/the-flask-mega-tutorial-part-v-user-logins-2018">
    <meta name="twitter:title" content="The Flask Mega-Tutorial Part V: User Logins (2018)">
    <meta name="twitter:description" content="(Great news! There is a new version of this tutorial!)This is the fifth installment of the Flask Mega-Tutorial series, in which I&#39;m going to tell you how to create a user login subsystem.For your…">
    <meta name="twitter:image" content="https://blog.miguelgrinberg.com/static/cards/the-flask-mega-tutorial-part-v-user-logins-2018.jpg">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@miguelgrinberg">

  </head>
  <body>
    <svg style="display: none" version="2.0">
      <defs>
        <symbol id="icon-theme-auto" xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="bi bi-circle-half" viewBox="0 0 16 16">
          <path d="M8 15A7 7 0 1 0 8 1zm0 1A8 8 0 1 1 8 0a8 8 0 0 1 0 16"/>
        </symbol>
        <symbol id="icon-theme-light" xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="bi bi-brightness-high-fill" viewBox="0 0 16 16">
          <path d="M8 11a3 3 0 1 1 0-6 3 3 0 0 1 0 6m0 1a4 4 0 1 0 0-8 4 4 0 0 0 0 8M8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0m0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13m8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5M3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8m10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0m-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707M4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"/>
        </symbol>
        <symbol id="icon-theme-dark" xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="bi bi-moon-stars-fill" viewBox="0 0 16 16">
          <path d="M6 .278a.768.768 0 0 1 .08.858 7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278"/>
          <path d="M10.794 3.148a.217.217 0 0 1 .412 0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217 0 0 1 0 .412l-1.162.387a1.734 1.734 0 0 0-1.097 1.097l-.387 1.162a.217.217 0 0 1-.412 0l-.387-1.162A1.734 1.734 0 0 0 9.31 6.593l-1.162-.387a.217.217 0 0 1 0-.412l1.162-.387a1.734 1.734 0 0 0 1.097-1.097l.387-1.162zM13.863.099a.145.145 0 0 1 .274 0l.258.774c.115.346.386.617.732.732l.774.258a.145.145 0 0 1 0 .274l-.774.258a1.156 1.156 0 0 0-.732.732l-.258.774a.145.145 0 0 1-.274 0l-.258-.774a1.156 1.156 0 0 0-.732-.732l-.774-.258a.145.145 0 0 1 0-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z"/>
        </symbol>
      </defs>
    </svg>
<nav class="navbar navbar-expand-lg">
  <div class="container">
    <a class="navbar-brand" href="https://blog.miguelgrinberg.com/index">miguelgrinberg.com</a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarCollapse">
      <ul class="navbar-nav me-auto">
        <li class="nav-item"><a class="nav-link" aria-current="page" href="https://blog.miguelgrinberg.com/index">Home</a></li>
        <li class="nav-item"><a class="nav-link" aria-current="page" href="../../my-courses-and-books.html">My Courses and Books</a></li>
        <li class="nav-item"><a class="nav-link" aria-current="page" href="../../hire-me.html">Consulting</a></li>
        <li class="nav-item"><a class="nav-link" aria-current="page" href="../../about-me.html">About Me</a></li>
        
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
            <svg width="20" height="20" version="2.0"><use id="current-theme" href="#icon-theme-light"></svg>
          </a>
          <ul class="dropdown-menu">
            <li>
              <a id="select-theme-light" class="dropdown-item" href="javascript:updateTheme('light')">
                <svg width="16" height="16" version="2.0"><use href="#icon-theme-light"></svg>&nbsp; Light Mode
              </a>
            </li>
            <li>
              <a id="select-theme-dark" class="dropdown-item" href="javascript:updateTheme('dark')">
                <svg width="16" height="16" version="2.0"><use href="#icon-theme-dark"></svg>&nbsp; Dark Mode
              </a>
            </li>
            <li><hr class="dropdown-divider"></li>
            <li>
              <a id="select-theme-auto" class="dropdown-item" href="javascript:updateTheme('auto')">
                <svg width="16" height="16" version="2.0"><use href="#icon-theme-auto"></svg>&nbsp; System Default
              </a>
            </li>
          </ul>
        </li>
        
      </ul>
      <ul class="navbar-nav">
        <li class="nav-item social-icons">
          <a type="application/rss+xml" href="https://blog.miguelgrinberg.com/feed"><img src="../../../static/social/rss.png" alt="RSS Feed" title="RSS Feed" /></a>
          <a href="https://twitter.com/miguelgrinberg"><img src="../../../static/social/twitter.png" alt="Twitter" title="Twitter" /></a>
          <a rel="me" href="https://mstdn.social/@miguelgrinberg"><img src="../../../static/social/mastodon.png" alt="Mastodon" title="Mastodon" /></a>
          <a href="http://github.com/miguelgrinberg"><img src="../../../static/social/github.png" alt="GitHub" title="GitHub" /></a>
          <a href="https://youtube.com/miguelgrinberg"><img src="../../../static/social/youtube.png" alt="YouTube" title="YouTube" /></a>
          <a href="http://www.linkedin.com/in/miguelgrinberg"><img src="../../../static/social/linkedin.png" alt="LinkedIn" title="LinkedIn" /></a>
          <a href="https://patreon.com/miguelgrinberg"><img src="../../../static/social/patreon.png" alt="Patreon" title="Patreon" /></a>
          <!--<a href="https://www.facebook.com/miguelgrinbergblog"><img src="/static/social/facebook.png" alt="Facebook" title="Facebook" /></a>-->
        </li>
      </ul>
    </div>
  </div>
</nav>

<div class="container">
  <div class="row">
    <div class="col-md-8">
      <div id="main">
        
        
        
        
        

<div class="post">

<div class="post-header">
  <h1><a href="../../the-flask-mega-tutorial-part-v-user-logins-2018.html">The Flask Mega-Tutorial Part V: User Logins (2018)</a></h1>
  <h2>
    Posted by
    <form action="https://blog.miguelgrinberg.com/author/Miguel Grinberg" method="POST">
      <input type="submit" class="btn btn-danger btn-sm" value="Miguel Grinberg" />
    </form>
    on
    <button class="btn btn-secondary btn-sm" disabled><span class="flask-moment" data-timestamp="2018-01-02T17:20:33Z" data-function="format" data-format="LL" data-refresh="0" style="display: none">2018-01-02T17:20:33Z</span></button>
    under
    
      <form action="https://blog.miguelgrinberg.com/category/Programming" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Programming" />
      </form>
    
      <form action="https://blog.miguelgrinberg.com/category/Security" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Security" />
      </form>
    
      <form action="https://blog.miguelgrinberg.com/category/Python" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Python" />
      </form>
    
      <form action="https://blog.miguelgrinberg.com/category/Flask" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Flask" />
      </form>
    
    
  </h2>
</div>
<div class="post-body"><p><em>(Great news! There is a <a href="../../the-flask-mega-tutorial-part-i-hello-world.html">new version of this tutorial</a>!)</em></p>
<p>This is the fifth installment of the Flask Mega-Tutorial series, in which I'm going to tell you how to create a user login subsystem.</p>
<p>For your reference, below is a list of the articles in this series.</p>
<ul>
<li><a href="../../the-flask-mega-tutorial-part-i-hello-world-2018.html">Chapter 1: Hello, World!</a></li>
<li><a href="../../the-flask-mega-tutorial-part-ii-templates-2018.html">Chapter 2: Templates</a></li>
<li><a href="../../the-flask-mega-tutorial-part-iii-web-forms-2018.html">Chapter 3: Web Forms</a></li>
<li><a href="../../the-flask-mega-tutorial-part-iv-database-2018.html">Chapter 4: Database</a></li>
<li><a href="../../the-flask-mega-tutorial-part-v-user-logins-2018.html">Chapter 5: User Logins</a> (this article)</li>
<li><a href="../../the-flask-mega-tutorial-part-vi-profile-page-and-avatars-2018.html">Chapter 6: Profile Page and Avatars</a></li>
<li><a href="../../the-flask-mega-tutorial-part-vii-error-handling-2018.html">Chapter 7: Error Handling</a></li>
<li><a href="../../the-flask-mega-tutorial-part-viii-followers-2018.html">Chapter 8: Followers</a></li>
<li><a href="../../the-flask-mega-tutorial-part-ix-pagination-2018.html">Chapter 9: Pagination</a></li>
<li><a href="../../the-flask-mega-tutorial-part-x-email-support-2018.html">Chapter 10: Email Support</a></li>
<li><a href="../../the-flask-mega-tutorial-part-xi-facelift-2018.html">Chapter 11: Facelift</a></li>
<li><a href="../../the-flask-mega-tutorial-part-xii-dates-and-times-2018.html">Chapter 12: Dates and Times</a></li>
<li><a href="../../the-flask-mega-tutorial-part-xiii-i18n-and-l10n-2018.html">Chapter 13: I18n and L10n</a></li>
<li><a href="../../the-flask-mega-tutorial-part-xiv-ajax-2018.html">Chapter 14: Ajax</a></li>
<li><a href="../../the-flask-mega-tutorial-part-xv-a-better-application-structure-2018.html">Chapter 15: A Better Application Structure</a></li>
<li><a href="../../the-flask-mega-tutorial-part-xvi-full-text-search-2018.html">Chapter 16: Full-Text Search</a></li>
<li><a href="../../the-flask-mega-tutorial-part-xvii-deployment-on-linux-2018.html">Chapter 17: Deployment on Linux</a></li>
<li><a href="../../the-flask-mega-tutorial-part-xviii-deployment-on-heroku-2018.html">Chapter 18: Deployment on Heroku</a></li>
<li><a href="../../the-flask-mega-tutorial-part-xix-deployment-on-docker-containers-2018.html">Chapter 19: Deployment on Docker Containers</a></li>
<li><a href="../../the-flask-mega-tutorial-part-xx-some-javascript-magic-2018.html">Chapter 20: Some JavaScript Magic</a></li>
<li><a href="../../the-flask-mega-tutorial-part-xxi-user-notifications-2018.html">Chapter 21: User Notifications</a></li>
<li><a href="../../the-flask-mega-tutorial-part-xxii-background-jobs-2018.html">Chapter 22: Background Jobs</a></li>
<li><a href="../../the-flask-mega-tutorial-part-xxiii-application-programming-interfaces-apis-2018.html">Chapter 23: Application Programming Interfaces (APIs)</a></li>
</ul>
<p>In <a href="../../the-flask-mega-tutorial-part-iii-web-forms-2018.html">Chapter 3</a> you learned how to create the user login form, and in <a href="../../the-flask-mega-tutorial-part-iv-database-2018.html">Chapter 4</a> you learned how to work with a database. This chapter will teach you how to combine the topics from those two chapters to create a simple user login system.</p>
<p><em>The GitHub links for this chapter are: <a href="https://github.com/miguelgrinberg/microblog/tree/v0.5">Browse</a>, <a href="https://github.com/miguelgrinberg/microblog-2018/archive/v0.5.zip">Zip</a>, <a href="../../../../github.com/miguelgrinberg/microblog/compare/v0.4...v0.html">Diff</a>.</em></p>
<h2>Password Hashing</h2>
<p>In <a href="../../the-flask-mega-tutorial-part-iv-database-2018.html">Chapter 4</a> the user model was given a <code>password_hash</code> field, that so far is unused. The purpose of this field is to hold a hash of the user password, which will be used to verify the password entered by the user during the log in process. Password hashing is a complicated topic that should be left to security experts, but there are several easy to use libraries that implement all that logic in a way that is simple to be invoked from an application.</p>
<p>One of the packages that implement password hashing is <a href="http://werkzeug.pocoo.org/">Werkzeug</a>, which you may have seen referenced in the output of pip when you install Flask, since it is one of its core dependencies. Since it is a dependency, Werkzeug is already installed in your virtual environment. The following Python shell session demonstrates how to hash a password:</p>
<pre><code class="language-python">&gt;&gt;&gt; from werkzeug.security import generate_password_hash
&gt;&gt;&gt; hash = generate_password_hash('foobar')
&gt;&gt;&gt; hash
'pbkdf2:sha256:50000$vT9fkZM8$04dfa35c6476acf7e788a1b5b3c35e217c78dc04539d295f011f01f18cd2'
</code></pre>
<p>In this example, the password <code>foobar</code> is transformed into a long encoded string through a series of cryptographic operations that have no known reverse operation, which means that a person that obtains the hashed password will be unable to use it to obtain the original password. As an additional measure, if you hash the same password multiple times, you will get different results, so this makes it impossible to identify if two users have the same password by looking at their hashes.</p>
<p>The verification process is done with a second function from Werkzeug, as follows:</p>
<pre><code class="language-python">&gt;&gt;&gt; from werkzeug.security import check_password_hash
&gt;&gt;&gt; check_password_hash(hash, 'foobar')
True
&gt;&gt;&gt; check_password_hash(hash, 'barfoo')
False
</code></pre>
<p>The verification function takes a password hash that was previously generated, and a password entered by the user at the time of log in. The function returns <code>True</code> if the password provided by the user matches the hash, or <code>False</code> otherwise.</p>
<p>The whole password hashing logic can be implemented as two new methods in the user model:</p>
<p class="code_title"><i>app/models.py</i>: Password hashing and verification</p>

<pre><code class="language-python">from werkzeug.security import generate_password_hash, check_password_hash

# ...

class User(db.Model):
    # ...

    def set_password(self, password):
        self.password_hash = generate_password_hash(password)

    def check_password(self, password):
        return check_password_hash(self.password_hash, password)
</code></pre>
<p>With these two methods in place, a user object is now able to do secure password verification, without the need to ever store original passwords. Here is an example usage of these new methods:</p>
<pre><code class="language-python">&gt;&gt;&gt; u = User(username='susan', email='susan@example.com')
&gt;&gt;&gt; u.set_password('mypassword')
&gt;&gt;&gt; u.check_password('anotherpassword')
False
&gt;&gt;&gt; u.check_password('mypassword')
True
</code></pre>
<h2>Introduction to Flask-Login</h2>
<p>In this chapter I'm going to introduce you to a very popular Flask extension called <a href="https://flask-login.readthedocs.io/">Flask-Login</a>. This extension manages the user logged-in state, so that for example users can log in to the application and then navigate to different pages while the application "remembers" that the user is logged in. It also provides the "remember me" functionality that allows users to remain logged in even after closing the browser window. To be ready for this chapter, you can start by installing Flask-Login in your virtual environment:</p>
<pre><code>(venv) $ pip install flask-login
</code></pre>
<p>As with other extensions, Flask-Login needs to be created and initialized right after the application instance in <em>app/__init__.py</em>. This is how this extension is initialized:</p>
<p class="code_title"><i>app/__init__.py</i>: Flask-Login initialization</p>

<pre><code class="language-python"># ...
from flask_login import LoginManager

app = Flask(__name__)
# ...
login = LoginManager(app)

# ...
</code></pre>
<h2>Preparing The User Model for Flask-Login</h2>
<p>The Flask-Login extension works with the application's user model, and expects certain properties and methods to be implemented in it. This approach is nice, because as long as these required items are added to the model, Flask-Login does not have any other requirements, so for example, it can work with user models that are based on any database system.</p>
<p>The four required items are listed below:</p>
<ul>
<li><code>is_authenticated</code>: a property that is <code>True</code> if the user has valid credentials or <code>False</code> otherwise.</li>
<li><code>is_active</code>: a property that is <code>True</code> if the user's account is active or <code>False</code> otherwise.</li>
<li><code>is_anonymous</code>: a property that is <code>False</code> for regular users, and <code>True</code> for a special, anonymous user.</li>
<li><code>get_id()</code>: a method that returns a unique identifier for the user as a string (unicode, if using Python 2).</li>
</ul>
<p>I can implement these four easily, but since the implementations are fairly generic, Flask-Login provides a <em>mixin</em> class called <code>UserMixin</code> that includes generic implementations that are appropriate for most user model classes. Here is how the mixin class is added to the model:</p>
<p class="code_title"><i>app/models.py</i>: Flask-Login user mixin class</p>

<pre><code class="language-python"># ...
from flask_login import UserMixin

class User(UserMixin, db.Model):
    # ...
</code></pre>
<h2>User Loader Function</h2>
<p>Flask-Login keeps track of the logged in user by storing its unique identifier in Flask's <em>user session</em>, a storage space assigned to each user who connects to the application. Each time the logged-in user navigates to a new page, Flask-Login retrieves the ID of the user from the session, and then loads that user into memory. </p>
<p>Because Flask-Login knows nothing about databases, it needs the application's help in loading a user. For that reason, the extension expects that the application will configure a user loader function, that can be called to load a user given the ID. This function can be added in the <em>app/models.py</em> module:</p>
<p class="code_title"><i>app/models.py</i>: Flask-Login user loader function</p>

<pre><code class="language-python">from app import login
# ...

@login.user_loader
def load_user(id):
    return User.query.get(int(id))
</code></pre>
<p>The user loader is registered with Flask-Login with the <code>@login.user_loader</code> decorator. The <code>id</code> that Flask-Login passes to the function as an argument is going to be a string, so databases that use numeric IDs need to convert the string to integer as you see above.</p>
<h2>Logging Users In</h2>
<p>Let's revisit the login view function, which as you recall, implemented a fake login that just issued a <code>flash()</code> message. Now that the application has access to a user database and knows how to generate and verify password hashes, this view function can be completed.</p>
<p class="code_title"><i>app/routes.py</i>: Login view function logic</p>

<pre><code class="language-python"># ...
from flask_login import current_user, login_user
from app.models import User

# ...

@app.route('/login', methods=['GET', 'POST'])
def login():
    if current_user.is_authenticated:
        return redirect(url_for('index'))
    form = LoginForm()
    if form.validate_on_submit():
        user = User.query.filter_by(username=form.username.data).first()
        if user is None or not user.check_password(form.password.data):
            flash('Invalid username or password')
            return redirect(url_for('login'))
        login_user(user, remember=form.remember_me.data)
        return redirect(url_for('index'))
    return render_template('login.html', title='Sign In', form=form)
</code></pre>
<p>The top two lines in the <code>login()</code> function deal with a weird situation. Imagine you have a user that is logged in, and the user navigates to the <em>/login</em> URL of your application. Clearly that is a mistake, so I want to not allow that. The <code>current_user</code> variable comes from Flask-Login and can be used at any time during the handling to obtain the user object that represents the client of the request. The value of this variable can be a user object from the database (which Flask-Login reads through the user loader callback I provided above), or a special anonymous user object if the user did not log in yet. Remember those properties that Flask-Login required in the user object? One of those was <code>is_authenticated</code>, which comes in handy to check if the user is logged in or not. When the user is already logged in, I just redirect to the index page.</p>
<p>In place of the <code>flash()</code> call that I used earlier, now I can log the user in for real. The first step is to load the user from the database. The username came with the form submission, so I can query the database with that to find the user. For this purpose I'm using the <code>filter_by()</code> method of the SQLAlchemy query object. The result of <code>filter_by()</code> is a query that only includes the objects that have a matching username. Since I know there is only going to be one or zero results, I complete the query by calling <code>first()</code>, which will return the user object if it exists, or <code>None</code> if it does not. In <a href="../../the-flask-mega-tutorial-part-iv-database-2018.html">Chapter 4</a> you have seen that when you call the <code>all()</code> method in a query, the query executes and you get a list of all the results that match that query. The <code>first()</code> method is another commonly used way to execute a query, when you only need to have one result.</p>
<p>If I got a match for the username that was provided, I can next check if the password that also came with the form is valid. This is done by invoking the <code>check_password()</code> method I defined above. This will take the password hash stored with the user and determine if the password entered in the form matches the hash or not. So now I have two possible error conditions: the username can be invalid, or the password can be incorrect for the user. In either of those cases, I flash an message, and redirect back to the login prompt so that the user can try again.</p>
<p>If the username and password are both correct, then I call the <code>login_user()</code> function, which comes from Flask-Login. This function will register the user as logged in, so that means that any future pages the user navigates to will have the <code>current_user</code> variable set to that user.</p>
<p>To complete the login process, I just redirect the newly logged-in user to the index page.</p>
<h2>Logging Users Out</h2>
<p>I know I will also need to offer users the option to log out of the application. This can be done with Flask-Login's <code>logout_user()</code> function. Here is the logout view function:</p>
<p class="code_title"><i>app/routes.py</i>: Logout view function</p>

<pre><code class="language-python"># ...
from flask_login import logout_user

# ...

@app.route('/logout')
def logout():
    logout_user()
    return redirect(url_for('index'))
</code></pre>
<p>To expose this link to users, I can make the Login link in the navigation bar automatically switch to a Logout link after the user logs in. This can be done with a conditional in the <em>base.html</em> template:</p>
<p class="code_title"><i>app/templates/base.html</i>: Conditional login and logout links</p>

<pre><code class="language-html">    &lt;div&gt;
        Microblog:
        &lt;a href=&quot;{{ url_for('index') }}&quot;&gt;Home&lt;/a&gt;
        {% if current_user.is_anonymous %}
        &lt;a href=&quot;{{ url_for('login') }}&quot;&gt;Login&lt;/a&gt;
        {% else %}
        &lt;a href=&quot;{{ url_for('logout') }}&quot;&gt;Logout&lt;/a&gt;
        {% endif %}
    &lt;/div&gt;
</code></pre>
<p>The <code>is_anonymous</code> property is one of the attributes that Flask-Login adds to user objects through the <code>UserMixin</code> class. The <code>current_user.is_anonymous</code> expression is going to be <code>True</code> only when the user is not logged in.</p>
<h2>Requiring Users To Login</h2>
<p>Flask-Login provides a very useful feature that forces users to log in before they can view certain pages of the application. If a user who is not logged in tries to view a protected page, Flask-Login will automatically redirect the user to the login form, and only redirect back to the page the user wanted to view after the login process is complete.</p>
<p>For this feature to be implemented, Flask-Login needs to know what is the view function that handles logins. This can be added in <em>app/__init__.py</em>:</p>
<pre><code class="language-python"># ...
login = LoginManager(app)
login.login_view = 'login'
</code></pre>
<p>The <code>'login'</code> value above is the function (or endpoint) name for the login view. In other words, the name you would use in a <code>url_for()</code> call to get the URL.</p>
<p>The way Flask-Login protects a view function against anonymous users is with a decorator called <code>@login_required</code>. When you add this decorator to a view function below the <code>@app.route</code> decorators from Flask, the function becomes protected and will not allow access to users that are not authenticated. Here is how the decorator can be applied to the index view function of the application:</p>
<p class="code_title"><i>app/routes.py</i>: @login\_required decorator</p>

<pre><code class="language-python">from flask_login import login_required

@app.route('/')
@app.route('/index')
@login_required
def index():
    # ...
</code></pre>
<p>What remains is to implement the redirect back from the successful login to the page the user wanted to access. When a user that is not logged in accesses a view function protected with the <code>@login_required</code> decorator, the decorator is going to redirect to the login page, but it is going to include some extra information in this redirect so that the application can then return to the first page. If the user navigates to <em>/index</em>, for example, the <code>@login_required</code> decorator will intercept the request and respond with a redirect to <em>/login</em>, but it will add a query string argument to this URL, making the complete redirect URL <em>/login?next=/index</em>. The <code>next</code> query string argument is set to the original URL, so the application can use that to redirect back after login.</p>
<p>Here is a snippet of code that shows how to read and process the <code>next</code> query string argument:</p>
<p class="code_title"><i>app/routes.py</i>: Redirect to "next" page</p>

<pre><code class="language-python">from flask import request
from werkzeug.urls import url_parse

@app.route('/login', methods=['GET', 'POST'])
def login():
    # ...
    if form.validate_on_submit():
        user = User.query.filter_by(username=form.username.data).first()
        if user is None or not user.check_password(form.password.data):
            flash('Invalid username or password')
            return redirect(url_for('login'))
        login_user(user, remember=form.remember_me.data)
        next_page = request.args.get('next')
        if not next_page or url_parse(next_page).netloc != '':
            next_page = url_for('index')
        return redirect(next_page)
    # ...
</code></pre>
<p>Right after the user is logged in by calling Flask-Login's <code>login_user()</code> function, the value of the <code>next</code> query string argument is obtained. Flask provides a <code>request</code> variable that contains all the information that the client sent with the request. In particular, the <code>request.args</code> attribute exposes the contents of the query string in a friendly dictionary format. There are actually three possible cases that need to be considered to determine where to redirect after a successful login:</p>
<ul>
<li>If the login URL does not have a <code>next</code> argument, then the user is redirected to the index page.</li>
<li>If the login URL includes a <code>next</code> argument that is set to a relative path (or in other words, a URL without the domain portion), then the user is redirected to that URL.</li>
<li>If the login URL includes a <code>next</code> argument that is set to a full URL that includes a domain name, then the user is redirected to the index page.</li>
</ul>
<p>The first and second cases are self-explanatory. The third case is in place to make the application more secure. An attacker could insert a URL to a malicious site in the <code>next</code> argument, so the application only redirects when the URL is relative, which ensures that the redirect stays within the same site as the application. To determine if the URL is relative or absolute, I parse it with Werkzeug's <code>url_parse()</code> function and then check if the <code>netloc</code> component is set or not.</p>
<h2>Showing The Logged In User in Templates</h2>
<p>Do you recall that way back in <a href="../../the-flask-mega-tutorial-part-ii-templates-2018.html">Chapter 2</a> I created a fake user to help me design the home page of the application before the user subsystem was in place? Well, the application has real users now, so I can now remove the fake user and start working with real users. Instead of the fake user I can use Flask-Login's <code>current_user</code> in the template:</p>
<p class="code_title"><i>app/templates/index.html</i>: Pass current user to template</p>

<pre><code class="language-html">{% extends &quot;base.html&quot; %}

{% block content %}
    &lt;h1&gt;Hi, {{ current_user.username }}!&lt;/h1&gt;
    {% for post in posts %}
    &lt;div&gt;&lt;p&gt;{{ post.author.username }} says: &lt;b&gt;{{ post.body }}&lt;/b&gt;&lt;/p&gt;&lt;/div&gt;
    {% endfor %}
{% endblock %}
</code></pre>
<p>And I can remove the <code>user</code> template argument in the view function:</p>
<p class="code_title"><i>app/routes.py</i>: Do not pass user to template anymore</p>

<pre><code class="language-python">@app.route('/')
@app.route('/index')
@login_required
def index():
    # ...
    return render_template(&quot;index.html&quot;, title='Home Page', posts=posts)
</code></pre>
<p>This is a good time to test how the login and logout functionality works. Since there is still no user registration, the only way to add a user to the database is to do it via the Python shell, so run <code>flask shell</code> and enter the following commands to register a user:</p>
<pre><code class="language-python">&gt;&gt;&gt; u = User(username='susan', email='susan@example.com')
&gt;&gt;&gt; u.set_password('cat')
&gt;&gt;&gt; db.session.add(u)
&gt;&gt;&gt; db.session.commit()
</code></pre>
<p>If you start the application and go to the application's <em>/</em> or <em>/index</em> URLs, you will be immediately redirected to the login page, and after you log in using the credentials of the user that you added to your database, you will be returned to the original page, in which you will see a personalized greeting.</p>
<h2>User Registration</h2>
<p>The last piece of functionality that I'm going to build in this chapter is a registration form, so that users can register themselves through a web form. Let's begin by creating the web form class in <em>app/forms.py</em>:</p>
<p class="code_title"><i>app/forms.py</i>: User registration form</p>

<pre><code class="language-python">from flask_wtf import FlaskForm
from wtforms import StringField, PasswordField, BooleanField, SubmitField
from wtforms.validators import ValidationError, DataRequired, Email, EqualTo
from app.models import User

# ...

class RegistrationForm(FlaskForm):
    username = StringField('Username', validators=[DataRequired()])
    email = StringField('Email', validators=[DataRequired(), Email()])
    password = PasswordField('Password', validators=[DataRequired()])
    password2 = PasswordField(
        'Repeat Password', validators=[DataRequired(), EqualTo('password')])
    submit = SubmitField('Register')

    def validate_username(self, username):
        user = User.query.filter_by(username=username.data).first()
        if user is not None:
            raise ValidationError('Please use a different username.')

    def validate_email(self, email):
        user = User.query.filter_by(email=email.data).first()
        if user is not None:
            raise ValidationError('Please use a different email address.')
</code></pre>
<p>There are a couple of interesting things in this new form related to validation. First, for the <code>email</code> field I've added a second validator after <code>DataRequired</code>, called <code>Email</code>. This is another stock validator that comes with WTForms that will ensure that what the user types in this field matches the structure of an email address.</p>
<p>The <code>Email()</code> validator from WTForms requires an external dependency to be installed:</p>
<pre><code>(venv) $ pip install email-validator
</code></pre>
<p>Since this is a registration form, it is customary to ask the user to type the password two times to reduce the risk of a typo. For that reason I have <code>password</code> and <code>password2</code> fields. The second password field uses yet another stock validator called <code>EqualTo</code>, which will make sure that its value is identical to the one for the first password field.</p>
<p>When you add any methods that match the pattern <code>validate_&lt;field_name&gt;</code>, WTForms takes those as custom validators and invokes them in addition to the stock validators. I have added two of those methods to this class for the <code>username</code> and <code>email</code> fields.  In this case I want to make sure that the username and email address entered by the user are not already in the database, so these two methods issue database queries expecting there will be no results. In the event a result exists, a validation error is triggered by raising an exception of type <code>ValidationError</code>. The message included as the argument in the exception will be the message that will be displayed next to the field for the user to see.</p>
<p>To display this form on a web page, I need to have an HTML template, which I'm going to store in file <em>app/templates/register.html</em>. This template is constructed similarly to the one for the login form:</p>
<p class="code_title"><i>app/templates/register.html</i>: Registration template</p>

<pre><code class="language-html">{% extends &quot;base.html&quot; %}

{% block content %}
    &lt;h1&gt;Register&lt;/h1&gt;
    &lt;form action=&quot;&quot; method=&quot;post&quot;&gt;
        {{ form.hidden_tag() }}
        &lt;p&gt;
            {{ form.username.label }}&lt;br&gt;
            {{ form.username(size=32) }}&lt;br&gt;
            {% for error in form.username.errors %}
            &lt;span style=&quot;color: red;&quot;&gt;[{{ error }}]&lt;/span&gt;
            {% endfor %}
        &lt;/p&gt;
        &lt;p&gt;
            {{ form.email.label }}&lt;br&gt;
            {{ form.email(size=64) }}&lt;br&gt;
            {% for error in form.email.errors %}
            &lt;span style=&quot;color: red;&quot;&gt;[{{ error }}]&lt;/span&gt;
            {% endfor %}
        &lt;/p&gt;
        &lt;p&gt;
            {{ form.password.label }}&lt;br&gt;
            {{ form.password(size=32) }}&lt;br&gt;
            {% for error in form.password.errors %}
            &lt;span style=&quot;color: red;&quot;&gt;[{{ error }}]&lt;/span&gt;
            {% endfor %}
        &lt;/p&gt;
        &lt;p&gt;
            {{ form.password2.label }}&lt;br&gt;
            {{ form.password2(size=32) }}&lt;br&gt;
            {% for error in form.password2.errors %}
            &lt;span style=&quot;color: red;&quot;&gt;[{{ error }}]&lt;/span&gt;
            {% endfor %}
        &lt;/p&gt;
        &lt;p&gt;{{ form.submit() }}&lt;/p&gt;
    &lt;/form&gt;
{% endblock %}
</code></pre>
<p>The login form template needs a link that sends new users to the registration form, right below the form:</p>
<p class="code_title"><i>app/templates/login.html</i>: Link to registration page</p>

<pre><code class="language-html">    &lt;p&gt;New User? &lt;a href=&quot;{{ url_for('register') }}&quot;&gt;Click to Register!&lt;/a&gt;&lt;/p&gt;
</code></pre>
<p>And finally, I need to write the view function that is going to handle user registrations in <em>app/routes.py</em>:</p>
<p class="code_title"><i>app/routes.py</i>: User registration view function</p>

<pre><code class="language-python">from app import db
from app.forms import RegistrationForm

# ...

@app.route('/register', methods=['GET', 'POST'])
def register():
    if current_user.is_authenticated:
        return redirect(url_for('index'))
    form = RegistrationForm()
    if form.validate_on_submit():
        user = User(username=form.username.data, email=form.email.data)
        user.set_password(form.password.data)
        db.session.add(user)
        db.session.commit()
        flash('Congratulations, you are now a registered user!')
        return redirect(url_for('login'))
    return render_template('register.html', title='Register', form=form)
</code></pre>
<p>And this view function should also be mostly self-explanatory. I first make sure the user that invokes this route is not logged in. The form is handled in the same way as the one for logging in. The logic that is done inside the <code>if validate_on_submit()</code> conditional creates a new user with the username, email and password provided, writes it to the database, and then redirects to the login prompt so that the user can log in.</p>
<p><img alt="Registration Form" src="../../../static/images/mega-tutorial/ch05-register-form.png" /></p>
<p>With these changes, users should be able to create accounts on this application, and log in and out. Make sure you try all the validation features I've added in the registration form to better understand how they work. I am going to revisit the user authentication subsystem in a future chapter to add additional functionality such as to allow the user to reset the password if forgotten. But for now, this is enough to continue building other areas of the application.</p></div>

<div class="card patreon-bar">
  <div class="card-body">
    <h5>Become a Patron!</h5>
    <p class="card-text">Hello, and thank you for visiting my blog! If you enjoyed this article, please consider supporting my work on this blog on <a href="https://patreon.com/miguelgrinberg">Patreon</a>!</p>
    <a href="https://patreon.com/miguelgrinberg" alt="Become a Patron!" title="Become a Patron!"><img src="../../../static/patreon-button.png"></a>
  </div>
</div>


<div class="card social-bar">
  <div class="card-body">
    <h5>Share this post:</h5>
      <!-- Sharingbutton Hacker News -->
      <a class="resp-sharing-button__link" href="https://news.ycombinator.com/submitlink?u=https%3A//blog.miguelgrinberg.com/post/the-flask-mega-tutorial-part-v-user-logins-2018&amp;t=The%20Flask%20Mega-Tutorial%20Part%20V%3A%20User%20Logins%20%282018%29" target="_blank" rel="noopener" aria-label="Hacker News">
        <div class="resp-sharing-button resp-sharing-button--hackernews resp-sharing-button--medium"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 140 140"><path fill-rule="evenodd" d="M60.94 82.314L17 0h20.08l25.85 52.093c.397.927.86 1.888 1.39 2.883.53.994.995 2.02 1.393 3.08.265.4.463.764.596 1.095.13.334.262.63.395.898.662 1.325 1.26 2.618 1.79 3.877.53 1.26.993 2.42 1.39 3.48 1.06-2.254 2.22-4.673 3.48-7.258 1.26-2.585 2.552-5.27 3.877-8.052L103.49 0h18.69L77.84 83.308v53.087h-16.9v-54.08z"></path></svg></div>Hacker News</div>
      </a>

      <!-- Sharingbutton Reddit -->
      <a class="resp-sharing-button__link" href="https://reddit.com/submit/?url=https%3A//blog.miguelgrinberg.com/post/the-flask-mega-tutorial-part-v-user-logins-2018&amp;resubmit=true&amp;title=The%20Flask%20Mega-Tutorial%20Part%20V:%20User%20Logins%20(2018)" target="_blank" rel="noopener" aria-label="Reddit">
        <div class="resp-sharing-button resp-sharing-button--reddit resp-sharing-button--medium"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M24 11.5c0-1.65-1.35-3-3-3-.96 0-1.86.48-2.42 1.24-1.64-1-3.75-1.64-6.07-1.72.08-1.1.4-3.05 1.52-3.7.72-.4 1.73-.24 3 .5C17.2 6.3 18.46 7.5 20 7.5c1.65 0 3-1.35 3-3s-1.35-3-3-3c-1.38 0-2.54.94-2.88 2.22-1.43-.72-2.64-.8-3.6-.25-1.64.94-1.95 3.47-2 4.55-2.33.08-4.45.7-6.1 1.72C4.86 8.98 3.96 8.5 3 8.5c-1.65 0-3 1.35-3 3 0 1.32.84 2.44 2.05 2.84-.03.22-.05.44-.05.66 0 3.86 4.5 7 10 7s10-3.14 10-7c0-.22-.02-.44-.05-.66 1.2-.4 2.05-1.54 2.05-2.84zM2.3 13.37C1.5 13.07 1 12.35 1 11.5c0-1.1.9-2 2-2 .64 0 1.22.32 1.6.82-1.1.85-1.92 1.9-2.3 3.05zm3.7.13c0-1.1.9-2 2-2s2 .9 2 2-.9 2-2 2-2-.9-2-2zm9.8 4.8c-1.08.63-2.42.96-3.8.96-1.4 0-2.74-.34-3.8-.95-.24-.13-.32-.44-.2-.68.15-.24.46-.32.7-.18 1.83 1.06 4.76 1.06 6.6 0 .23-.13.53-.05.67.2.14.23.06.54-.18.67zm.2-2.8c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm5.7-2.13c-.38-1.16-1.2-2.2-2.3-3.05.38-.5.97-.82 1.6-.82 1.1 0 2 .9 2 2 0 .84-.53 1.57-1.3 1.87z"/></svg></div>Reddit</div>
      </a>

      <!-- Sharingbutton Twitter -->
      <a class="resp-sharing-button__link" href="https://twitter.com/intent/tweet/?text=The%20Flask%20Mega-Tutorial%20Part%20V%3A%20User%20Logins%20%282018%29&amp;url=https%3A//blog.miguelgrinberg.com/post/the-flask-mega-tutorial-part-v-user-logins-2018" target="_blank" rel="noopener" aria-label="Twitter">
        <div class="resp-sharing-button resp-sharing-button--twitter resp-sharing-button--medium"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M23.44 4.83c-.8.37-1.5.38-2.22.02.93-.56.98-.96 1.32-2.02-.88.52-1.86.9-2.9 1.1-.82-.88-2-1.43-3.3-1.43-2.5 0-4.55 2.04-4.55 4.54 0 .36.03.7.1 1.04-3.77-.2-7.12-2-9.36-4.75-.4.67-.6 1.45-.6 2.3 0 1.56.8 2.95 2 3.77-.74-.03-1.44-.23-2.05-.57v.06c0 2.2 1.56 4.03 3.64 4.44-.67.2-1.37.2-2.06.08.58 1.8 2.26 3.12 4.25 3.16C5.78 18.1 3.37 18.74 1 18.46c2 1.3 4.4 2.04 6.97 2.04 8.35 0 12.92-6.92 12.92-12.93 0-.2 0-.4-.02-.6.9-.63 1.96-1.22 2.56-2.14z"/></svg></div>Twitter</div>
      </a>

      <!-- Sharingbutton LinkedIn -->
      <a class="resp-sharing-button__link" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3A//blog.miguelgrinberg.com/post/the-flask-mega-tutorial-part-v-user-logins-2018&amp;title=The%20Flask%20Mega-Tutorial%20Part%20V%3A%20User%20Logins%20%282018%29&amp;summary=The%20Flask%20Mega-Tutorial%20Part%20V%3A%20User%20Logins%20%282018%29&amp;source=https%3A//blog.miguelgrinberg.com/post/the-flask-mega-tutorial-part-v-user-logins-2018" target="_blank" rel="noopener" aria-label="LinkedIn">
        <div class="resp-sharing-button resp-sharing-button--linkedin resp-sharing-button--medium"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M6.5 21.5h-5v-13h5v13zM4 6.5C2.5 6.5 1.5 5.3 1.5 4s1-2.4 2.5-2.4c1.6 0 2.5 1 2.6 2.5 0 1.4-1 2.5-2.6 2.5zm11.5 6c-1 0-2 1-2 2v7h-5v-13h5V10s1.6-1.5 4-1.5c3 0 5 2.2 5 6.3v6.7h-5v-7c0-1-1-2-2-2z"/></svg></div>LinkedIn</div>
      </a>

      <!-- Sharingbutton Facebook -->
      <a class="resp-sharing-button__link" href="https://facebook.com/sharer/sharer.php?u=https%3A//blog.miguelgrinberg.com/post/the-flask-mega-tutorial-part-v-user-logins-2018" target="_blank" rel="noopener" aria-label="Facebook">
        <div class="resp-sharing-button resp-sharing-button--facebook resp-sharing-button--medium"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18.77 7.46H14.5v-1.9c0-.9.6-1.1 1-1.1h3V.5h-4.33C10.24.5 9.5 3.44 9.5 5.32v2.15h-3v4h3v12h5v-12h3.85l.42-4z"/></svg></div>Facebook</div>
      </a>

      <!-- Sharingbutton E-Mail -->
      <a class="resp-sharing-button__link" href="mailto:?subject=The%20Flask%20Mega-Tutorial%20Part%20V%3A%20User%20Logins%20%282018%29&amp;body=https%3A//blog.miguelgrinberg.com/post/the-flask-mega-tutorial-part-v-user-logins-2018" target="_self" rel="noopener" aria-label="E-Mail">
        <div class="resp-sharing-button resp-sharing-button--email resp-sharing-button--medium"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M22 4H2C.9 4 0 4.9 0 6v12c0 1.1.9 2 2 2h20c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zM7.25 14.43l-3.5 2c-.08.05-.17.07-.25.07-.17 0-.34-.1-.43-.25-.14-.24-.06-.55.18-.68l3.5-2c.24-.14.55-.06.68.18.14.24.06.55-.18.68zm4.75.07c-.1 0-.2-.03-.27-.08l-8.5-5.5c-.23-.15-.3-.46-.15-.7.15-.22.46-.3.7-.14L12 13.4l8.23-5.32c.23-.15.54-.08.7.15.14.23.07.54-.16.7l-8.5 5.5c-.08.04-.17.07-.27.07zm8.93 1.75c-.1.16-.26.25-.43.25-.08 0-.17-.02-.25-.07l-3.5-2c-.24-.13-.32-.44-.18-.68s.44-.32.68-.18l3.5 2c.24.13.32.44.18.68z"/></svg></div>E-Mail</div>
      </a>

  </div>
</div>

<div id="comments" class="post-comment-count">
  
  <a class="btn btn-outline-secondary" href="../../the-flask-mega-tutorial-part-v-user-logins-2018.html#comments">617 comments</a>
  
</div>


<div class="comments">
  <ul>
    
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/729e26a2a2c7ff24a71958d4aa4e5f35?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#26</span> <span class="badge text-bg-danger">Miguel Grinberg</span> said
    
    <span class="flask-moment" data-timestamp="2018-01-24T00:52:57Z" data-function="fromNow" data-refresh="0" style="display: none">2018-01-24T00:52:57Z</span>
  </p>
  <div>
    <p>@alex: yes, that is a valid implementation. For a login form, however, I prefer to clean everything up on a failure. You'll see later in later chapters that for other forms validation errors do not trigger a redirect, specifically for the purpose of preserving the field contents.</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/91cb186b325777b853a1e6d77fd1ff1b?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#27</span> <span class="badge text-bg-warning">chutianshu</span> said
    
    <span class="flask-moment" data-timestamp="2018-01-25T08:58:47Z" data-function="fromNow" data-refresh="0" style="display: none">2018-01-25T08:58:47Z</span>
  </p>
  <div>
    <p>Hello Miguel</p>
<p>The validation you use in this article is server-validate, in flask ,is there any easy way to use both client &amp; server valiate together？</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/729e26a2a2c7ff24a71958d4aa4e5f35?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#28</span> <span class="badge text-bg-danger">Miguel Grinberg</span> said
    
    <span class="flask-moment" data-timestamp="2018-01-25T16:56:10Z" data-function="fromNow" data-refresh="0" style="display: none">2018-01-25T16:56:10Z</span>
  </p>
  <div>
    <p>@chutianshu: Some of the validators from WTForms have a client-side component as well, at least in some browsers. The DataRequired validator for example, generates client-side validation as well. If you need something more involved than that, then you'll have to implement client-side validation in addition to the server-side validation, using a JS validation framework.</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/999ea65eaa34f65774ae3eb725fda897?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#29</span> <span class="badge text-bg-warning">ushills</span> said
    
    <span class="flask-moment" data-timestamp="2018-01-26T23:19:14Z" data-function="fromNow" data-refresh="0" style="display: none">2018-01-26T23:19:14Z</span>
  </p>
  <div>
    <p>for some reason I keep getting the following error:</p>
<p><a href="http://pysqlite.py/" rel="nofollow">pysqlite.py</a>", line 334, in dbapi<br>
    from pysqlite2 import dbapi2 as sqlite<br>
ModuleNotFoundError: No module named 'pysqlite2'</p>
<p>at this stage:</p>
<blockquote>
<blockquote>
<blockquote>
<p>u = User(username='susan', email='susan@example.com')<br>
u.set_password('cat')<br>
db.session.add(u)<br>
db.session.commit()</p>
</blockquote>
</blockquote>
</blockquote>
<p>No idea why!</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/729e26a2a2c7ff24a71958d4aa4e5f35?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#30</span> <span class="badge text-bg-danger">Miguel Grinberg</span> said
    
    <span class="flask-moment" data-timestamp="2018-01-28T00:17:26Z" data-function="fromNow" data-refresh="0" style="display: none">2018-01-28T00:17:26Z</span>
  </p>
  <div>
    <p>@ushills: I think this occurs when you are using a version of Python that was compiled without sqlite support. If you compiled your Python yourself, install the sqlite development libraries and then recompile Python.</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/0c4925847890d9169f1243acb5123b2f?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#31</span> <span class="badge text-bg-warning">rohit tanwar</span> said
    
    <span class="flask-moment" data-timestamp="2018-01-29T09:39:18Z" data-function="fromNow" data-refresh="0" style="display: none">2018-01-29T09:39:18Z</span>
  </p>
  <div>
    <p>Thanks for the awesome tutorial!</p>
<p>I am posting this same comment the third time. People who commented after me got their comments published but not me :( . If I am getting rejected please atleast send a e-mail saying so.</p>
<p>I want to know how can I add login with google/twitter/facebook or anything else on the microblog. </p>
<p>Thanks again for the tutorial :)</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/729e26a2a2c7ff24a71958d4aa4e5f35?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#32</span> <span class="badge text-bg-danger">Miguel Grinberg</span> said
    
    <span class="flask-moment" data-timestamp="2018-01-29T21:38:49Z" data-function="fromNow" data-refresh="0" style="display: none">2018-01-29T21:38:49Z</span>
  </p>
  <div>
    <p>@rohit: Weird, I have not seen any comments from you before this one. I have blogged about OAuth authentication in the past, see <a href="../../oauth-authentication-with-flask.html" rel="nofollow">https://blog.miguelgrinberg.com/post/oauth-authentication-with-flask</a>.</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/46581aef5c539d421331d2922c630d53?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#33</span> <span class="badge text-bg-warning">rp</span> said
    
    <span class="flask-moment" data-timestamp="2018-02-14T03:04:50Z" data-function="fromNow" data-refresh="0" style="display: none">2018-02-14T03:04:50Z</span>
  </p>
  <div>
    <p>seems to me if i'm following right that by this point you'll also want a 'if not current_user.is_anonymous' on the index.html template, else you'll get 'Hello, !' displayed when the user is logged out, as current_user.username is blank.</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/729e26a2a2c7ff24a71958d4aa4e5f35?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#34</span> <span class="badge text-bg-danger">Miguel Grinberg</span> said
    
    <span class="flask-moment" data-timestamp="2018-02-14T06:29:52Z" data-function="fromNow" data-refresh="0" style="display: none">2018-02-14T06:29:52Z</span>
  </p>
  <div>
    <p>@rp: The login_required decorator prevents the index route to be accessed by anonymous users.</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/268519d0ce2ee03dd717c4937a8ba6cf?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#35</span> <span class="badge text-bg-warning">jf</span> said
    
    <span class="flask-moment" data-timestamp="2018-02-18T21:44:26Z" data-function="fromNow" data-refresh="0" style="display: none">2018-02-18T21:44:26Z</span>
  </p>
  <div>
    <p>Great teaching, Miguel.  Thanks a lot.</p>
<p>I am running this all in Pycharm and it has worked perfectly, but now Ctrl-C doesn't seem to exit the app anymore.  Instead, after a very long delay, I get the following (apologies for the length):</p>
<p>(venv) C:\Users\jonat\PycharmProjects\untitled&gt;flask run<br>
 * Serving Flask app "microblog"<br>
 * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)<br>
127.0.0.1 - - [18/Feb/2018 16:23:25] "GET / HTTP/1.1" 200 -<br>
127.0.0.1 - - [18/Feb/2018 16:23:32] "GET /logout HTTP/1.1" 302 -<br>
127.0.0.1 - - [18/Feb/2018 16:23:32] "GET /index HTTP/1.1" 302 -<br>
127.0.0.1 - - [18/Feb/2018 16:23:32] "GET /login?next=%2Findex HTTP/1.1" 200 -<br>
127.0.0.1 - - [18/Feb/2018 16:23:48] "POST /login?next=%2Findex HTTP/1.1" 302 -<br>
127.0.0.1 - - [18/Feb/2018 16:23:48] "GET /login HTTP/1.1" 200 -<br>
127.0.0.1 - - [18/Feb/2018 16:23:51] "GET /index HTTP/1.1" 302 -<br>
127.0.0.1 - - [18/Feb/2018 16:23:51] "GET /login?next=%2Findex HTTP/1.1" 200 -</p>
&lt;hr /&gt;
<p>Exception happened during processing of request from ('127.0.0.1', 50036)<br>
Traceback (most recent call last):<br>
  File "c:\python27\Lib\<a href="http://socketserver.py/" rel="nofollow">SocketServer.py</a>", line 284, in _handle_request_noblock<br>
    self.process_request(request, client_address)<br>
  File "c:\python27\Lib\<a href="http://socketserver.py/" rel="nofollow">SocketServer.py</a>", line 310, in process_request<br>
    self.finish_request(request, client_address)<br>
  File "c:\python27\Lib\<a href="http://socketserver.py/" rel="nofollow">SocketServer.py</a>", line 323, in finish_request<br>
    self.RequestHandlerClass(request, client_address, self)<br>
  File "c:\python27\Lib\<a href="http://socketserver.py/" rel="nofollow">SocketServer.py</a>", line 639, in <strong>init</strong><br>
 Traceback (most recent call last):<br>
  File "c:\python27\Lib\<a href="http://runpy.py/" rel="nofollow">runpy.py</a>", line 162, in _run_module_as_main<br>
    "<strong>main</strong>", fname, loader, pkg_name)<br>
  File "c:\python27\Lib\<a href="http://runpy.py/" rel="nofollow">runpy.py</a>", line 72, in _run_code<br>
    exec code in run_globals<br>
  File "C:\Users\jonat\PycharmProjects\untitled\venv\Scripts\<a href="http://flask.exe__main__.py/" rel="nofollow">flask.exe__main__.py</a>", line 9, in &lt;module&gt;<br>
  File "c:\users\jonat\pycharmprojects\untitled\venv\lib\site-packages\flask\<a href="http://cli.py/" rel="nofollow">cli.py</a>", line 513, in main<br>
    cli.main(args=args, prog_name=name)<br>
  File "c:\users\jonat\pycharmprojects\untitled\venv\lib\site-packages\flask\<a href="http://cli.py/" rel="nofollow">cli.py</a>", line 380, in main<br>
    return AppGroup.main(self, <em>args, </em><em>kwargs)<br>
  File "c:\users\jonat\pycharmprojects\untitled\venv\lib\site-packages\click\<a href="http://core.py/" rel="nofollow">core.py</a>", line 697, in main<br>
    rv = self.invoke(ctx)<br>
  File "c:\users\jonat\pycharmprojects\untitled\venv\lib\site-packages\click\<a href="http://core.py/" rel="nofollow">core.py</a>", line 1066, in invoke<br>
    return _process_result(sub_ctx.command.invoke(sub_ctx))<br>
  File "c:\users\jonat\pycharmprojects\untitled\venv\lib\site-packages\click\<a href="http://core.py/" rel="nofollow">core.py</a>", line 895, in invoke<br>
    return ctx.invoke(self.callback, </em><em>ctx.params)<br>
  File "c:\users\jonat\pycharmprojects\untitled\venv\lib\site-packages\click\<a href="http://core.py/" rel="nofollow">core.py</a>", line 535, in invoke<br>
    return callback(</em>args, <strong>kwargs)<br>
  File "c:\users\jonat\pycharmprojects\untitled\venv\lib\site-packages\click\<a href="http://decorators.py/" rel="nofollow">decorators.py</a>", line 64, in new_func<br>
    return ctx.invoke(f, obj, *args[1:], </strong>kwargs)<br>
  File "c:\users\jonat\pycharmprojects\untitled\venv\lib\site-packages\click\<a href="http://core.py/" rel="nofollow">core.py</a>", line 535, in invoke<br>
    return callback(<em>args, </em>*kwargs)<br>
  File "c:\users\jonat\pycharmprojects\untitled\venv\lib\site-packages\flask\<a href="http://cli.py/" rel="nofollow">cli.py</a>", line 438, in run_command<br>
    use_debugger=debugger, threaded=with_threads)<br>
  File "c:\users\jonat\pycharmprojects\untitled\venv\lib\site-packages\werkzeug\<a href="http://serving.py/" rel="nofollow">serving.py</a>", line 814, in run_simple<br>
    inner()<br>
  File "c:\users\jonat\pycharmprojects\untitled\venv\lib\site-packages\werkzeug\<a href="http://serving.py/" rel="nofollow">serving.py</a>", line 777, in inner<br>
    srv.serve_forever()<br>
  File "c:\users\jonat\pycharmprojects\untitled\venv\lib\site-packages\werkzeug\<a href="http://serving.py/" rel="nofollow">serving.py</a>", line 612, in serve_forever<br>
    HTTPServer.serve_forever(self)<br>
  File "c:\python27\Lib\<a href="http://socketserver.py/" rel="nofollow">SocketServer.py</a>", line 227, in serve_forever<br>
    self._handle_request_noblock()<br>
  File "c:\python27\Lib\<a href="http://socketserver.py/" rel="nofollow">SocketServer.py</a>", line 286, in _handle_request_noblock<br>
    self.handle_error(request, client_address)<br>
  File "c:\users\jonat\pycharmprojects\untitled\venv\lib\site-packages\werkzeug\<a href="http://serving.py/" rel="nofollow">serving.py</a>", line 621, in handle_error<br>
    return HTTPServer.handle_error(self, request, client_address)<br>
  File "c:\python27\Lib\<a href="http://socketserver.py/" rel="nofollow">SocketServer.py</a>", line 343, in handle_error<br>
    traceback.print_exc() # XXX But this goes to stderr!<br>
  File "c:\python27\Lib\<a href="http://traceback.py/" rel="nofollow">traceback.py</a>", line 232, in print_exc<br>
    print_exception(etype, value, tb, limit, file)<br>
  File "c:\python27\Lib\<a href="http://traceback.py/" rel="nofollow">traceback.py</a>", line 125, in print_exception<br>
    print_tb(tb, limit, file)<br>
  File "c:\python27\Lib\<a href="http://traceback.py/" rel="nofollow">traceback.py</a>", line 70, in print_tb<br>
    if line: _print(file, '    ' + line.strip())<br>
  File "c:\python27\Lib\<a href="http://traceback.py/" rel="nofollow">traceback.py</a>", line 13, in _print<br>
    file.write(str+terminator)<br>
IOError: [Errno 0] Error</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/729e26a2a2c7ff24a71958d4aa4e5f35?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#36</span> <span class="badge text-bg-danger">Miguel Grinberg</span> said
    
    <span class="flask-moment" data-timestamp="2018-02-18T22:25:46Z" data-function="fromNow" data-refresh="0" style="display: none">2018-02-18T22:25:46Z</span>
  </p>
  <div>
    <p>@jf: Sadly, interrupting a web server is a very hard task, and it is not uncommon to see issues with that. If the same application can be interrupted correctly when you start it from a terminal window, then my guess is that this is something that needs to be investigated by Jetbrains.</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/4313118c16765c840bdb5839707a7d59?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#37</span> <span class="badge text-bg-warning">Aditya</span> said
    
    <span class="flask-moment" data-timestamp="2018-02-20T05:00:17Z" data-function="fromNow" data-refresh="0" style="display: none">2018-02-20T05:00:17Z</span>
  </p>
  <div>
    <p>Hello Miguel, <br>
When I login using correct credentials, I get a 200 OK response but still gets redirected back to login page. <br>
Also, when using the next parameter, I am getting <code>Could not build url for endpoint u'/index'</code> error.<br>
Any idea what I might be doing wrong?</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/729e26a2a2c7ff24a71958d4aa4e5f35?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#38</span> <span class="badge text-bg-danger">Miguel Grinberg</span> said
    
    <span class="flask-moment" data-timestamp="2018-02-20T06:03:50Z" data-function="fromNow" data-refresh="0" style="display: none">2018-02-20T06:03:50Z</span>
  </p>
  <div>
    <p>@Aditya: No, I have no way to know what's wrong. You can compare your code against mine on GitHub and find any differences.</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/3c4109ff0943be3b7a7879a5730562f4?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#39</span> <span class="badge text-bg-warning">Carlos</span> said
    
    <span class="flask-moment" data-timestamp="2018-02-20T14:56:43Z" data-function="fromNow" data-refresh="0" style="display: none">2018-02-20T14:56:43Z</span>
  </p>
  <div>
    <p>Hi Miguel. First of all congrats on this exceptional work. I love it so far.<br>
I'm new to flask and I have had a litle touch of python, so consider me to be a complete noob.<br>
I seem to be stuck in part 5, right before user registration. When I run the app, after inserting the user, I get an error when trying to log in with the correct User/Password.</p>
<p>[2018-02-20 13:56:21,606] ERROR in app: Exception on /login [POST]<br>
Traceback (most recent call last):</p>
<p>File "c:\desenvolvimento\python\projects\flask_0\venv\lib\site-packages\flask\<a href="http://app.py/" rel="nofollow">app.py</a>", line 1982, in wsgi_app<br>
    response = self.full_dispatch_request()<br>
  File "c:\desenvolvimento\python\projects\flask_0\venv\lib\site-packages\flask\<a href="http://app.py/" rel="nofollow">app.py</a>", line 1614, in full_dispatch_request<br>
    rv = self.handle_user_exception(e)<br>
  File "c:\desenvolvimento\python\projects\flask_0\venv\lib\site-packages\flask\<a href="http://app.py/" rel="nofollow">app.py</a>", line 1517, in handle_user_exception<br>
    reraise(exc_type, exc_value, tb)<br>
  File "c:\desenvolvimento\python\projects\flask_0\venv\lib\site-packages\<a href="http://flask_compat.py/" rel="nofollow">flask_compat.py</a>", line 33, in reraise<br>
    raise value<br>
  File "c:\desenvolvimento\python\projects\flask_0\venv\lib\site-packages\flask\<a href="http://app.py/" rel="nofollow">app.py</a>", line 1612, in full_dispatch_request<br>
    rv = self.dispatch_request()<br>
  File "c:\desenvolvimento\python\projects\flask_0\venv\lib\site-packages\flask\<a href="http://app.py/" rel="nofollow">app.py</a>", line 1598, in dispatch_request<br>
    return self.view_functions<a href="__req.html" rel="nofollow">rule.endpoint</a><br>
  File "C:\desenvolvimento\Python\projects\flask_0\app\<a href="http://routes.py/" rel="nofollow">routes.py</a>", line 31, in login<br>
    if user is None or not user.check_password(form.password.data):<br>
  File "C:\desenvolvimento\Python\projects\flask_0\app\<a href="http://models.py/" rel="nofollow">models.py</a>", line 20, in check_password<br>
    return check_password_hash(self.password_hash, password)<br>
  File "c:\desenvolvimento\python\projects\flask_0\venv\lib\site-packages\werkzeug\<a href="http://security.py/" rel="nofollow">security.py</a>", line 245, in check_password_hash</p>
<pre><code>if pwhash.count('$') &lt; 2:
</code></pre>
<p>AttributeError: 'NoneType' object has no attribute 'count'<br>
127.0.0.1 - - [20/Feb/2018 13:56:21] "POST /login HTTP/1.1" 500 -</p>
<p>I have already compared my code to yours and everything seems ok. Can you help me please.</p>
<p>Thanks in advance.</p>
<p>Carlos</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/729e26a2a2c7ff24a71958d4aa4e5f35?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#40</span> <span class="badge text-bg-danger">Miguel Grinberg</span> said
    
    <span class="flask-moment" data-timestamp="2018-02-21T00:47:41Z" data-function="fromNow" data-refresh="0" style="display: none">2018-02-21T00:47:41Z</span>
  </p>
  <div>
    <p>@Carlos: the error means that the first argument that you are passing to the check_password_hash() function is None instead of the user's password hash. You are trying to log in with a user that does not have a password set, or you are incorrectly registering the user passwords. I think you need to check your code against mine more carefully.</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/67c373c1da10bc5d93756644b6f1b562?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#41</span> <span class="badge text-bg-warning">Abhishek singh</span> said
    
    <span class="flask-moment" data-timestamp="2018-03-03T18:22:55Z" data-function="fromNow" data-refresh="0" style="display: none">2018-03-03T18:22:55Z</span>
  </p>
  <div>
    <p>i am getting this error</p>
<p>sqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such table: user [SQL: 'SELECT <a href="http://user.id/" rel="nofollow">user.id</a> AS user_id, user.username AS user_username, user.email AS user_email, user.password_hash AS user_password_hash \nFROM user \nWHERE user.username = ?\n LIMIT ? OFFSET ?'] [parameters: ('Abhishek', 1, 0)] (Background on this error at: <a href="http://sqlalche.me/e/e3q8" rel="nofollow">http://sqlalche.me/e/e3q8</a>)</p>
<p>it shows  "no such table"</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/729e26a2a2c7ff24a71958d4aa4e5f35?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#42</span> <span class="badge text-bg-danger">Miguel Grinberg</span> said
    
    <span class="flask-moment" data-timestamp="2018-03-03T19:27:25Z" data-function="fromNow" data-refresh="0" style="display: none">2018-03-03T19:27:25Z</span>
  </p>
  <div>
    <p>@Abhishek: Have you followed the instructions on chapter 4 to set up and create your database?</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/c0860fc9c27bf6e7cc58d7bb6e26c041?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#43</span> <span class="badge text-bg-warning">Mack</span> said
    
    <span class="flask-moment" data-timestamp="2018-03-07T00:42:56Z" data-function="fromNow" data-refresh="0" style="display: none">2018-03-07T00:42:56Z</span>
  </p>
  <div>
    <p>@Carlos: I had a similar issue and I found that I had a mistake in my <a href="http://models.py/" rel="nofollow">models.py</a>. Double check to make sure you aren't missing any variables, etc. My particular issue was forgetting to include 'password'.</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/1d0b90af9e3bfcec72caa64627309871?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#44</span> <span class="badge text-bg-warning">James Dean</span> said
    
    <span class="flask-moment" data-timestamp="2018-03-12T11:11:27Z" data-function="fromNow" data-refresh="0" style="display: none">2018-03-12T11:11:27Z</span>
  </p>
  <div>
    <p>Another thing I just wanted to help point out was that storing a publicly-salted password in the database offers two modes of security:<br>
1) Prevention against 'rainbow table' attacks.<br>
2) Costly in terms of brute-force decryption from the iteration count of the hash (more computational work).</p>
<p>But a major problem with human passwords is their entropy. Even if you require users to have long password with lots of characters various (NIST) estimates put passwords around the very low 21-bit score (a 48-bit password is truly random password from a 64 character alphabet of length 8). Dictionary attacks adapted to the public information about iteration count and salt exploit this.</p>
<p>An additional source of security is to add a 'secret-salt' otherwise called a 'pepper' to your environment variables, and not store it in the database. Then change the code to:</p>
<p>def set_password(self, password):<br>
        pepper = os.environ.get('SECRET_SALT')<br>
        self.password_hash = generate_password_hash(password + pepper)</p>
<pre><code>def check_password(self, password):
    pepper = os.environ.get('SECRET_SALT')
    return check_password_hash(self.password_hash, password + pepper)
</code></pre>
<p>If an attacker only gets access to the database hashes the task of brute forcing the password from the hash is now more difficult since the human password's entropy has effectively been substantially increased by the random string.</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/927031b9f3961b72670c3ea895c00491?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#45</span> <span class="badge text-bg-warning">ogah sunday</span> said
    
    <span class="flask-moment" data-timestamp="2018-03-13T16:45:38Z" data-function="fromNow" data-refresh="0" style="display: none">2018-03-13T16:45:38Z</span>
  </p>
  <div>
    <p>i got this error when i click on the Register button:<br>
ERROR in app: Exception on /register [GET]<br>
Traceback (most recent call last):<br>
  File "/root/ogahslab/venv/lib/python3.6/site-packages/flask/<a href="http://app.py/" rel="nofollow">app.py</a>", line 1982, in wsgi_app<br>
    response = self.full_dispatch_request()<br>
  File "/root/ogahslab/venv/lib/python3.6/site-packages/flask/<a href="http://app.py/" rel="nofollow">app.py</a>", line 1614, in full_dispatch_request<br>
    rv = self.handle_user_exception(e)<br>
  File "/root/ogahslab/venv/lib/python3.6/site-packages/flask/<a href="http://app.py/" rel="nofollow">app.py</a>", line 1517, in handle_user_exception<br>
    reraise(exc_type, exc_value, tb)<br>
  File "/root/ogahslab/venv/lib/python3.6/site-packages/flask/<a href="http://_compat.py/" rel="nofollow">_compat.py</a>", line 33, in reraise<br>
    raise value<br>
  File "/root/ogahslab/venv/lib/python3.6/site-packages/flask/<a href="http://app.py/" rel="nofollow">app.py</a>", line 1612, in full_dispatch_request<br>
    rv = self.dispatch_request()<br>
  File "/root/ogahslab/venv/lib/python3.6/site-packages/flask/<a href="http://app.py/" rel="nofollow">app.py</a>", line 1598, in dispatch_request<br>
    return self.view_functions<a href="__req.html" rel="nofollow">rule.endpoint</a><br>
  File "/root/ogahslab/app/<a href="http://routes.py/" rel="nofollow">routes.py</a>", line 40, in register<br>
    form = RegistrationForm()<br>
  File "/root/ogahslab/venv/lib/python3.6/site-packages/wtforms/<a href="http://form.py/" rel="nofollow">form.py</a>", line 212, in <strong>call</strong><br>
    return type.<strong>call</strong>(cls, <em>args, </em><em>kwargs)<br>
  File "/root/ogahslab/venv/lib/python3.6/site-packages/flask_wtf/<a href="http://form.py/" rel="nofollow">form.py</a>", line 88, in <strong>init</strong><br>
    super(FlaskForm, self).<strong>init</strong>(formdata=formdata, </em><em>kwargs)<br>
  File "/root/ogahslab/venv/lib/python3.6/site-packages/wtforms/<a href="http://form.py/" rel="nofollow">form.py</a>", line 272, in <strong>init</strong><br>
    super(Form, self).<strong>init</strong>(self._unbound_fields, meta=meta_obj, prefix=prefix)<br>
  File "/root/ogahslab/venv/lib/python3.6/site-packages/wtforms/<a href="http://form.py/" rel="nofollow">form.py</a>", line 52, in <strong>init</strong><br>
    field = meta.bind_field(self, unbound_field, options)<br>
  File "/root/ogahslab/venv/lib/python3.6/site-packages/wtforms/<a href="http://meta.py/" rel="nofollow">meta.py</a>", line 27, in bind_field<br>
    return unbound_field.bind(form=form, </em><em>options)<br>
  File "/root/ogahslab/venv/lib/python3.6/site-packages/wtforms/fields/<a href="http://core.py/" rel="nofollow">core.py</a>", line 350, in bind<br>
    return self.field_class(</em>self.args, **kw)<br>
TypeError: <strong>init</strong>() got an unexpected keyword argument 'validator'<br>
127.0.0.1 - - [13/Mar/2018 17:33:13] "GET /register HTTP/1.1" 500 -<br>
how can i go about it</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/729e26a2a2c7ff24a71958d4aa4e5f35?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#46</span> <span class="badge text-bg-danger">Miguel Grinberg</span> said
    
    <span class="flask-moment" data-timestamp="2018-03-13T16:53:06Z" data-function="fromNow" data-refresh="0" style="display: none">2018-03-13T16:53:06Z</span>
  </p>
  <div>
    <p>@ogah: are you using "validator" instead of "validators" in one of your fields?</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/927031b9f3961b72670c3ea895c00491?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#47</span> <span class="badge text-bg-warning">ogah sunday</span> said
    
    <span class="flask-moment" data-timestamp="2018-03-14T10:03:04Z" data-function="fromNow" data-refresh="0" style="display: none">2018-03-14T10:03:04Z</span>
  </p>
  <div>
    <p>everything worked upto this point.<br>
then i try login with unreigtered account or i try to submit registered data, i got this internal error.<br>
please how do i go about it.</p>
<p>127.0.0.1 - - [14/Mar/2018 10:43:30] "POST /register HTTP/1.1" 200 -<br>
[2018-03-14 10:44:16,211] ERROR in app: Exception on /register [POST]<br>
Traceback (most recent call last):<br>
  File "/root/ogahslab/venv/lib/python3.6/site-packages/sqlalchemy/engine/<a href="http://base.py/" rel="nofollow">base.py</a>", line 1193, in _execute_context<br>
    context)<br>
  File "/root/ogahslab/venv/lib/python3.6/site-packages/sqlalchemy/engine/<a href="http://default.py/" rel="nofollow">default.py</a>", line 507, in do_execute<br>
    cursor.execute(statement, parameters)<br>
sqlite3.OperationalError: no such column: user.passsword_hash</p>
<p>The above exception was the direct cause of the following exception:</p>
<p>Traceback (most recent call last):<br>
  File "/root/ogahslab/venv/lib/python3.6/site-packages/flask/<a href="http://app.py/" rel="nofollow">app.py</a>", line 1982, in wsgi_app<br>
    response = self.full_dispatch_request()<br>
  File "/root/ogahslab/venv/lib/python3.6/site-packages/flask/<a href="http://app.py/" rel="nofollow">app.py</a>", line 1614, in full_dispatch_request<br>
    rv = self.handle_user_exception(e)<br>
  File "/root/ogahslab/venv/lib/python3.6/site-packages/flask/<a href="http://app.py/" rel="nofollow">app.py</a>", line 1517, in handle_user_exception<br>
    reraise(exc_type, exc_value, tb)<br>
  File "/root/ogahslab/venv/lib/python3.6/site-packages/flask/<a href="http://_compat.py/" rel="nofollow">_compat.py</a>", line 33, in reraise<br>
    raise value<br>
  File "/root/ogahslab/venv/lib/python3.6/site-packages/flask/<a href="http://app.py/" rel="nofollow">app.py</a>", line 1612, in full_dispatch_request<br>
    rv = self.dispatch_request()<br>
  File "/root/ogahslab/venv/lib/python3.6/site-packages/flask/<a href="http://app.py/" rel="nofollow">app.py</a>", line 1598, in dispatch_request<br>
    return self.view_functions<a href="__req.html" rel="nofollow">rule.endpoint</a><br>
  File "/root/ogahslab/app/<a href="http://routes.py/" rel="nofollow">routes.py</a>", line 50, in register<br>
    if form.validate_on_submit():<br>
  File "/root/ogahslab/venv/lib/python3.6/site-packages/flask_wtf/<a href="http://form.py/" rel="nofollow">form.py</a>", line 101, in validate_on_submit<br>
    return self.is_submitted() and self.validate()<br>
  File "/root/ogahslab/venv/lib/python3.6/site-packages/wtforms/<a href="http://form.py/" rel="nofollow">form.py</a>", line 310, in validate<br>
    return super(Form, self).validate(extra)<br>
  File "/root/ogahslab/venv/lib/python3.6/site-packages/wtforms/<a href="http://form.py/" rel="nofollow">form.py</a>", line 152, in validate<br>
    if not field.validate(self, extra):<br>
  File "/root/ogahslab/venv/lib/python3.6/site-packages/wtforms/fields/<a href="http://core.py/" rel="nofollow">core.py</a>", line 204, in validate<br>
    stop_validation = self._run_validation_chain(form, chain)<br>
  File "/root/ogahslab/venv/lib/python3.6/site-packages/wtforms/fields/<a href="http://core.py/" rel="nofollow">core.py</a>", line 224, in _run_validation_chain<br>
    validator(form, self)<br>
  File "/root/ogahslab/app/<a href="http://forms.py/" rel="nofollow">forms.py</a>", line 23, in validate_username<br>
    user = User.query.filter_by(username=username.data).first()<br>
  File "/root/ogahslab/venv/lib/python3.6/site-packages/sqlalchemy/orm/<a href="http://query.py/" rel="nofollow">query.py</a>", line 2789, in first<br>
    ret = list(self[0:1])<br>
  File "/root/ogahslab/venv/lib/python3.6/site-packages/sqlalchemy/orm/<a href="http://query.py/" rel="nofollow">query.py</a>", line 2581, in <strong>getitem</strong><br>
    return list(res)<br>
  File "/root/ogahslab/venv/lib/python3.6/site-packages/sqlalchemy/orm/<a href="http://query.py/" rel="nofollow">query.py</a>", line 2889, in <strong>iter</strong><br>
    return self._execute_and_instances(context)<br>
  File "/root/ogahslab/venv/lib/python3.6/site-packages/sqlalchemy/orm/<a href="http://query.py/" rel="nofollow">query.py</a>", line 2912, in _execute_and_instances<br>
    result = conn.execute(querycontext.statement, self._params)<br>
  File "/root/ogahslab/venv/lib/python3.6/site-packages/sqlalchemy/engine/<a href="http://base.py/" rel="nofollow">base.py</a>", line 948, in execute<br>
    return meth(self, multiparams, params)<br>
  File "/root/ogahslab/venv/lib/python3.6/site-packages/sqlalchemy/sql/<a href="http://elements.py/" rel="nofollow">elements.py</a>", line 269, in _execute_on_connection<br>
    return connection._execute_clauseelement(self, multiparams, params)<br>
  File "/root/ogahslab/venv/lib/python3.6/site-packages/sqlalchemy/engine/<a href="http://base.py/" rel="nofollow">base.py</a>", line 1060, in _execute_clauseelement<br>
    compiled_sql, distilled_params<br>
  File "/root/ogahslab/venv/lib/python3.6/site-packages/sqlalchemy/engine/<a href="http://base.py/" rel="nofollow">base.py</a>", line 1200, in _execute_context<br>
    context)<br>
  File "/root/ogahslab/venv/lib/python3.6/site-packages/sqlalchemy/engine/<a href="http://base.py/" rel="nofollow">base.py</a>", line 1413, in _handle_dbapi_exception<br>
    exc_info<br>
  File "/root/ogahslab/venv/lib/python3.6/site-packages/sqlalchemy/util/<a href="http://compat.py/" rel="nofollow">compat.py</a>", line 203, in raise_from_cause<br>
    reraise(type(exception), exception, tb=exc_tb, cause=cause)<br>
  File "/root/ogahslab/venv/lib/python3.6/site-packages/sqlalchemy/util/<a href="http://compat.py/" rel="nofollow">compat.py</a>", line 186, in reraise<br>
    raise value.with_traceback(tb)<br>
  File "/root/ogahslab/venv/lib/python3.6/site-packages/sqlalchemy/engine/<a href="http://base.py/" rel="nofollow">base.py</a>", line 1193, in _execute_context<br>
    context)<br>
  File "/root/ogahslab/venv/lib/python3.6/site-packages/sqlalchemy/engine/<a href="http://default.py/" rel="nofollow">default.py</a>", line 507, in do_execute<br>
    cursor.execute(statement, parameters)<br>
sqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such column: user.passsword_hash [SQL: 'SELECT <a href="http://user.id/" rel="nofollow">user.id</a> AS user_id, user.username AS user_username, user.email AS user_email, user.passsword_hash AS user_passsword_hash \nFROM user \nWHERE user.username = ?\n LIMIT ? OFFSET ?'] [parameters: ('fghh', 1, 0)] (Background on this error at: <a href="http://sqlalche.me/e/e3q8" rel="nofollow">http://sqlalche.me/e/e3q8</a>)<br>
127.0.0.1 - - [14/Mar/2018 10:44:16] "POST /register HTTP/1.1" 500 -<br>
127.0.0.1 - - [14/Mar/2018 10:54:35] "GET / HTTP/1.1" 302 -<br>
127.0.0.1 - - [14/Mar/2018 10:54:36] "GET /login?next=%2F HTTP/1.1" 200 -</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/729e26a2a2c7ff24a71958d4aa4e5f35?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#48</span> <span class="badge text-bg-danger">Miguel Grinberg</span> said
    
    <span class="flask-moment" data-timestamp="2018-03-14T16:07:42Z" data-function="fromNow" data-refresh="0" style="display: none">2018-03-14T16:07:42Z</span>
  </p>
  <div>
    <p>@ogah: the error message is fairly clear. You don't have the password_hash column defined in your users table. Did you add that column?</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/927031b9f3961b72670c3ea895c00491?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#49</span> <span class="badge text-bg-warning">Ogah</span> said
    
    <span class="flask-moment" data-timestamp="2018-03-14T16:59:44Z" data-function="fromNow" data-refresh="0" style="display: none">2018-03-14T16:59:44Z</span>
  </p>
  <div>
    <p>Yes. I have it clearly defined</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/729e26a2a2c7ff24a71958d4aa4e5f35?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#50</span> <span class="badge text-bg-danger">Miguel Grinberg</span> said
    
    <span class="flask-moment" data-timestamp="2018-03-14T21:27:26Z" data-function="fromNow" data-refresh="0" style="display: none">2018-03-14T21:27:26Z</span>
  </p>
  <div>
    <p>@Ogah: you must be wrong, because SQLAlchemy says the column isn't there. Maybe you did not execute the migration that adds that column? I can't really tell you what you did wrong, you need to review your steps because clearly you missed something.</p>
  </div>
</div>
    </li>
    
  </ul>
</div>

<nav aria-label="Page navigation">
  <ul class="pagination justify-content-center">
    <li class="page-item"><a class="page-link" href="1.html#comments">&laquo;&laquo;</a></li>
    <li class="page-item"><a class="page-link" href="1.html#comments">&laquo;</a></li>
    <li class="page-item"><a class="page-link" href="3.html#comments">&raquo;</a></li>
    <li class="page-item"><a class="page-link" href="0.html#comments">&raquo;&raquo;</a></li>
  </ul>
</nav>



<div id="comment-form">
  <h3>Leave a Comment</h3>

  
  
  

  
<form action="#comment-form" method="post">
  <input id="url" name="url" type="hidden" value="">
<input id="csrf_token" name="csrf_token" type="hidden" value="IjQyYjY5YzZlNTcyYjFkMTVlZGRkOWJjYjA3ZmFlYWFiNTg3YmU5ODki.ZxdyOQ.qHoYnTrcie6vwEWwtxcpNPrQOl0">
    
  <div class="mb-3">
    <label class="form-label" for="name">Name</label>
    <div class="input-group has-validation">
      <input class="form-control" id="name" name="name" required type="text" value="">
    </div>
  </div>

    
    
  <div class="mb-3">
    <label class="form-label" for="email">Email</label>
    <div class="input-group has-validation">
      <input class="form-control" id="email" name="email" required type="text" value="">
    </div>
  </div>

    
  <div class="mb-3">
    <label class="form-label" for="comment">Comment</label>
    <div class="input-group has-validation">
      <textarea class="form-control" id="comment" name="comment" required>
</textarea>
    </div>
  </div>

    
  <div class="mb-3">
    <label class="form-label" for="captcha">Captcha</label>
    <div class="input-group has-validation">
      
<script src='https://www.google.com/recaptcha/api.js' async defer></script>
<div class="g-recaptcha" data-sitekey="6Ld5Zs4SAAAAAOY0DOi4r18bgHlEaz41qAoRf__S"></div>

    </div>
  </div>

    
  <input class="btn btn-primary mb-3" id="submit" name="submit" type="submit" value="Submit">

      
</form>

</div>


</div>

      </div>
    </div>
    
    <div class="col-md-4">
      <div id="sidebar">
        
          
  



<div class="card">
  
  
  <div class="card-header">Flask Web Development, 2nd Edition</div>
  <a class="card-book-cover" href="https://amzn.to/3lE2mok">
    <img src="../../../static/flask2e-book-cover-small.png" alt="Flask Web Development, 2nd Edition">
  </a>
  <div class="card-body">
    <p class="card-text">If you want to learn modern web development techniques with Python and Flask, you may find the second edition of my <a href="https://amzn.to/3lE2mok">O'Reilly book</a> useful.</p>
  </div>
  <div class="card-body">
    <a class="card-link" href="https://amzn.to/3lE2mok">Click here to get this Book!</a><br />
  </div>

  
</div>
        
        <div class="card">
  <div class="card-header">About Miguel</div>
  <div class="card-body">
    <img style="float: right; margin: 0px 8px 8px 0px; padding: 4px; border: 1px solid #ccc;" src="../../../static/miguel.jpg" />
    <p class="card-text">Welcome to my blog!</p>
    <p class="card-text">I'm a software engineer and technical writer, currently living in Drogheda, Ireland.</p>
    <p class="card-text">You can also find me on <a href="https://twitter.com/miguelgrinberg">Twitter</a>, <a href="https://mstdn.social/@miguelgrinberg">Mastodon</a>, <a href="https://github.com/miguelgrinberg">Github</a>, <a href="http://www.linkedin.com/in/miguelgrinberg">LinkedIn</a>, <a href="https://youtube.com/miguelgrinberg">YouTube</a>, <a href="https://www.facebook.com/miguelgrinbergblog">Facebook</a> and <a href="https://patreon.com/miguelgrinberg">Patreon</a>.</p>
    <p class="card-text">Thank you for visiting!</p>
  </div>
</div>
        
        <div class="card" id="categories">
  <div class="card-header">Categories</div>
  <div class="card-body">
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/AI/feed"><img src="../../../static/rss-small.png" title="AI RSS Feed" label="AI RSS Feed" alt="AI RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/AI" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="AI" /> <small><em>2</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/AWS/feed"><img src="../../../static/rss-small.png" title="AWS RSS Feed" label="AWS RSS Feed" alt="AWS RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/AWS" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="AWS" /> <small><em>1</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Arduino/feed"><img src="../../../static/rss-small.png" title="Arduino RSS Feed" label="Arduino RSS Feed" alt="Arduino RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Arduino" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Arduino" /> <small><em>7</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Authentication/feed"><img src="../../../static/rss-small.png" title="Authentication RSS Feed" label="Authentication RSS Feed" alt="Authentication RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Authentication" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Authentication" /> <small><em>10</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Blog/feed"><img src="../../../static/rss-small.png" title="Blog RSS Feed" label="Blog RSS Feed" alt="Blog RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Blog" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Blog" /> <small><em>1</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/C++/feed"><img src="../../../static/rss-small.png" title="C++ RSS Feed" label="C++ RSS Feed" alt="C++ RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/C++" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="C++" /> <small><em>5</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/CSS/feed"><img src="../../../static/rss-small.png" title="CSS RSS Feed" label="CSS RSS Feed" alt="CSS RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/CSS" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="CSS" /> <small><em>1</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Cloud/feed"><img src="../../../static/rss-small.png" title="Cloud RSS Feed" label="Cloud RSS Feed" alt="Cloud RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Cloud" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Cloud" /> <small><em>10</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Database/feed"><img src="../../../static/rss-small.png" title="Database RSS Feed" label="Database RSS Feed" alt="Database RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Database" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Database" /> <small><em>22</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Docker/feed"><img src="../../../static/rss-small.png" title="Docker RSS Feed" label="Docker RSS Feed" alt="Docker RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Docker" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Docker" /> <small><em>5</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Filmmaking/feed"><img src="../../../static/rss-small.png" title="Filmmaking RSS Feed" label="Filmmaking RSS Feed" alt="Filmmaking RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Filmmaking" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Filmmaking" /> <small><em>6</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Flask/feed"><img src="../../../static/rss-small.png" title="Flask RSS Feed" label="Flask RSS Feed" alt="Flask RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Flask" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Flask" /> <small><em>126</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Games/feed"><img src="../../../static/rss-small.png" title="Games RSS Feed" label="Games RSS Feed" alt="Games RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Games" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Games" /> <small><em>1</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Heroku/feed"><img src="../../../static/rss-small.png" title="Heroku RSS Feed" label="Heroku RSS Feed" alt="Heroku RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Heroku" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Heroku" /> <small><em>1</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/IoT/feed"><img src="../../../static/rss-small.png" title="IoT RSS Feed" label="IoT RSS Feed" alt="IoT RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/IoT" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="IoT" /> <small><em>8</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/JavaScript/feed"><img src="../../../static/rss-small.png" title="JavaScript RSS Feed" label="JavaScript RSS Feed" alt="JavaScript RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/JavaScript" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="JavaScript" /> <small><em>35</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/MicroPython/feed"><img src="../../../static/rss-small.png" title="MicroPython RSS Feed" label="MicroPython RSS Feed" alt="MicroPython RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/MicroPython" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="MicroPython" /> <small><em>9</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Microdot/feed"><img src="../../../static/rss-small.png" title="Microdot RSS Feed" label="Microdot RSS Feed" alt="Microdot RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Microdot" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Microdot" /> <small><em>1</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Microservices/feed"><img src="../../../static/rss-small.png" title="Microservices RSS Feed" label="Microservices RSS Feed" alt="Microservices RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Microservices" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Microservices" /> <small><em>2</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Movie Reviews/feed"><img src="../../../static/rss-small.png" title="Movie Reviews RSS Feed" label="Movie Reviews RSS Feed" alt="Movie Reviews RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Movie Reviews" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Movie Reviews" /> <small><em>5</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/OpenStack/feed"><img src="../../../static/rss-small.png" title="OpenStack RSS Feed" label="OpenStack RSS Feed" alt="OpenStack RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/OpenStack" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="OpenStack" /> <small><em>1</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Personal/feed"><img src="../../../static/rss-small.png" title="Personal RSS Feed" label="Personal RSS Feed" alt="Personal RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Personal" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Personal" /> <small><em>3</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Photography/feed"><img src="../../../static/rss-small.png" title="Photography RSS Feed" label="Photography RSS Feed" alt="Photography RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Photography" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Photography" /> <small><em>7</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Product Reviews/feed"><img src="../../../static/rss-small.png" title="Product Reviews RSS Feed" label="Product Reviews RSS Feed" alt="Product Reviews RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Product Reviews" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Product Reviews" /> <small><em>2</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Programming/feed"><img src="../../../static/rss-small.png" title="Programming RSS Feed" label="Programming RSS Feed" alt="Programming RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Programming" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Programming" /> <small><em>187</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Project Management/feed"><img src="../../../static/rss-small.png" title="Project Management RSS Feed" label="Project Management RSS Feed" alt="Project Management RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Project Management" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Project Management" /> <small><em>1</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Python/feed"><img src="../../../static/rss-small.png" title="Python RSS Feed" label="Python RSS Feed" alt="Python RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Python" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Python" /> <small><em>169</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/REST/feed"><img src="../../../static/rss-small.png" title="REST RSS Feed" label="REST RSS Feed" alt="REST RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/REST" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="REST" /> <small><em>7</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Rackspace/feed"><img src="../../../static/rss-small.png" title="Rackspace RSS Feed" label="Rackspace RSS Feed" alt="Rackspace RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Rackspace" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Rackspace" /> <small><em>1</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Raspberry Pi/feed"><img src="../../../static/rss-small.png" title="Raspberry Pi RSS Feed" label="Raspberry Pi RSS Feed" alt="Raspberry Pi RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Raspberry Pi" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Raspberry Pi" /> <small><em>8</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/React/feed"><img src="../../../static/rss-small.png" title="React RSS Feed" label="React RSS Feed" alt="React RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/React" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="React" /> <small><em>18</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Robotics/feed"><img src="../../../static/rss-small.png" title="Robotics RSS Feed" label="Robotics RSS Feed" alt="Robotics RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Robotics" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Robotics" /> <small><em>6</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Security/feed"><img src="../../../static/rss-small.png" title="Security RSS Feed" label="Security RSS Feed" alt="Security RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Security" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Security" /> <small><em>12</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Video/feed"><img src="../../../static/rss-small.png" title="Video RSS Feed" label="Video RSS Feed" alt="Video RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Video" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Video" /> <small><em>22</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/WebSocket/feed"><img src="../../../static/rss-small.png" title="WebSocket RSS Feed" label="WebSocket RSS Feed" alt="WebSocket RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/WebSocket" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="WebSocket" /> <small><em>2</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Webcast/feed"><img src="../../../static/rss-small.png" title="Webcast RSS Feed" label="Webcast RSS Feed" alt="Webcast RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Webcast" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Webcast" /> <small><em>3</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Windows/feed"><img src="../../../static/rss-small.png" title="Windows RSS Feed" label="Windows RSS Feed" alt="Windows RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Windows" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Windows" /> <small><em>1</em></small>
      </form>
    </div>
    
  </div>
</div>
        
      </div>
    </div>
    
  </div>
  <div id="footer">
    
    <p>&copy; 2012-<script type="text/javascript">document.write(new Date().getFullYear());</script> by Miguel Grinberg. All rights reserved. <a href="mailto:webmaster _at_ miguelgrinberg _dot_ com">Questions?</a></p>
  </div>
</div>

  
    <script src="../../../../cdn.jsdelivr.net/npm/bootstrap%405.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
  <script type="text/javascript" src="../../../static/prettify.js"></script>
  <script src="../../../../cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.4/moment-with-locales.min.js" integrity="sha512-42PE0rd+wZ2hNXftlM78BSehIGzezNeQuzihiBCvUEB3CVxHvsShF86wBWwQORNxNINlBPuq7rG4WWhNiTVHFg==" crossorigin="anonymous"></script>

<script>
moment.locale("en");
function flask_moment_render(elem) {{
    const timestamp = moment(elem.dataset.timestamp);
    const func = elem.dataset.function;
    const format = elem.dataset.format;
    const timestamp2 = elem.dataset.timestamp2;
    const no_suffix = elem.dataset.nosuffix;
    const units = elem.dataset.units;
    let args = [];
    if (format)
        args.push(format);
    if (timestamp2)
        args.push(moment(timestamp2));
    if (no_suffix)
        args.push(no_suffix);
    if (units)
        args.push(units);
    elem.textContent = timestamp[func].apply(timestamp, args);
    elem.classList.remove('flask-moment');
    elem.style.display = "";
}}
function flask_moment_render_all() {{
    const moments = document.querySelectorAll('.flask-moment');
    moments.forEach(function(moment) {{
        flask_moment_render(moment);
        const refresh = moment.dataset.refresh;
        if (refresh && refresh > 0) {{
            (function(elem, interval) {{
                setInterval(function() {{
                    flask_moment_render(elem);
                }}, interval);
            }})(moment, refresh);
        }}
    }})
}}
document.addEventListener("DOMContentLoaded", flask_moment_render_all);
</script>

  
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-20EHZP9GRZ"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-20EHZP9GRZ');
  </script>
  
  <script type="text/javascript">
    function setThemeUI() {
      document.getElementById('select-theme-auto').classList.remove('active');
      document.getElementById('select-theme-light').classList.remove('active');
      document.getElementById('select-theme-dark').classList.remove('active');
      const theme = getPreferredTheme();
      const actualTheme = document.documentElement.getAttribute('data-bs-theme', 'light');
      document.getElementById('select-theme-' + theme).classList.add('active');
      document.getElementById('current-theme').href.baseVal = `#icon-theme-${actualTheme}`;
    };

    function updateTheme(theme) {
      if (theme === 'auto') {
        localStorage.removeItem('theme')
      }
      else {
        localStorage.setItem('theme', theme)
      }
      setTheme(getPreferredTheme());
    }

    setThemeUI();

    const darkModePreference = window.matchMedia("(prefers-color-scheme: dark)");
    darkModePreference.addEventListener("change", e => {
      if (getPreferredTheme() === 'auto') {
        setTheme('auto');
      }
    });

    document.addEventListener("DOMContentLoaded", () => {
      // add prettyprint class to all <pre><code></code></pre> blocks
      let prettify = false;
      document.querySelectorAll('div.post-body pre code').forEach((code) => {
        code.parentNode.classList.add('prettyprint');
        prettify = true;
      });
      prettyPrint();
    });
  </script>

  </body>

<!-- Mirrored from blog.miguelgrinberg.com/post/the-flask-mega-tutorial-part-v-user-logins-2018/page/2 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 22 Oct 2024 09:39:45 GMT -->
</html>