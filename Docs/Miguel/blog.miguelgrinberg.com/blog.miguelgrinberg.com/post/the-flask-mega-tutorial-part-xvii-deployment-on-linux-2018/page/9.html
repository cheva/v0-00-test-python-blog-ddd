<!doctype html>
<html lang="en">
  
<!-- Mirrored from blog.miguelgrinberg.com/post/the-flask-mega-tutorial-part-xvii-deployment-on-linux-2018/page/9 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 22 Oct 2024 09:46:15 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    
  <script type="text/javascript">
    function getPreferredTheme() {
      const storedTheme = localStorage.getItem('theme')
      if (storedTheme) {
        return storedTheme
      }
      return 'auto';
    }

    function setTheme(theme) {
      if (theme === 'auto') {
        theme = window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light'
      }
      document.documentElement.setAttribute('data-bs-theme', theme);
    };

    setTheme(getPreferredTheme());
  </script>
  
    <title>
  
    The Flask Mega-Tutorial Part XVII: Deployment on Linux (2018) - miguelgrinberg.com
  
</title>
  
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="description" content="miguelgrinberg.com">
  <meta name="copyright" content="Copyright (c) 2012-2024 Miguel Grinberg">
  <meta name="author" content="Miguel Grinberg">
  
  
  <link rel="canonical" href="../../the-flask-mega-tutorial-part-xvii-deployment-on-linux-2018.html">
  

  
    <link href="../../../../cdn.jsdelivr.net/npm/bootstrap%405.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
  <link rel="preconnect" href="https://fonts.googleapis.com/">
  <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400&amp;display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@700&amp;display=swap" rel="stylesheet">

  <link href="../../../static/tomorrow.min.css" type="text/css" rel="stylesheet" />
  <link href="../../../static/tomorrow-night.min.css" type="text/css" rel="stylesheet" />
  <link href="../../../static/social.css" rel="stylesheet" type="text/css" />
  <link href="../../../static/style_20231230.css" rel="stylesheet" type="text/css" />

  <link rel="shortcut icon" href="https://blog.miguelgrinberg.com/static/favicon.ico">
  <link rel="alternate" type="application/rss+xml" href="https://blog.miguelgrinberg.com/feed" title="miguelgrinberg.com RSS feed">

    <meta property="og:title" content="The Flask Mega-Tutorial Part XVII: Deployment on Linux (2018)">
    <meta property="og:description" content="(Great news! There is a new version of this tutorial!)This is the seventeenth installment of the Flask Mega-Tutorial series, in which I&#39;m going to deploy Microblog to a Linux server.For your…">
    <meta property="og:image" content="https://blog.miguelgrinberg.com/static/cards/the-flask-mega-tutorial-part-xvii-deployment-on-linux-2018.jpg">
    <meta property="og:url" content="https://blog.miguelgrinberg.com/post/the-flask-mega-tutorial-part-xvii-deployment-on-linux-2018">
    <meta name="twitter:title" content="The Flask Mega-Tutorial Part XVII: Deployment on Linux (2018)">
    <meta name="twitter:description" content="(Great news! There is a new version of this tutorial!)This is the seventeenth installment of the Flask Mega-Tutorial series, in which I&#39;m going to deploy Microblog to a Linux server.For your…">
    <meta name="twitter:image" content="https://blog.miguelgrinberg.com/static/cards/the-flask-mega-tutorial-part-xvii-deployment-on-linux-2018.jpg">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@miguelgrinberg">

  </head>
  <body>
    <svg style="display: none" version="2.0">
      <defs>
        <symbol id="icon-theme-auto" xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="bi bi-circle-half" viewBox="0 0 16 16">
          <path d="M8 15A7 7 0 1 0 8 1zm0 1A8 8 0 1 1 8 0a8 8 0 0 1 0 16"/>
        </symbol>
        <symbol id="icon-theme-light" xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="bi bi-brightness-high-fill" viewBox="0 0 16 16">
          <path d="M8 11a3 3 0 1 1 0-6 3 3 0 0 1 0 6m0 1a4 4 0 1 0 0-8 4 4 0 0 0 0 8M8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0m0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13m8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5M3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8m10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0m-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707M4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"/>
        </symbol>
        <symbol id="icon-theme-dark" xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="bi bi-moon-stars-fill" viewBox="0 0 16 16">
          <path d="M6 .278a.768.768 0 0 1 .08.858 7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278"/>
          <path d="M10.794 3.148a.217.217 0 0 1 .412 0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217 0 0 1 0 .412l-1.162.387a1.734 1.734 0 0 0-1.097 1.097l-.387 1.162a.217.217 0 0 1-.412 0l-.387-1.162A1.734 1.734 0 0 0 9.31 6.593l-1.162-.387a.217.217 0 0 1 0-.412l1.162-.387a1.734 1.734 0 0 0 1.097-1.097l.387-1.162zM13.863.099a.145.145 0 0 1 .274 0l.258.774c.115.346.386.617.732.732l.774.258a.145.145 0 0 1 0 .274l-.774.258a1.156 1.156 0 0 0-.732.732l-.258.774a.145.145 0 0 1-.274 0l-.258-.774a1.156 1.156 0 0 0-.732-.732l-.774-.258a.145.145 0 0 1 0-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z"/>
        </symbol>
      </defs>
    </svg>
<nav class="navbar navbar-expand-lg">
  <div class="container">
    <a class="navbar-brand" href="https://blog.miguelgrinberg.com/index">miguelgrinberg.com</a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarCollapse">
      <ul class="navbar-nav me-auto">
        <li class="nav-item"><a class="nav-link" aria-current="page" href="https://blog.miguelgrinberg.com/index">Home</a></li>
        <li class="nav-item"><a class="nav-link" aria-current="page" href="../../my-courses-and-books.html">My Courses and Books</a></li>
        <li class="nav-item"><a class="nav-link" aria-current="page" href="../../hire-me.html">Consulting</a></li>
        <li class="nav-item"><a class="nav-link" aria-current="page" href="../../about-me.html">About Me</a></li>
        
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
            <svg width="20" height="20" version="2.0"><use id="current-theme" href="#icon-theme-light"></svg>
          </a>
          <ul class="dropdown-menu">
            <li>
              <a id="select-theme-light" class="dropdown-item" href="javascript:updateTheme('light')">
                <svg width="16" height="16" version="2.0"><use href="#icon-theme-light"></svg>&nbsp; Light Mode
              </a>
            </li>
            <li>
              <a id="select-theme-dark" class="dropdown-item" href="javascript:updateTheme('dark')">
                <svg width="16" height="16" version="2.0"><use href="#icon-theme-dark"></svg>&nbsp; Dark Mode
              </a>
            </li>
            <li><hr class="dropdown-divider"></li>
            <li>
              <a id="select-theme-auto" class="dropdown-item" href="javascript:updateTheme('auto')">
                <svg width="16" height="16" version="2.0"><use href="#icon-theme-auto"></svg>&nbsp; System Default
              </a>
            </li>
          </ul>
        </li>
        
      </ul>
      <ul class="navbar-nav">
        <li class="nav-item social-icons">
          <a type="application/rss+xml" href="https://blog.miguelgrinberg.com/feed"><img src="../../../static/social/rss.png" alt="RSS Feed" title="RSS Feed" /></a>
          <a href="https://twitter.com/miguelgrinberg"><img src="../../../static/social/twitter.png" alt="Twitter" title="Twitter" /></a>
          <a rel="me" href="https://mstdn.social/@miguelgrinberg"><img src="../../../static/social/mastodon.png" alt="Mastodon" title="Mastodon" /></a>
          <a href="http://github.com/miguelgrinberg"><img src="../../../static/social/github.png" alt="GitHub" title="GitHub" /></a>
          <a href="https://youtube.com/miguelgrinberg"><img src="../../../static/social/youtube.png" alt="YouTube" title="YouTube" /></a>
          <a href="http://www.linkedin.com/in/miguelgrinberg"><img src="../../../static/social/linkedin.png" alt="LinkedIn" title="LinkedIn" /></a>
          <a href="https://patreon.com/miguelgrinberg"><img src="../../../static/social/patreon.png" alt="Patreon" title="Patreon" /></a>
          <!--<a href="https://www.facebook.com/miguelgrinbergblog"><img src="/static/social/facebook.png" alt="Facebook" title="Facebook" /></a>-->
        </li>
      </ul>
    </div>
  </div>
</nav>

<div class="container">
  <div class="row">
    <div class="col-md-8">
      <div id="main">
        
        
        
        
        

<div class="post">

<div class="post-header">
  <h1><a href="../../the-flask-mega-tutorial-part-xvii-deployment-on-linux-2018.html">The Flask Mega-Tutorial Part XVII: Deployment on Linux (2018)</a></h1>
  <h2>
    Posted by
    <form action="https://blog.miguelgrinberg.com/author/Miguel Grinberg" method="POST">
      <input type="submit" class="btn btn-danger btn-sm" value="Miguel Grinberg" />
    </form>
    on
    <button class="btn btn-secondary btn-sm" disabled><span class="flask-moment" data-timestamp="2018-03-27T21:30:02Z" data-function="format" data-format="LL" data-refresh="0" style="display: none">2018-03-27T21:30:02Z</span></button>
    under
    
      <form action="https://blog.miguelgrinberg.com/category/Raspberry Pi" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Raspberry Pi" />
      </form>
    
      <form action="https://blog.miguelgrinberg.com/category/Cloud" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Cloud" />
      </form>
    
      <form action="https://blog.miguelgrinberg.com/category/Python" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Python" />
      </form>
    
      <form action="https://blog.miguelgrinberg.com/category/Flask" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Flask" />
      </form>
    
      <form action="https://blog.miguelgrinberg.com/category/Programming" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Programming" />
      </form>
    
    
  </h2>
</div>
<div class="post-body"><p><em>(Great news! There is a <a href="../../the-flask-mega-tutorial-part-i-hello-world.html">new version of this tutorial</a>!)</em></p>
<p>This is the seventeenth installment of the Flask Mega-Tutorial series, in which I'm going to deploy Microblog to a Linux server.</p>
<p>For your reference, below is a list of the articles in this series.</p>
<ul>
<li><a href="../../the-flask-mega-tutorial-part-i-hello-world-2018.html">Chapter 1: Hello, World!</a></li>
<li><a href="../../the-flask-mega-tutorial-part-ii-templates-2018.html">Chapter 2: Templates</a></li>
<li><a href="../../the-flask-mega-tutorial-part-iii-web-forms-2018.html">Chapter 3: Web Forms</a></li>
<li><a href="../../the-flask-mega-tutorial-part-iv-database-2018.html">Chapter 4: Database</a></li>
<li><a href="../../the-flask-mega-tutorial-part-v-user-logins-2018.html">Chapter 5: User Logins</a></li>
<li><a href="../../the-flask-mega-tutorial-part-vi-profile-page-and-avatars-2018.html">Chapter 6: Profile Page and Avatars</a></li>
<li><a href="../../the-flask-mega-tutorial-part-vii-error-handling-2018.html">Chapter 7: Error Handling</a></li>
<li><a href="../../the-flask-mega-tutorial-part-viii-followers-2018.html">Chapter 8: Followers</a></li>
<li><a href="../../the-flask-mega-tutorial-part-ix-pagination-2018.html">Chapter 9: Pagination</a></li>
<li><a href="../../the-flask-mega-tutorial-part-x-email-support-2018.html">Chapter 10: Email Support</a></li>
<li><a href="../../the-flask-mega-tutorial-part-xi-facelift-2018.html">Chapter 11: Facelift</a></li>
<li><a href="../../the-flask-mega-tutorial-part-xii-dates-and-times-2018.html">Chapter 12: Dates and Times</a></li>
<li><a href="../../the-flask-mega-tutorial-part-xiii-i18n-and-l10n-2018.html">Chapter 13: I18n and L10n</a></li>
<li><a href="../../the-flask-mega-tutorial-part-xiv-ajax-2018.html">Chapter 14: Ajax</a></li>
<li><a href="../../the-flask-mega-tutorial-part-xv-a-better-application-structure-2018.html">Chapter 15: A Better Application Structure</a></li>
<li><a href="../../the-flask-mega-tutorial-part-xvi-full-text-search-2018.html">Chapter 16: Full-Text Search</a></li>
<li><a href="../../the-flask-mega-tutorial-part-xvii-deployment-on-linux-2018.html">Chapter 17: Deployment on Linux</a> (this article)</li>
<li><a href="../../the-flask-mega-tutorial-part-xviii-deployment-on-heroku-2018.html">Chapter 18: Deployment on Heroku</a></li>
<li><a href="../../the-flask-mega-tutorial-part-xix-deployment-on-docker-containers-2018.html">Chapter 19: Deployment on Docker Containers</a></li>
<li><a href="../../the-flask-mega-tutorial-part-xx-some-javascript-magic-2018.html">Chapter 20: Some JavaScript Magic</a></li>
<li><a href="../../the-flask-mega-tutorial-part-xxi-user-notifications-2018.html">Chapter 21: User Notifications</a></li>
<li><a href="../../the-flask-mega-tutorial-part-xxii-background-jobs-2018.html">Chapter 22: Background Jobs</a></li>
<li><a href="../../the-flask-mega-tutorial-part-xxiii-application-programming-interfaces-apis-2018.html">Chapter 23: Application Programming Interfaces (APIs)</a></li>
</ul>
<p>In this chapter I'm reaching a milestone in the life of my Microblog application, as I'm going to discuss ways in which the application can be deployed on a production server so that it is accessible to real users.</p>
<p>The topic of deployment is extensive, and for that reason it is impossible to cover all the possible options here. This chapter is dedicated to explore traditional hosting options, and as subjects I'm going to use a dedicated Linux server running Ubuntu, and also the widely popular Raspberry Pi mini-computer. I will cover other options such as cloud and container deployments in later chapters.</p>
<p><em>The GitHub links for this chapter are: <a href="https://github.com/miguelgrinberg/microblog/tree/v0.17">Browse</a>, <a href="https://github.com/miguelgrinberg/microblog-2018/archive/v0.17.zip">Zip</a>, <a href="../../../../github.com/miguelgrinberg/microblog/compare/v0.16...v0.html">Diff</a>.</em></p>
<h2>Traditional Hosting</h2>
<p>When I refer to "traditional hosting", what I mean is that the application is installed manually or through a scripted installer on a stock server machine. The process involves installing the application, its dependencies and a production scale web server and configure the system so that it is secure.</p>
<p>The first question you need to ask when you are about to deploy your own project is where to find a server. These days there are many economic hosting services. For example, for $5 per month, <a href="https://www.digitalocean.com/">Digital Ocean</a>, <a href="https://www.linode.com/">Linode</a>, or <a href="https://amazonlightsail.com/">Amazon Lightsail</a> will rent you a virtualized Linux server in which to run your deployment experiments (Linode and Digital Ocean provision their entry level servers with 1GB of RAM, while Amazon provides only 512MB). If you prefer to practice deployments without spending any money, then <a href="https://www.vagrantup.com/">Vagrant</a> and <a href="https://www.virtualbox.org/">VirtualBox</a> are two tools that combined allow you to create a virtual server similar to the paid ones on your own computer.</p>
<p>As far as operating system choices, from a technical point of view, this application can be deployed on any of the major operating systems, a list which includes a large variety of open-source Linux and BSD distributions, and the commercial OS X and Microsoft Windows (OS X is a hybrid open-source/commercial option as it is based on Darwin, an open-source BSD derivative).</p>
<p>Since OS X and Windows are desktop operating systems that are not optimized to work as servers, I'm going to discard those as candidates. The choice between a Linux or a BSD operating system is largely based on preference, so I'm going to pick the most popular of the two, which is Linux. As far as Linux distributions, once again I'm going to choose by popularity and go with Ubuntu.</p>
<h2>Creating an Ubuntu Server</h2>
<p>If you are interested in doing this deployment along with me, you obviously need a server to work on. I'm going to recommend two options for you to acquire a server, one paid and one free. If you are willing to spend a little bit of money, you can get an account at Digital Ocean, Linode or Amazon Lightsail and create a Ubuntu 20.04 virtual server. You should use the smallest server option, which at the time I'm writing this, costs $5 per month for all three providers. The cost is prorated to the number of hours that you have the server up, so if you create the server, play with it for a few hours and then delete it, you would be paying just cents.</p>
<p>The free alternative is based on a virtual machine that you can run on your own computer. To use this option, install <a href="https://www.vagrantup.com/">Vagrant</a> and <a href="https://www.virtualbox.org/">VirtualBox</a> on your machine, and then create a file named <em>Vagrantfile</em> to describe the specs of your VM with the following contents:</p>
<p class="code_title"><i>Vagrantfile</i>: Vagrant configuration.</p>

<pre><code class="language-ruby">Vagrant.configure(&quot;2&quot;) do |config|
  config.vm.box = &quot;ubuntu/focal64&quot;
  config.vm.network &quot;private_network&quot;, ip: &quot;192.168.33.10&quot;
  config.vm.provider &quot;virtualbox&quot; do |vb|
    vb.memory = &quot;2048&quot;
  end
end
</code></pre>
<p>This file configures a Ubuntu 20.04 server with 2GB of RAM, which you will be able to access from the host computer at IP address 192.168.33.10. To create the server, run the following command:</p>
<pre><code>$ vagrant up
</code></pre>
<p>Consult the Vagrant <a href="https://www.vagrantup.com/docs/cli/">command-line documentation</a> to learn about other options to manage your virtual server.</p>
<h2>Using a SSH Client</h2>
<p>Your server is headless, so you are not going to have a desktop on it like you have on your own computer. You are going to connect to your server through a SSH client and work on it through the command-line. If you are using Linux or Mac OS X, you likely have <a href="http://www.openssh.org/">OpenSSH</a> already installed. If you are using Microsoft Windows, <a href="https://www.cygwin.com/">Cygwin</a>, <a href="https://git-scm.com/">Git</a>, and the <a href="https://msdn.microsoft.com/en-us/commandline/wsl/about">Windows Subsystem for Linux</a> provide OpenSSH, so you can install any of these options.</p>
<p>If you are using a virtual server from a third-party provider, when you created the server you were given an IP address for it. You can open a terminal session with your brand new server with the following command:</p>
<pre><code>$ ssh root@&lt;server-ip-address&gt;
</code></pre>
<p>You will be prompted to enter a password. Depending on the service, the password may have been automatically generated and shown to you after you created the server, or you may have given the option to choose your own password.</p>
<p>If you are using a Vagrant VM, you can open a terminal session using the command:</p>
<pre><code>$ vagrant ssh
</code></pre>
<p>If you are using Windows and have a Vagrant VM, note that you will need to run the above command from a shell that can invoke the <code>ssh</code> command from OpenSSH.</p>
<h2>Password-less Logins</h2>
<p>If you are using a Vagrant VM, you can skip this section, since your VM is properly configured to use a non-root account named <code>ubuntu</code>, without password automatically by Vagrant.</p>
<p>If you are using a virtual server, it is recommended that you create a regular user account to do your deployment work, and configure this account to log you in without using a password, which at first may seem like a bad idea, but you'll see that it is not only more convenient but also more secure.</p>
<p>I'm going to create a user account named <code>ubuntu</code> (you can use a different name if you prefer). To create this user account, log in to your server's root account using the <code>ssh</code> instructions from the previous section, and then type the following commands to create the user, give it <code>sudo</code> powers, and finally switch to it:</p>
<pre><code>$ adduser --gecos &quot;&quot; ubuntu
$ usermod -aG sudo ubuntu
$ su ubuntu
</code></pre>
<p>Now I'm going to configure this new <code>ubuntu</code> account to use <a href="http://en.wikipedia.org/wiki/Public-key_cryptography">public key</a> authentication so that you can log in without having to type a password.</p>
<p>Leave the terminal session you have open on your server for a moment, and start a second terminal on your local machine. If you are using Windows, this needs to be the terminal from where you have access to the <code>ssh</code> command, so it will probably be a <code>bash</code> or similar prompt and not a native Windows terminal. In that terminal session, check the contents of the <em>~/.ssh</em> directory:</p>
<pre><code>$ ls ~/.ssh
id_rsa  id_rsa.pub
</code></pre>
<p>If the directory listing shows files named <em>id_rsa</em> and <em>id_rsa.pub</em> like above, then you already have a key. If you don't have these two files, or if you don't have the <em>~/.ssh</em> directory at all, then you need to create your SSH keypair by running the following command, also part of the OpenSSH toolset:</p>
<pre><code>$ ssh-keygen
</code></pre>
<p>This application will prompt you to enter a few things, for which I recommend you accept the defaults by pressing Enter on all the prompts. If you know what you are doing and want to do otherwise, you certainly can.</p>
<p>After this command runs, you should have the two files listed above. The file <em>id_rsa.pub</em> is your <em>public key</em>, which is a file that you will provide to third parties as a way to identify you. The <em>id_rsa</em> file is your <em>private key</em>, which should not be shared with anyone.</p>
<p>You now need to configure your public key as an <em>authorized host</em> in your server. On the terminal that you opened on your own computer, print your public key to the screen:</p>
<pre><code>$ cat ~/.ssh/id_rsa.pub
ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCjw....F8Xv4f/0+7WT miguel@miguelspc
</code></pre>
<p>This is going to be a very long sequence of characters, possibly spanning multiple lines. You need to copy this data to the clipboard, and then switch back to the terminal on your remote server, where you will issue these commands to store the public key:</p>
<pre><code>$ echo &lt;paste-your-key-here&gt; &gt;&gt; ~/.ssh/authorized_keys
$ chmod 600 ~/.ssh/authorized_keys
</code></pre>
<p>The password-less login should now be working. The idea is that <code>ssh</code> on your machine will identify itself to the server by performing a cryptographic operation that requires the private key. The server then verifies that the operation is valid using your public key.</p>
<p>You can now log out of your <code>ubuntu</code> session, and then from your <code>root</code> session, and then try to login directly to the <code>ubuntu</code> account with:</p>
<pre><code>$ ssh ubuntu@&lt;server-ip-address&gt;
</code></pre>
<p>This time you should not have to enter a password!</p>
<h2>Securing Your Server</h2>
<p>To minimize the risk of your server being compromised, there are a few steps that you can take, directed at closing a number of potential doors through which an attacker may gain access.</p>
<p>The first change I'm going to make is to disable root logins via SSH. You now have password-less access into the <code>ubuntu</code> account, and you can run administrator commands from this account via <code>sudo</code>, so there is really no need to expose the root account. To disable root logins, you need to edit the <em>/etc/ssh/sshd_config</em> file on your server. You probably have the <code>vi</code> and <code>nano</code> text editors installed in your server that you can use to edit files (if you are not familiar with either one, try <code>nano</code> first). You will need to prefix your editor with <code>sudo</code>, because the SSH configuration is not accessible to regular users (i.e. <code>sudo vi /etc/ssh/sshd_config</code>). You need to change a single line in this file:</p>
<p class="code_title"><i>/etc/ssh/sshd_config</i>: Disable root logins.</p>

<pre><code>PermitRootLogin no
</code></pre>
<p>Note that to make this change you need to locate the line that starts with <code>PermitRootLogin</code> and change the value, whatever that might be in your server, to <code>no</code>.</p>
<p>The next change is in the same file. Now I'm going to disable password logins for all accounts. You have a password-less login set up, so there is no need to allow passwords at all. If you feel nervous about disabling passwords altogether you can skip this change, but for a production server it is a really good idea, since attackers are constantly trying random account names and passwords on all servers hoping to get lucky. To disable password logins, change the following line in <em>/etc/ssh/sshd_config</em>:</p>
<p class="code_title"><i>/etc/ssh/sshd_config</i>: Disable password logins.</p>

<pre><code>PasswordAuthentication no
</code></pre>
<p>After you are done editing the SSH configuration, the service needs to be restarted for the changes to take effect:</p>
<pre><code>$ sudo service ssh restart
</code></pre>
<p>The third change I'm going to make is to install a <em>firewall</em>. This is a software that blocks accesses to the server on any ports that are not explicitly enabled:</p>
<pre><code>$ sudo apt-get install -y ufw
$ sudo ufw allow ssh
$ sudo ufw allow http
$ sudo ufw allow 443/tcp
$ sudo ufw --force enable
$ sudo ufw status
</code></pre>
<p>These commands install <a href="https://wiki.ubuntu.com/UncomplicatedFirewall">ufw</a>, the Uncomplicated Firewall, and configure it to only allow external traffic on port 22 (ssh), 80 (http) and 443 (https). Any other ports will not be allowed.</p>
<h2>Installing Base Dependencies</h2>
<p>If you followed my advice and provisioned your server with the Ubuntu 20.04 release, then you have a system that comes with full support for Python 3.8, so this is the release that I'm going to use for the deployment.</p>
<p>The base Python interpreter is probably pre-installed on your server, but there are some extra packages that are likely not, and there are also a few other packages outside of Python that are going to be useful in creating a robust, production-ready deployment. For a database server, I'm going to switch from SQLite to MySQL. The postfix package is a mail transfer agent, that I will use to send out emails. The supervisor tool will monitor the Flask server process and automatically restart it if it ever crashes, or also if the server is rebooted. The nginx server is going to accept all request that come from the outside world, and forward them to the application. Finally, I'm going to use git as my tool of choice to download the application directly from its git repository.</p>
<pre><code>$ sudo apt-get -y update
$ sudo apt-get -y install python3 python3-venv python3-dev
$ sudo apt-get -y install mysql-server postfix supervisor nginx git
</code></pre>
<p>These installations run mostly unattended, but at some point while you run the third install statement you will be prompted to choose a root password for the MySQL service, and you'll also be asked a couple of questions regarding the installation of the postfix package which you can accept with their default answers.</p>
<p>Note that for this deployment I'm choosing not to install Elasticsearch. This service requires a large amount of RAM, so it is only viable if you have a large server with more than 2GB of RAM. To avoid problems with servers running out of memory I will leave the search functionality out. If you have a big enough server, you can download the official .deb package from the <a href="https://elastic.co/">Elasticsearch site</a> and follow their installation instructions to add it to your server. Note that the Elasticsearch package available in the Ubuntu package repository might be too old so it may not work, so it is better to install it from the official source.</p>
<p>I should also note that the default installation of postfix is likely insufficient for sending email in a production environment. To avoid spam and malicious emails, many servers require the sender server to identify itself through security extensions, which means at the very least you have to have a domain name associated with your server. If you want to learn how to fully configure an email server so that it passes standard security tests, see the following Digital Ocean guides:</p>
<ul>
<li><a href="http://do.co/2FhdIes">Postfix Configuration</a></li>
<li><a href="http://do.co/2Ff8ksk">Adding an SPF Record</a></li>
<li><a href="http://do.co/2HW2oTD">DKIM Installation and Configuration</a></li>
</ul>
<h2>Installing the Application</h2>
<p>Now I'm going to use <code>git</code> to download the Microblog source code from my GitHub repository. I recommend that you read <a href="http://ryanflorence.com/git-for-beginners/">git for beginners</a> if you are not familiar with git source control.</p>
<p>To download the application to the server, make sure you are in the <code>ubuntu</code> user's home directory and then run:</p>
<pre><code>$ git clone https://github.com/miguelgrinberg/microblog
$ cd microblog
$ git checkout v0.17
</code></pre>
<p>This installs the code on your server, and syncs it to this chapter. If you are keeping your version of this tutorial's code on your own git repository, you can change the repository URL to yours, and in that case you can skip the <code>git checkout</code> command.</p>
<p>Now I need to create a virtual environment and populate it with all the package dependencies, which I conveniently saved to the <em>requirements.txt</em> file in <a href="../../the-flask-mega-tutorial-part-xv-a-better-application-structure-2018.html">Chapter 15</a>:</p>
<pre><code>$ python3 -m venv venv
$ source venv/bin/activate
(venv) $ pip install -r requirements.txt
</code></pre>
<p>In addition to the common requirements in <em>requirements.txt</em>, I'm going to use three packages that are specific to this production deployment, so they are not included in the common requirements file. The <code>gunicorn</code> package is a production web server for Python applications. The <code>pymysql</code> package contains the MySQL driver that enables SQLAlchemy to work with MySQL databases. The <code>cryptography</code> package is used by <code>pymsql</code> to authenticate against the MySQL database server.</p>
<pre><code>(venv) $ pip install gunicorn pymysql cryptography
</code></pre>
<p>I need to create a <em>.env</em> file, with all the needed environment variables:</p>
<p class="code_title"><i>/home/ubuntu/microblog/.env</i>: Environment configuration.</p>

<pre><code>SECRET_KEY=52cb883e323b48d78a0a36e8e951ba4a
MAIL_SERVER=localhost
MAIL_PORT=25
DATABASE_URL=mysql+pymysql://microblog:&lt;db-password&gt;@localhost:3306/microblog
MS_TRANSLATOR_KEY=&lt;your-translator-key-here&gt;
</code></pre>
<p>This <em>.env</em> file is mostly similar to the example I shown in <a href="../../the-flask-mega-tutorial-part-xv-a-better-application-structure-2018.html">Chapter 15</a>, but I have used a random string for <code>SECRET_KEY</code>. To generate this random string I used the following command:</p>
<pre><code>python3 -c &quot;import uuid; print(uuid.uuid4().hex)&quot;
</code></pre>
<p>For the <code>DATABASE_URL</code> variable I defined a MySQL URL. I will show you how to configure the database in the next section.</p>
<p>I need to set the <code>FLASK_APP</code> environment variable to the entry point of the application to enable the <code>flask</code> command to work, but this variable is needed before the <em>.env</em> file is parsed so it needs to be set manually. To avoid having to set it every time, I'm going to add it at the bottom of the <em>~/.profile</em> file for the <code>ubuntu</code> account, so that it is set automatically every time I log in:</p>
<pre><code>$ echo &quot;export FLASK_APP=microblog.py&quot; &gt;&gt; ~/.profile
</code></pre>
<p>If you log out and back in, now <code>FLASK_APP</code> will be set for you. You can confirm that it is set by running <code>flask --help</code>. If the help message shows the <code>translate</code> command added by the application, then you know the application was found.</p>
<p>And now that the <code>flask</code> command is functional, I can compile the language translations:</p>
<pre><code>(venv) $ flask translate compile
</code></pre>
<h2>Setting Up MySQL</h2>
<p>The sqlite database that I've used during development is great for simple applications, but when deploying a full blown web server that can potentially need to handle multiple requests at a time, it is better to use a more robust database. For that reason I'm going to set up a MySQL database that I will call <code>microblog</code>.</p>
<p>To manage the database server I'm going to use the <code>mysql</code> command, which should be already installed on your server:</p>
<pre><code>$ sudo mysql -u root
Welcome to the MySQL monitor.  Commands end with ; or \g.
Your MySQL connection id is 8
Server version: 8.0.25-0ubuntu0.20.04.1 (Ubuntu)

Copyright (c) 2000, 2021, Oracle and/or its affiliates.

Oracle is a registered trademark of Oracle Corporation and/or its
affiliates. Other names may be trademarks of their respective
owners.

Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.

mysql&gt;
</code></pre>
<p>Note that you will need to use <code>sudo</code> to access the MySQL root user from the administrator account.</p>
<p>These are the commands that create a new database called <code>microblog</code>, and a user with the same name that has full access to it:</p>
<pre><code>mysql&gt; create database microblog character set utf8 collate utf8_bin;
mysql&gt; create user 'microblog'@'localhost' identified by '&lt;db-password&gt;';
mysql&gt; grant all privileges on microblog.* to 'microblog'@'localhost';
mysql&gt; flush privileges;
mysql&gt; quit;
</code></pre>
<p>You will need to replace <code>&lt;db-password&gt;</code> with a password of your choice. This is going to be the password for the <code>microblog</code> database user, so it is a good idea to not use the same password you selected for the root user. The password for the <code>microblog</code> user needs to match the password that you included in the <code>DATABASE_URL</code> variable in the <em>.env</em> file.</p>
<p>If your database configuration is correct, you should now be able to run the database migrations that create all the tables:</p>
<pre><code>(venv) $ flask db upgrade
</code></pre>
<p>Make sure the above command completes without producing any errors before you continue.</p>
<h2>Setting Up Gunicorn and Supervisor</h2>
<p>When you run the server with <code>flask run</code>, you are using a web server that comes with Flask. This server is very useful during development, but it isn't a good choice to use for a production server because it wasn't built with performance and robustness in mind. Instead of the Flask development server, for this deployment I decided to use <a href="http://gunicorn.org/">gunicorn</a>, which is also a pure Python web server, but unlike Flask's, it is a robust production server that is used by a lot of people, while at the same time it is very easy to use.</p>
<p>To start Microblog under gunicorn you can use the following command:</p>
<pre><code>(venv) $ gunicorn -b localhost:8000 -w 4 microblog:app
</code></pre>
<p>The <code>-b</code> option tells gunicorn where to listen for requests, which I set to the internal network interface at port 8000. It is usually a good idea to run Python web applications without external access, and then have a very fast web server that is optimized to serve static files accepting all requests from clients. This fast web server will serve static files directly, and forward any requests intended for the application to the internal server. I will show you how to set up nginx as the public facing server in the next section.</p>
<p>The <code>-w</code> option configures how many <em>workers</em> gunicorn will run. Having four workers allows the application to handle up to four clients concurrently, which for a web application is usually enough to handle a decent amount of clients, since not all of them are constantly requesting content. Depending on the amount of RAM your server has, you may need to adjust the number of workers so that you don't run out of memory.</p>
<p>The <code>microblog:app</code> argument tells gunicorn how to load the application instance. The name before the colon is the module that contains the application, and the name after the colon is the name of this application.</p>
<p>While gunicorn is very simple to set up, running the server from the command-line is actually not a good solution for a production server. What I want to do is have the server running in the background, and have it under constant monitoring, because if for any reason the server crashes and exits, I want to make sure a new server is automatically started to take its place. And I also want to make sure that if the machine is rebooted, the server runs automatically upon startup, without me having to log in and start things up myself. I'm going to use the <a href="http://supervisord.org/">supervisor</a> package that I installed above to do this.</p>
<p>The supervisor utility uses configuration files that tell it what programs to monitor and how to restart them when necessary. Configuration files must be stored in <em>/etc/supervisor/conf.d</em>. Here is a configuration file for Microblog, which I'm going to call <em>microblog.conf</em>:</p>
<p class="code_title"><i>/etc/supervisor/conf.d/microblog.conf</i>: Supervisor configuration.</p>

<pre><code>[program:microblog]
command=/home/ubuntu/microblog/venv/bin/gunicorn -b localhost:8000 -w 4 microblog:app
directory=/home/ubuntu/microblog
user=ubuntu
autostart=true
autorestart=true
stopasgroup=true
killasgroup=true
</code></pre>
<p>The <code>command</code>, <code>directory</code> and <code>user</code> settings tell supervisor how to run the application. The <code>autostart</code> and <code>autorestart</code> set up automatic restarts due to the computer starting up, or crashes. The <code>stopasgroup</code> and <code>killasgroup</code> options ensure that when supervisor needs to stop the application to restart it, it also reaches the child processes of the top-level gunicorn process.</p>
<p>After you write this configuration file, you have to reload the supervisor service for it to be imported:</p>
<pre><code>$ sudo supervisorctl reload
</code></pre>
<p>And just like that, the gunicorn web server should be up and running and monitored!</p>
<h2>Setting Up Nginx</h2>
<p>The microblog application server powered by gunicorn is now running privately port 8000. What I need to do now to expose the application to the outside world is to enable my public facing web server on ports 80 and 443, the two ports that I opened on the firewall to handle the web traffic of the application.</p>
<p>I want this to be a secure deployment, so I'm going to configure port 80 to forward all traffic to port 443, which is going to be encrypted. So I'm going to start by creating an SSL certificate. For now I'm going to create a <em>self-signed SSL certificate</em>, which is okay for testing everything but not good for a real deployment because web browsers will warn users that the certificate was not issued by a trusted certificate authority. The command to create the SSL certificate for microblog is:</p>
<pre><code>$ mkdir certs
$ openssl req -new -newkey rsa:4096 -days 365 -nodes -x509 \
  -keyout certs/key.pem -out certs/cert.pem
</code></pre>
<p>The command is going to ask you for some information about your application and yourself. This is information that will be included in the SSL certificate, and that web browsers will show to users if they request to see it. The result of the command above is going to be two files called <em>key.pem</em> and <em>cert.pem</em>, which I placed in a <em>certs</em> sub-directory of the Microblog root directory.</p>
<p>To have a web site served by nginx, you need to write a configuration file for it. In most nginx installations this file needs to be in the <em>/etc/nginx/sites-enabled</em> directory. Nginx installs a test site in this location that I don't really need, so I'm going to start by removing it:</p>
<pre><code>$ sudo rm /etc/nginx/sites-enabled/default
</code></pre>
<p>Below you can see the nginx configuration file for Microblog, which goes in <em>/etc/nginx/sites-enabled/microblog</em>:</p>
<p class="code_title"><i>/etc/nginx/sites-enabled/microblog</i>: Nginx configuration.</p>

<pre><code>server {
    # listen on port 80 (http)
    listen 80;
    server_name _;
    location / {
        # redirect any requests to the same URL but on https
        return 301 https://$host$request_uri;
    }
}
server {
    # listen on port 443 (https)
    listen 443 ssl;
    server_name _;

    # location of the self-signed SSL certificate
    ssl_certificate /home/ubuntu/microblog/certs/cert.pem;
    ssl_certificate_key /home/ubuntu/microblog/certs/key.pem;

    # write access and error logs to /var/log
    access_log /var/log/microblog_access.log;
    error_log /var/log/microblog_error.log;

    location / {
        # forward application requests to the gunicorn server
        proxy_pass http://localhost:8000;
        proxy_redirect off;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    }

    location /static {
        # handle static files directly, without forwarding to the application
        alias /home/ubuntu/microblog/app/static;
        expires 30d;
    }
}
</code></pre>
<p>The nginx configuration is far from trivial, but I've added some comments so that at least you know what each section does. If you want to have information about a specific directive, consult the <a href="https://nginx.org/en/docs/">nginx official documentation</a>.</p>
<p>After you add this file, you need to tell nginx to reload the configuration to activate it:</p>
<pre><code>$ sudo service nginx reload
</code></pre>
<p>And now the application should be deployed. In your web browser, you can type the the IP address of your server (or 192.168.33.10 if you are using a Vagrant VM) and that will connect to the application. Because you are using a self-signed certificate, you will get a warning from the web browser, which you will have to dismiss.</p>
<p>After you complete a deployment with the above instructions for your own projects, I strongly suggest that you replace the self-signed certificate with a real one, so that the browser does not warn your users about your site. For this you will first need to purchase a domain name and configure it to point to your server's IP address. Once you have a domain, you can request a free <a href="https://letsencrypt.org/">Let's Encrypt</a> SSL certificate. I have written a detailed article on my blog on how to <a href="../../running-your-flask-application-over-https.html">Run your Flask application over HTTPS</a>.</p>
<h2>Deploying Application Updates</h2>
<p>The last topic I want to discuss regarding the Linux based deployment is how to handle application upgrades. The application source code is installed in the server through <code>git</code>, so whenever you want to upgrade your application to the latest version, you can just run <code>git pull</code> to download the new commits that were made since the previous deployment.</p>
<p>But of course, downloading the new version of the code is not going to cause an upgrade. The server processes that are currently running will continue to run with the old code, which was already read and stored in memory. To trigger an upgrade you have to stop the current server and start a new one, to force all the code to be read again.</p>
<p>Doing an upgrade is in general more complicated than just restarting the server. You may need to apply database migrations, or compile new language translations, so in reality, the process to perform an upgrade involves a sequence of commands:</p>
<pre><code>(venv) $ git pull                              # download the new version
(venv) $ sudo supervisorctl stop microblog     # stop the current server
(venv) $ flask db upgrade                      # upgrade the database
(venv) $ flask translate compile               # upgrade the translations
(venv) $ sudo supervisorctl start microblog    # start a new server
</code></pre>
<h2>Raspberry Pi Hosting</h2>
<p>The <a href="http://www.raspberrypi.org/">Raspberry Pi</a> is a low-cost revolutionary little Linux computer that has very low power consumption, so it is the perfect device to host a home based web server that can be online 24/7 without tying up your desktop computer or laptop. There are several Linux distributions that run on the Raspberry Pi. My choice is Raspberry Pi OS, which is the official distribution from the Raspberry Pi Foundation.</p>
<p>To prepare the Raspberry Pi, I'm going to install a fresh Rasberry Pi OS release. I will be using the Lite version, because I do not need the desktop user interface. You can find the latest release of the Raspberry Pi OS on their <a href="https://www.raspberrypi.org/software/operating-systems/">operating systems page</a>.</p>
<p>The Raspberry Pi OS image needs to be installed on an SD card, which you then plug into the Raspberry Pi so that it can boot with it. Instructions to copy the Raspberry Pi OS image to an SD card from Windows, Mac OS X and Linux are available on the <a href="https://www.raspberrypi.org/documentation/installation/installing-images/">Raspberry Pi site</a>.</p>
<p>When you boot your Raspberry Pi for the first time, do it while connected to a keyboard and a monitor, so that you can do the set up. At the very least you should enable SSH, so that you can log in from your computer to perform the deployment tasks more comfortably.</p>
<p>Like Ubuntu, Raspberry Pi OS is a derivative of Debian, so the instructions above for Ubuntu Linux for the most part work just as well for the Raspberry Pi. However, you may decide to skip some of the steps if you are planning on running a small application on your home network, without external access. For example, you may not need the firewall, or the password-less logins. And you may want to use SQLite instead of MySQL in such a small computer. You may opt to not use nginx, and just have the gunicorn server listening directly for requests from clients. You will probably want just one or two gunicorn workers. The supervisor service is useful in ensuring the application is always up, so my recommendation is that you also use it on the Raspberry Pi.</p></div>

<div class="card patreon-bar">
  <div class="card-body">
    <h5>Become a Patron!</h5>
    <p class="card-text">Hello, and thank you for visiting my blog! If you enjoyed this article, please consider supporting my work on this blog on <a href="https://patreon.com/miguelgrinberg">Patreon</a>!</p>
    <a href="https://patreon.com/miguelgrinberg" alt="Become a Patron!" title="Become a Patron!"><img src="../../../static/patreon-button.png"></a>
  </div>
</div>


<div class="card social-bar">
  <div class="card-body">
    <h5>Share this post:</h5>
      <!-- Sharingbutton Hacker News -->
      <a class="resp-sharing-button__link" href="https://news.ycombinator.com/submitlink?u=https%3A//blog.miguelgrinberg.com/post/the-flask-mega-tutorial-part-xvii-deployment-on-linux-2018&amp;t=The%20Flask%20Mega-Tutorial%20Part%20XVII%3A%20Deployment%20on%20Linux%20%282018%29" target="_blank" rel="noopener" aria-label="Hacker News">
        <div class="resp-sharing-button resp-sharing-button--hackernews resp-sharing-button--medium"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 140 140"><path fill-rule="evenodd" d="M60.94 82.314L17 0h20.08l25.85 52.093c.397.927.86 1.888 1.39 2.883.53.994.995 2.02 1.393 3.08.265.4.463.764.596 1.095.13.334.262.63.395.898.662 1.325 1.26 2.618 1.79 3.877.53 1.26.993 2.42 1.39 3.48 1.06-2.254 2.22-4.673 3.48-7.258 1.26-2.585 2.552-5.27 3.877-8.052L103.49 0h18.69L77.84 83.308v53.087h-16.9v-54.08z"></path></svg></div>Hacker News</div>
      </a>

      <!-- Sharingbutton Reddit -->
      <a class="resp-sharing-button__link" href="https://reddit.com/submit/?url=https%3A//blog.miguelgrinberg.com/post/the-flask-mega-tutorial-part-xvii-deployment-on-linux-2018&amp;resubmit=true&amp;title=The%20Flask%20Mega-Tutorial%20Part%20XVII:%20Deployment%20on%20Linux%20(2018)" target="_blank" rel="noopener" aria-label="Reddit">
        <div class="resp-sharing-button resp-sharing-button--reddit resp-sharing-button--medium"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M24 11.5c0-1.65-1.35-3-3-3-.96 0-1.86.48-2.42 1.24-1.64-1-3.75-1.64-6.07-1.72.08-1.1.4-3.05 1.52-3.7.72-.4 1.73-.24 3 .5C17.2 6.3 18.46 7.5 20 7.5c1.65 0 3-1.35 3-3s-1.35-3-3-3c-1.38 0-2.54.94-2.88 2.22-1.43-.72-2.64-.8-3.6-.25-1.64.94-1.95 3.47-2 4.55-2.33.08-4.45.7-6.1 1.72C4.86 8.98 3.96 8.5 3 8.5c-1.65 0-3 1.35-3 3 0 1.32.84 2.44 2.05 2.84-.03.22-.05.44-.05.66 0 3.86 4.5 7 10 7s10-3.14 10-7c0-.22-.02-.44-.05-.66 1.2-.4 2.05-1.54 2.05-2.84zM2.3 13.37C1.5 13.07 1 12.35 1 11.5c0-1.1.9-2 2-2 .64 0 1.22.32 1.6.82-1.1.85-1.92 1.9-2.3 3.05zm3.7.13c0-1.1.9-2 2-2s2 .9 2 2-.9 2-2 2-2-.9-2-2zm9.8 4.8c-1.08.63-2.42.96-3.8.96-1.4 0-2.74-.34-3.8-.95-.24-.13-.32-.44-.2-.68.15-.24.46-.32.7-.18 1.83 1.06 4.76 1.06 6.6 0 .23-.13.53-.05.67.2.14.23.06.54-.18.67zm.2-2.8c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm5.7-2.13c-.38-1.16-1.2-2.2-2.3-3.05.38-.5.97-.82 1.6-.82 1.1 0 2 .9 2 2 0 .84-.53 1.57-1.3 1.87z"/></svg></div>Reddit</div>
      </a>

      <!-- Sharingbutton Twitter -->
      <a class="resp-sharing-button__link" href="https://twitter.com/intent/tweet/?text=The%20Flask%20Mega-Tutorial%20Part%20XVII%3A%20Deployment%20on%20Linux%20%282018%29&amp;url=https%3A//blog.miguelgrinberg.com/post/the-flask-mega-tutorial-part-xvii-deployment-on-linux-2018" target="_blank" rel="noopener" aria-label="Twitter">
        <div class="resp-sharing-button resp-sharing-button--twitter resp-sharing-button--medium"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M23.44 4.83c-.8.37-1.5.38-2.22.02.93-.56.98-.96 1.32-2.02-.88.52-1.86.9-2.9 1.1-.82-.88-2-1.43-3.3-1.43-2.5 0-4.55 2.04-4.55 4.54 0 .36.03.7.1 1.04-3.77-.2-7.12-2-9.36-4.75-.4.67-.6 1.45-.6 2.3 0 1.56.8 2.95 2 3.77-.74-.03-1.44-.23-2.05-.57v.06c0 2.2 1.56 4.03 3.64 4.44-.67.2-1.37.2-2.06.08.58 1.8 2.26 3.12 4.25 3.16C5.78 18.1 3.37 18.74 1 18.46c2 1.3 4.4 2.04 6.97 2.04 8.35 0 12.92-6.92 12.92-12.93 0-.2 0-.4-.02-.6.9-.63 1.96-1.22 2.56-2.14z"/></svg></div>Twitter</div>
      </a>

      <!-- Sharingbutton LinkedIn -->
      <a class="resp-sharing-button__link" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3A//blog.miguelgrinberg.com/post/the-flask-mega-tutorial-part-xvii-deployment-on-linux-2018&amp;title=The%20Flask%20Mega-Tutorial%20Part%20XVII%3A%20Deployment%20on%20Linux%20%282018%29&amp;summary=The%20Flask%20Mega-Tutorial%20Part%20XVII%3A%20Deployment%20on%20Linux%20%282018%29&amp;source=https%3A//blog.miguelgrinberg.com/post/the-flask-mega-tutorial-part-xvii-deployment-on-linux-2018" target="_blank" rel="noopener" aria-label="LinkedIn">
        <div class="resp-sharing-button resp-sharing-button--linkedin resp-sharing-button--medium"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M6.5 21.5h-5v-13h5v13zM4 6.5C2.5 6.5 1.5 5.3 1.5 4s1-2.4 2.5-2.4c1.6 0 2.5 1 2.6 2.5 0 1.4-1 2.5-2.6 2.5zm11.5 6c-1 0-2 1-2 2v7h-5v-13h5V10s1.6-1.5 4-1.5c3 0 5 2.2 5 6.3v6.7h-5v-7c0-1-1-2-2-2z"/></svg></div>LinkedIn</div>
      </a>

      <!-- Sharingbutton Facebook -->
      <a class="resp-sharing-button__link" href="https://facebook.com/sharer/sharer.php?u=https%3A//blog.miguelgrinberg.com/post/the-flask-mega-tutorial-part-xvii-deployment-on-linux-2018" target="_blank" rel="noopener" aria-label="Facebook">
        <div class="resp-sharing-button resp-sharing-button--facebook resp-sharing-button--medium"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18.77 7.46H14.5v-1.9c0-.9.6-1.1 1-1.1h3V.5h-4.33C10.24.5 9.5 3.44 9.5 5.32v2.15h-3v4h3v12h5v-12h3.85l.42-4z"/></svg></div>Facebook</div>
      </a>

      <!-- Sharingbutton E-Mail -->
      <a class="resp-sharing-button__link" href="mailto:?subject=The%20Flask%20Mega-Tutorial%20Part%20XVII%3A%20Deployment%20on%20Linux%20%282018%29&amp;body=https%3A//blog.miguelgrinberg.com/post/the-flask-mega-tutorial-part-xvii-deployment-on-linux-2018" target="_self" rel="noopener" aria-label="E-Mail">
        <div class="resp-sharing-button resp-sharing-button--email resp-sharing-button--medium"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M22 4H2C.9 4 0 4.9 0 6v12c0 1.1.9 2 2 2h20c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zM7.25 14.43l-3.5 2c-.08.05-.17.07-.25.07-.17 0-.34-.1-.43-.25-.14-.24-.06-.55.18-.68l3.5-2c.24-.14.55-.06.68.18.14.24.06.55-.18.68zm4.75.07c-.1 0-.2-.03-.27-.08l-8.5-5.5c-.23-.15-.3-.46-.15-.7.15-.22.46-.3.7-.14L12 13.4l8.23-5.32c.23-.15.54-.08.7.15.14.23.07.54-.16.7l-8.5 5.5c-.08.04-.17.07-.27.07zm8.93 1.75c-.1.16-.26.25-.43.25-.08 0-.17-.02-.25-.07l-3.5-2c-.24-.13-.32-.44-.18-.68s.44-.32.68-.18l3.5 2c.24.13.32.44.18.68z"/></svg></div>E-Mail</div>
      </a>

  </div>
</div>

<div id="comments" class="post-comment-count">
  
  <a class="btn btn-outline-secondary" href="../../the-flask-mega-tutorial-part-xvii-deployment-on-linux-2018.html#comments">316 comments</a>
  
</div>


<div class="comments">
  <ul>
    
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/fe93f7f9e22b8ed5d0d775beee498c18?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#201</span> <span class="badge text-bg-warning">Kieron Spearing</span> said
    
    <span class="flask-moment" data-timestamp="2020-09-07T11:15:29Z" data-function="fromNow" data-refresh="0" style="display: none">2020-09-07T11:15:29Z</span>
  </p>
  <div>
    <p>Solved it by changing all ubuntu to vagrant... why would this be the solution?</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/729e26a2a2c7ff24a71958d4aa4e5f35?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#202</span> <span class="badge text-bg-danger">Miguel Grinberg</span> said
    
    <span class="flask-moment" data-timestamp="2020-09-07T14:08:29Z" data-function="fromNow" data-refresh="0" style="display: none">2020-09-07T14:08:29Z</span>
  </p>
  <div>
    <p>@Kieron: the better solution would have been for you to generate the certificate under the ubuntu account, or else to "fix" the ownership of the files with the <code>chown</code> command.</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/fe93f7f9e22b8ed5d0d775beee498c18?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#203</span> <span class="badge text-bg-warning">Kieron Spearing</span> said
    
    <span class="flask-moment" data-timestamp="2020-09-07T18:29:42Z" data-function="fromNow" data-refresh="0" style="display: none">2020-09-07T18:29:42Z</span>
  </p>
  <div>
    <p>Hey Miguel</p>
<p>I used the following:<br>
vagrant@ubuntu-xenial:~/Mega/certs$ ls -l cert.pem<br>
-rw-rw-r-- 1 vagrant vagrant 2098 Sep  7 08:45 cert.pem<br>
vagrant@ubuntu-xenial:~/Mega/certs$ ls -l key.pem<br>
-rw-rw-r-- 1 vagrant vagrant 3272 Sep  7 08:45 key.pem<br>
vagrant@ubuntu-xenial:~/Mega/certs$ cd<br>
vagrant@ubuntu-xenial:~$ whoami<br>
vagrant<br>
vagrant@ubuntu-xenial:~$ who<br>
vagrant  pts/1        2020-09-04 16:09 (10.0.2.2)</p>
<p>Which made me believe there was no ubuntu account, which I think may have been because during one of my previous problems I accidentally removed the directory with the project and had to get it again and thought the user step wouldn't be affected so ended up skipping that step.... How would you have gone about solving it? If I may ask how would you have used the chown command to fix it so I can learn from it?</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/729e26a2a2c7ff24a71958d4aa4e5f35?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#204</span> <span class="badge text-bg-danger">Miguel Grinberg</span> said
    
    <span class="flask-moment" data-timestamp="2020-09-07T21:54:26Z" data-function="fromNow" data-refresh="0" style="display: none">2020-09-07T21:54:26Z</span>
  </p>
  <div>
    <p>@Kieron: the chown command is one of the core Unix commands. If you are not familiar with it, I suggest you find a Unix administration book to learn it along with a few other important ones. The command in this case would have been <code>chown ubuntu:ubuntu *.pem</code> or something similar.</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/435c475aec242f1ae0e62f58bc197846?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#205</span> <span class="badge text-bg-warning">Jurg</span> said
    
    <span class="flask-moment" data-timestamp="2020-09-09T13:56:01Z" data-function="fromNow" data-refresh="0" style="display: none">2020-09-09T13:56:01Z</span>
  </p>
  <div>
    <p>Hi Miguel,<br>
thank you for the great tutorial!<br>
Would you have some suggestions regarding the full-text search solution so that it could be installed on the smallest DigitalOcean droplet? I have found here a short overview <br>
     <a href="https://docs.meilisearch.com/resources/comparison_to_alternatives.html" rel="nofollow">https://docs.meilisearch.com/resources/comparison_to_alternatives.html</a><br>
Sonic is a lightweight and schema-less search index server written in Rust. Probably MeiliSearch is an option as well (<a href="https://docs.meilisearch.com/resources/about_storage.html" rel="nofollow">https://docs.meilisearch.com/resources/about_storage.html</a>), etc<br>
Any ideas?<br>
regards,<br>
Jurg</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/729e26a2a2c7ff24a71958d4aa4e5f35?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#206</span> <span class="badge text-bg-danger">Miguel Grinberg</span> said
    
    <span class="flask-moment" data-timestamp="2020-09-09T14:53:05Z" data-function="fromNow" data-refresh="0" style="display: none">2020-09-09T14:53:05Z</span>
  </p>
  <div>
    <p>@Jung: sqlite, postgres and mysql all have some form of full-text search these days. Maybe one of those works for you? Note that none of them are integrated with SQLAlchemy, so you will need to use the same approach I used in this article to integrate with Elasticsearch.</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/34928f774a095b730f56cc1592ebb854?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#207</span> <span class="badge text-bg-warning">Brian</span> said
    
    <span class="flask-moment" data-timestamp="2020-09-15T20:39:44Z" data-function="fromNow" data-refresh="0" style="display: none">2020-09-15T20:39:44Z</span>
  </p>
  <div>
    <p>Hi Miguel,</p>
<p>I'm at the part where we just finished setting the FLASK_APP env variable. When I run flask --help, I get the following traceback calls and error:</p>
<p>Traceback (most recent call last):<br>
  File "/home/ubuntu/microblog/venv/lib/python3.5/site-packages/flask/<a href="http://cli.py/" rel="nofollow">cli.py</a>", line 556, in list_commands<br>
    rv.update(info.load_app().cli.list_commands(ctx))<br>
  File "/home/ubuntu/microblog/venv/lib/python3.5/site-packages/flask/<a href="http://cli.py/" rel="nofollow">cli.py</a>", line 388, in load_app<br>
    app = locate_app(self, import_name, name)<br>
  File "/home/ubuntu/microblog/venv/lib/python3.5/site-packages/flask/<a href="http://cli.py/" rel="nofollow">cli.py</a>", line 240, in locate_app<br>
<strong>import</strong>(module_name)<br>
  File "/home/ubuntu/microblog/<a href="http://microblog.py/" rel="nofollow">microblog.py</a>", line 1, in &lt;module&gt;<br>
    from app import create_app, db<br>
  File "/home/ubuntu/microblog/app/<strong>init</strong>.py", line 9, in &lt;module&gt;<br>
    from flask_bootstrap import Bootstrap<br>
  File "/home/ubuntu/microblog/venv/lib/python3.5/site-packages/flask_bootstrap/<strong>init</strong>.py", line 9, in &lt;module&gt;<br>
    from wtforms.fields import HiddenField<br>
  File "/home/ubuntu/microblog/venv/lib/python3.5/site-packages/wtforms/<strong>init</strong>.py", line 11, in &lt;module&gt;<br>
    from wtforms import validators, widgets<br>
  File "/home/ubuntu/microblog/venv/lib/python3.5/site-packages/wtforms/<a href="http://validators.py/" rel="nofollow">validators.py</a>", line 9, in &lt;module&gt;<br>
    import email_validator<br>
  File "/home/ubuntu/microblog/venv/lib/python3.5/site-packages/email_validator/<strong>init</strong>.py", line 6, in &lt;module&gt;<br>
    import dns.resolver<br>
  File "/home/ubuntu/microblog/venv/lib/python3.5/site-packages/dns/<a href="http://resolver.py/" rel="nofollow">resolver.py</a>", line 32, in &lt;module&gt;<br>
    import dns.flags<br>
  File "/home/ubuntu/microblog/venv/lib/python3.5/site-packages/dns/<a href="http://flags.py/" rel="nofollow">flags.py</a>", line 24, in &lt;module&gt;<br>
    class Flag(enum.IntFlag):<br>
AttributeError: module 'enum' has no attribute 'IntFlag'</p>
<p>The same error occurs when running all other flask commands. Any idea what I can do to fix this?</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/729e26a2a2c7ff24a71958d4aa4e5f35?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#208</span> <span class="badge text-bg-danger">Miguel Grinberg</span> said
    
    <span class="flask-moment" data-timestamp="2020-09-15T22:55:37Z" data-function="fromNow" data-refresh="0" style="display: none">2020-09-15T22:55:37Z</span>
  </p>
  <div>
    <p>@Brian: when you get a strange error such as this the best course of action is to google the error message to see if others have seen it too. In this case it appears this happens for people who install a package called <code>enum34</code> and the solution that worked for many is to uninstall that package.</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/aa4d7225b5276efcfbbf556ff1b5676f?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#209</span> <span class="badge text-bg-warning">Gitau Harrison</span> said
    
    <span class="flask-moment" data-timestamp="2020-09-30T08:45:06Z" data-function="fromNow" data-refresh="0" style="display: none">2020-09-30T08:45:06Z</span>
  </p>
  <div>
    <p>Installation and working with vagrant is giving me a bit of an issue. I am going to detail the steps I have followed so that you can see what I have going wrong. I have been reviewing your chat with @Rohan way earlier and I need to confirm whether what I am doing is flawed or not.</p>
<p>I have virtualbox and vagrant installed as follows:</p>
<p>$ sudo apt install virtualbox<br>
$ which virtualbox<br>
$ $ sudo apt update<br>
$ curl -O <a href="https://releases.hashicorp.com/vagrant/2.2.10/vagrant_2.2.10_x86_64.deb" rel="nofollow">https://releases.hashicorp.com/vagrant/2.2.10/vagrant_2.2.10_x86_64.deb</a><br>
$ sudo apt install ./vagrant_2.2.10_x86_64.deb<br>
$ vagrant --version</p>
<p>Up until this point, everything works well.</p>
<p>$ vagrant up<br>
$ vagrant ssh</p>
<p>I am signed in as vagrant@ubuntu-bionic:~$ (I used bionic ubuntu cloud image <a href="https://cloud-images.ubuntu.com/" rel="nofollow">https://cloud-images.ubuntu.com/</a>)</p>
<p>However, as you say, I should use the recommended disk image if I am to follow your steps.</p>
<p>Question 1: <br>
Why at this point does it end up with... vagrant@ubuntu-bionic:~$ instead of ubuntu@ubuntu-bionic:~$ ...?</p>
<p>Initially, having said that if I am using a Vagrant VM I can skip the 'Password-less Login' section of the tutorial, I did exactly that and went to the next section of 'Securing Your Server'. I however encountered problems and I had to redo the whole process again, this time paying attention to the 'Password-less Login'.</p>
<p>I am able to create a user called ubuntu:</p>
<p>$ adduser --gecos "" ubuntu<br>
$ usermod -aG sudo ubuntu<br>
$ su ubuntu</p>
<p>I get the image ubuntu@ubuntu-bionic:/home/vagrant$</p>
<p>Every time I exit user ubuntu, I am returned to vagrant@ubuntu-bionic from which I have to 'logout' to completely exit the VM. </p>
<p>Question 2:<br>
However, to get back to user ubuntu@ubuntu-bionic:/home/vagrant$, I have to run these commands All the time:</p>
<p>$ vagrant up<br>
$ vagrant ssh<br>
$ sudo su ubuntu</p>
<p>Is this the correct way, every time? At this point, I am on ubuntu@ubuntu-bionic:/home/vagrant$ without having to put in any password.</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/729e26a2a2c7ff24a71958d4aa4e5f35?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#210</span> <span class="badge text-bg-danger">Miguel Grinberg</span> said
    
    <span class="flask-moment" data-timestamp="2020-09-30T09:08:50Z" data-function="fromNow" data-refresh="0" style="display: none">2020-09-30T09:08:50Z</span>
  </p>
  <div>
    <p>@Gitau: it seems that the vagrant image that you are using uses the name "vagrant" for the default account, instead of "ubuntu". You can do everything under the vagrant account if you like, or else do what you did, which is to create the ubuntu account, and then after you ssh into vagrant change into ubuntu. If you want to automatically log in as the ubuntu user, you can use the following command:</p>
<pre><code>vagrant ssh -c &quot;cd /home/ubuntu; sudo su ubuntu&quot;
</code></pre>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/aa4d7225b5276efcfbbf556ff1b5676f?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#211</span> <span class="badge text-bg-warning">Gitau Harrison</span> said
    
    <span class="flask-moment" data-timestamp="2020-09-30T17:02:27Z" data-function="fromNow" data-refresh="0" style="display: none">2020-09-30T17:02:27Z</span>
  </p>
  <div>
    <p>@Miguel Thank you for that short-hand command.</p>
<p>I decided to use virtualenvwrapper to create and activate my virtual environment. This works well. In the process of trying to set environment variables in .env within the cloned repository, I thought of integrating VS Code so that I can just fire it up and have access the .env file (because "touch .env" does create the file and I can see that "git status" shows it as untracked)</p>
<p>Opinion:<br>
I was quite stuck for a while, not knowing how to open the .env file that I had created in my clone from the terminal. It has been a great learning experience getting to set up my editor to use my VM. For beginners, how about you provide just a bit more guidance (or a hint/link or something) on how to access the file at this point?</p>
<p>Question:<br>
I am in my cloned folder and .env file is populated with the necessary environment variables. VS Code immediately tells me that:</p>
<p>Failed to save '.env': Unable to write file 'vscode-remote://ssh-remote+default/home/ubuntu/my_project/.env' (NoPermissions (FileSystemError): Error: EACCES: permission denied, open '/home/ubuntu/my_project/.env')</p>
<p>I have set up VS Code as expected (<a href="https://stackoverflow.com/questions/55974144/how-to-set-a-remote-connection-to-a-vagrant-container-using-visual-studio-code" rel="nofollow">https://stackoverflow.com/questions/55974144/how-to-set-a-remote-connection-to-a-vagrant-container-using-visual-studio-code</a>), saving the results of <code>vagrant ssh-config</code> (run in terminal) in a file called "<a href="http://config.py/" rel="nofollow">config.py</a>"</p>
<p>Clearly, I am denied permission to save this file, and I am not sure how to go about it. I have tried <code>$ sudo chown -R non_root_username /path/to/directory</code> and nothing happens. <br>
Kindly assist.</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/729e26a2a2c7ff24a71958d4aa4e5f35?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#212</span> <span class="badge text-bg-danger">Miguel Grinberg</span> said
    
    <span class="flask-moment" data-timestamp="2020-10-01T09:59:30Z" data-function="fromNow" data-refresh="0" style="display: none">2020-10-01T09:59:30Z</span>
  </p>
  <div>
    <p>@Gitau: I'm sorry but I'm having trouble following what you are trying to do. This chapter of the tutorial shows how to create a deployment on a production server. Why are you adding VS code to this? You are not going to edit code in a production server, so VS code does not belong here.</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/1ff3ed197246d26b19d1c0c923916076?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#213</span> <span class="badge text-bg-warning">RTL</span> said
    
    <span class="flask-moment" data-timestamp="2020-10-05T17:00:59Z" data-function="fromNow" data-refresh="0" style="display: none">2020-10-05T17:00:59Z</span>
  </p>
  <div>
    <p>Miguel,</p>
<p>Using nginx as you describe in the tutorial to forward http (80) to https (443). Works as expected inside private network (192.168.1.x). I have configured my ISP router to port forward 59080 (external) to 80 (internal) and 59443 (external) to 443 (internal). This is my nginx config file:</p>
&lt;h1&gt;/etc/nginx/sites-enabled/ww&lt;/h1&gt;
<p>server {<br>
    # listen on port 80 (http)<br>
    listen 80;<br>
    server_name <em>;<br>
    location / {<br>
        # redirect any requests to the same URL but on https<br>
        return 301 https://$host$request_uri;<br>
    }<br>
}<br>
server {<br>
    # listen on port 443 (https)<br>
    listen 443 ssl;<br>
    server_name </em>;</p>
<pre><code># location of the self-signed SSL certificate
ssl_certificate /home/pi/flask/ww/deployment/certs/domain.crt;
ssl_certificate_key /home/pi/flask/ww/deployment/certs/domain.key;

# write access and error logs to /var/log
access_log /var/log/ww-access-ssl.log;
error_log /var/log/ww-error-ssl.log;

location / {
    # forward application requests to the gunicorn server
    proxy_pass http://localhost:8000;
    proxy_redirect off;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto $scheme;
}

location /static {
    # handle static files directly, without forwarding to the application
    alias /home/pi/flask/ww/app/static;
    expires 30d;
}
</code></pre>
<p>}</p>
<p>When I access the public facing router IP to reach website (e.g., https://72.x.x.x:59443), I first get my login screen just as expected and I login (using flask-login), but then I get a 404 error with a message "Bad Request The referrer does not match the host." If I try to access the public facing router IP with http://72.x.x.x:59080, I get redirected to https://72.x.x.x/auth/login with no port number and a "Unable to connect" error (port gets stripped?).</p>
<p>I think my ISP router port forwarding requires a different nginx config or some other change in my flask app config. I want to be able to get at the site from either the internal (private) network and the public facing IP when I'm not at home. Don't prefer to use ngrok.</p>
<p>Anything obvious that I should change (I've been all over the nginx blogs/sites and can't find what I'm looking for)?</p>
<p>Thank you,</p>
<p>Robin</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/729e26a2a2c7ff24a71958d4aa4e5f35?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#214</span> <span class="badge text-bg-danger">Miguel Grinberg</span> said
    
    <span class="flask-moment" data-timestamp="2020-10-05T22:22:20Z" data-function="fromNow" data-refresh="0" style="display: none">2020-10-05T22:22:20Z</span>
  </p>
  <div>
    <p>@RTL: the first thing you should try is remove the port mapping and reconfigure nginx to listen on your intended ports directly. You may also need to add the ProxyFix middleware to your app (see <a href="https://werkzeug.palletsprojects.com/en/1.0.x/middleware/proxy_fix/" rel="nofollow">https://werkzeug.palletsprojects.com/en/1.0.x/middleware/proxy_fix/</a>).</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/6e67bee1da5e19e603eaf6ecaf1e243e?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#215</span> <span class="badge text-bg-warning">Brian</span> said
    
    <span class="flask-moment" data-timestamp="2020-10-09T06:05:27Z" data-function="fromNow" data-refresh="0" style="display: none">2020-10-09T06:05:27Z</span>
  </p>
  <div>
    <p>Hi Miguel,</p>
<p>When I enter "flask db upgrade", I get this AttributeError:</p>
<p>INFO in <strong>init</strong>: Microblog startup<br>
Traceback (most recent call last):<br>
  File "/home/ubuntu/microblog/venv/bin/flask", line 8, in &lt;module&gt;<br>
    sys.exit(main())<br>
  File "/home/ubuntu/microblog/venv/lib/python3.8/site-packages/flask/<a href="http://cli.py/" rel="nofollow">cli.py</a>", line 967, in main<br>
    cli.main(args=sys.argv[1:], prog_name="python -m flask" if as_module else None)<br>
  File "/home/ubuntu/microblog/venv/lib/python3.8/site-packages/flask/<a href="http://cli.py/" rel="nofollow">cli.py</a>", line 586, in main<br>
    return super(FlaskGroup, self).main(<em>args, </em><em>kwargs)<br>
  File "/home/ubuntu/microblog/venv/lib/python3.8/site-packages/click/<a href="http://core.py/" rel="nofollow">core.py</a>", line 782, in main<br>
    rv = self.invoke(ctx)<br>
  File "/home/ubuntu/microblog/venv/lib/python3.8/site-packages/click/<a href="http://core.py/" rel="nofollow">core.py</a>", line 1259, in invoke<br>
    return _process_result(sub_ctx.command.invoke(sub_ctx))<br>
  File "/home/ubuntu/microblog/venv/lib/python3.8/site-packages/click/<a href="http://core.py/" rel="nofollow">core.py</a>", line 1259, in invoke<br>
    return _process_result(sub_ctx.command.invoke(sub_ctx))<br>
  File "/home/ubuntu/microblog/venv/lib/python3.8/site-packages/click/<a href="http://core.py/" rel="nofollow">core.py</a>", line 1066, in invoke<br>
    return ctx.invoke(self.callback, </em><em>ctx.params)<br>
  File "/home/ubuntu/microblog/venv/lib/python3.8/site-packages/click/<a href="http://core.py/" rel="nofollow">core.py</a>", line 610, in invoke<br>
    return callback(</em>args, <strong>kwargs)<br>
  File "/home/ubuntu/microblog/venv/lib/python3.8/site-packages/click/<a href="http://decorators.py/" rel="nofollow">decorators.py</a>", line 21, in new_func<br>
    return f(get_current_context(), *args, </strong>kwargs)<br>
  File "/home/ubuntu/microblog/venv/lib/python3.8/site-packages/flask/<a href="http://cli.py/" rel="nofollow">cli.py</a>", line 426, in decorator<br>
    return <strong>ctx.invoke(f, <em>args, </em><em>kwargs)<br>
  File "/home/ubuntu/microblog/venv/lib/python3.8/site-packages/click/<a href="http://core.py/" rel="nofollow">core.py</a>", line 610, in invoke<br>
    return callback(</em>args, <strong>kwargs)<br>
  File "/home/ubuntu/microblog/venv/lib/python3.8/site-packages/flask_migrate/<a href="http://cli.py/" rel="nofollow">cli.py</a>", line 209, in current<br>
    _current(directory, verbose, head_only)<br>
  File "/home/ubuntu/microblog/venv/lib/python3.8/site-packages/flask_migrate/<strong>init</strong>.py", line 96, in wrapped<br>
    f(*args, </strong>kwargs)<br>
  File "/home/ubuntu/microblog/venv/lib/python3.8/site-packages/flask_migrate/__init</strong>.py", line 369, in current<br>
    command.current(config, verbose=verbose, head_only=head_only)<br>
  File "/home/ubuntu/microblog/venv/lib/python3.8/site-packages/alembic/<a href="http://command.py/" rel="nofollow">command.py</a>", line 515, in current<br>
    script.run_env()<br>
  File "/home/ubuntu/microblog/venv/lib/python3.8/site-packages/alembic/script/<a href="http://base.py/" rel="nofollow">base.py</a>", line 489, in run_env<br>
    util.load_python_file(self.dir, "<a href="http://env.py/" rel="nofollow">env.py</a>")<br>
  File "/home/ubuntu/microblog/venv/lib/python3.8/site-packages/alembic/util/<a href="http://pyfiles.py/" rel="nofollow">pyfiles.py</a>", line 98, in load_python_file<br>
    module = load_module_py(module_id, path)<br>
  File "/home/ubuntu/microblog/venv/lib/python3.8/site-packages/alembic/util/<a href="http://compat.py/" rel="nofollow">compat.py</a>", line 184, in load_module_py<br>
    spec.loader.exec_module(module)<br>
  File "&lt;frozen importlib._bootstrap_external&gt;", line 783, in exec_module<br>
  File "&lt;frozen importlib._bootstrap&gt;", line 219, in _call_with_frames_removed<br>
  File "migrations/<a href="http://env.py/" rel="nofollow">env.py</a>", line 27, in &lt;module&gt;<br>
    str(current_app.extensions['migrate'].db.engine.url).replace('%', '%%'))<br>
AttributeError: 'NoneType' object has no attribute 'engine'</p>
<p>My DATABASE_URL is set in my .env as you instructed and I entered the correct commands into mysql, although I could try redoing that whole install. Any ideas?</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/729e26a2a2c7ff24a71958d4aa4e5f35?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#216</span> <span class="badge text-bg-danger">Miguel Grinberg</span> said
    
    <span class="flask-moment" data-timestamp="2020-10-09T10:04:47Z" data-function="fromNow" data-refresh="0" style="display: none">2020-10-09T10:04:47Z</span>
  </p>
  <div>
    <p>@Brian: My guess is that you haven't properly initialized the Flask-Migrate extension. The error indicates that the extension does not know what your database instance is. Make sure you pass your database instance during initialization.</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/1fe1dadafe38109210f0cf8fc57c0f8c?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#217</span> <span class="badge text-bg-warning">Bob</span> said
    
    <span class="flask-moment" data-timestamp="2020-12-14T21:03:40Z" data-function="fromNow" data-refresh="0" style="display: none">2020-12-14T21:03:40Z</span>
  </p>
  <div>
    <p>Thanks for the great tutorial. I've enjoyed years of almost continuous up-time using the deployment described on this page, but I ran into an issue today, and I think it might be caused by the 301 redirect in my Nginx configuration.</p>
<p>When submitting forms in Google Chrome, I am receiving the warning message: "The information you’re about to submit is not secure." The message is discussed in more detail here: <a href="https://bugs.chromium.org/p/chromium/issues/detail?id=1158169" rel="nofollow">https://bugs.chromium.org/p/chromium/issues/detail?id=1158169</a></p>
<p>Can the Nginx configuration be changed to avoid this message?</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/729e26a2a2c7ff24a71958d4aa4e5f35?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#218</span> <span class="badge text-bg-danger">Miguel Grinberg</span> said
    
    <span class="flask-moment" data-timestamp="2020-12-14T23:11:13Z" data-function="fromNow" data-refresh="0" style="display: none">2020-12-14T23:11:13Z</span>
  </p>
  <div>
    <p>@Bob: I'm not familiar with this bug. What triggers it?</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/1fe1dadafe38109210f0cf8fc57c0f8c?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#219</span> <span class="badge text-bg-warning">Bob</span> said
    
    <span class="flask-moment" data-timestamp="2020-12-15T01:15:11Z" data-function="fromNow" data-refresh="0" style="display: none">2020-12-15T01:15:11Z</span>
  </p>
  <div>
    <p>After the user POSTs a form to <a href="https://abc.example.com/login" rel="nofollow">https://abc.example.com/login</a> they are redirected: return redirect(url_for('index'))</p>
<p>Then their browser tries to GET <a href="http://abc.example.com/index" rel="nofollow">http://abc.example.com/index</a> and Nginx 301 redirects it to <a href="https://abc.example.com/index" rel="nofollow">https://abc.example.com/index</a></p>
<p>Sometime yesterday it seems like Chrome started flagging this process as "not secure" because of the unencrypted request before the 301 redirect. I added the following line to the location block on my Nginx config and it seems to fix the issue, but I'm not sure why:<br>
proxy_set_header   X-Forwarded-Proto    $scheme;</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/e3a78c7758f6862a226db901a77b53ba?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#220</span> <span class="badge text-bg-warning">Esteban</span> said
    
    <span class="flask-moment" data-timestamp="2021-01-21T17:40:17Z" data-function="fromNow" data-refresh="0" style="display: none">2021-01-21T17:40:17Z</span>
  </p>
  <div>
    <p>Hi Miguel,  first i wanna thank you for ths Tutorial.i It's amazing!!!<br>
I have followed this to create my own app and now i have a question: If i wanted to host two flask apps in the same server, using the same gunicorn ang nginx, how can i configure them? Is it possibble to redicrect both to port 443?</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/729e26a2a2c7ff24a71958d4aa4e5f35?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#221</span> <span class="badge text-bg-danger">Miguel Grinberg</span> said
    
    <span class="flask-moment" data-timestamp="2021-01-21T23:20:25Z" data-function="fromNow" data-refresh="0" style="display: none">2021-01-21T23:20:25Z</span>
  </p>
  <div>
    <p>@Esteban: you can use the same nginx and different gunicorns, that is what makes the most sense. Using a single gunicorn instance for two apps is going to be tricky to configure. Nginx with two config files is fine as long as you set the server_name directive in both configs. Then nginx will be able to know which config to use based on the domain given in the incoming URL.</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/42070a7e6cd1c9bde697e611ea9d8a20?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#222</span> <span class="badge text-bg-warning">Sahana</span> said
    
    <span class="flask-moment" data-timestamp="2021-01-25T20:49:53Z" data-function="fromNow" data-refresh="0" style="display: none">2021-01-25T20:49:53Z</span>
  </p>
  <div>
    <p>HI Migueal,</p>
<p>I am taking your course. I am trying to install my application on MacOS. Can I still do the same steps , but installing all apps from packages instead of apt-get?</p>
<p>Thanks,<br>
Sahana</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/729e26a2a2c7ff24a71958d4aa4e5f35?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#223</span> <span class="badge text-bg-danger">Miguel Grinberg</span> said
    
    <span class="flask-moment" data-timestamp="2021-01-25T22:43:52Z" data-function="fromNow" data-refresh="0" style="display: none">2021-01-25T22:43:52Z</span>
  </p>
  <div>
    <p>@Sahana: you are going to have to adapt some of the instructions, it's not just changing apt-get for brew or something like that. But in essence yes, you should be able to do it.</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/2bdc9e84b0ccc3f128353585c43d0d27?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#224</span> <span class="badge text-bg-warning">Sam Archer</span> said
    
    <span class="flask-moment" data-timestamp="2021-02-09T07:15:13Z" data-function="fromNow" data-refresh="0" style="display: none">2021-02-09T07:15:13Z</span>
  </p>
  <div>
    <p>Thanks for such a brilliant tutorial. Can you explain what piece of code is doing the:<br>
- from app import db, db.create_all() commands that you used to set up the SQLite database?<br>
I initially couldn't get my Heroku deployment to work because the postgres database didn't have any tables in it. Then I came across advice to use:<br>
- heroku run python, and then the db import and create_all() commands. This then worked....<br>
Why did you not need to do this?<br>
Thanks</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/729e26a2a2c7ff24a71958d4aa4e5f35?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#225</span> <span class="badge text-bg-danger">Miguel Grinberg</span> said
    
    <span class="flask-moment" data-timestamp="2021-02-09T12:20:56Z" data-function="fromNow" data-refresh="0" style="display: none">2021-02-09T12:20:56Z</span>
  </p>
  <div>
    <p>@Sam: The database in this tutorial is set up through Flask-Migrate, by running the <code>flask db upgrade</code> command. This is better than your <code>db.create_all()</code> command because it also works when modifying the database structure.</p>
  </div>
</div>
    </li>
    
  </ul>
</div>

<nav aria-label="Page navigation">
  <ul class="pagination justify-content-center">
    <li class="page-item"><a class="page-link" href="1.html#comments">&laquo;&laquo;</a></li>
    <li class="page-item"><a class="page-link" href="8.html#comments">&laquo;</a></li>
    <li class="page-item"><a class="page-link" href="10.html#comments">&raquo;</a></li>
    <li class="page-item"><a class="page-link" href="0.html#comments">&raquo;&raquo;</a></li>
  </ul>
</nav>



<div id="comment-form">
  <h3>Leave a Comment</h3>

  
  
  

  
<form action="#comment-form" method="post">
  <input id="url" name="url" type="hidden" value="">
<input id="csrf_token" name="csrf_token" type="hidden" value="IjQyYjY5YzZlNTcyYjFkMTVlZGRkOWJjYjA3ZmFlYWFiNTg3YmU5ODki.Zxd0Xg.RrVw0bHhzLtWCN_kh7A72ak8lz4">
    
  <div class="mb-3">
    <label class="form-label" for="name">Name</label>
    <div class="input-group has-validation">
      <input class="form-control" id="name" name="name" required type="text" value="">
    </div>
  </div>

    
    
  <div class="mb-3">
    <label class="form-label" for="email">Email</label>
    <div class="input-group has-validation">
      <input class="form-control" id="email" name="email" required type="text" value="">
    </div>
  </div>

    
  <div class="mb-3">
    <label class="form-label" for="comment">Comment</label>
    <div class="input-group has-validation">
      <textarea class="form-control" id="comment" name="comment" required>
</textarea>
    </div>
  </div>

    
  <div class="mb-3">
    <label class="form-label" for="captcha">Captcha</label>
    <div class="input-group has-validation">
      
<script src='https://www.google.com/recaptcha/api.js' async defer></script>
<div class="g-recaptcha" data-sitekey="6Ld5Zs4SAAAAAOY0DOi4r18bgHlEaz41qAoRf__S"></div>

    </div>
  </div>

    
  <input class="btn btn-primary mb-3" id="submit" name="submit" type="submit" value="Submit">

      
</form>

</div>


</div>

      </div>
    </div>
    
    <div class="col-md-4">
      <div id="sidebar">
        
          
  



<div class="card">
  
  
  <div class="card-header">Flask Web Development, 2nd Edition</div>
  <a class="card-book-cover" href="https://amzn.to/3lE2mok">
    <img src="../../../static/flask2e-book-cover-small.png" alt="Flask Web Development, 2nd Edition">
  </a>
  <div class="card-body">
    <p class="card-text">If you want to learn modern web development techniques with Python and Flask, you may find the second edition of my <a href="https://amzn.to/3lE2mok">O'Reilly book</a> useful.</p>
  </div>
  <div class="card-body">
    <a class="card-link" href="https://amzn.to/3lE2mok">Click here to get this Book!</a><br />
  </div>

  
</div>
        
        <div class="card">
  <div class="card-header">About Miguel</div>
  <div class="card-body">
    <img style="float: right; margin: 0px 8px 8px 0px; padding: 4px; border: 1px solid #ccc;" src="../../../static/miguel.jpg" />
    <p class="card-text">Welcome to my blog!</p>
    <p class="card-text">I'm a software engineer and technical writer, currently living in Drogheda, Ireland.</p>
    <p class="card-text">You can also find me on <a href="https://twitter.com/miguelgrinberg">Twitter</a>, <a href="https://mstdn.social/@miguelgrinberg">Mastodon</a>, <a href="https://github.com/miguelgrinberg">Github</a>, <a href="http://www.linkedin.com/in/miguelgrinberg">LinkedIn</a>, <a href="https://youtube.com/miguelgrinberg">YouTube</a>, <a href="https://www.facebook.com/miguelgrinbergblog">Facebook</a> and <a href="https://patreon.com/miguelgrinberg">Patreon</a>.</p>
    <p class="card-text">Thank you for visiting!</p>
  </div>
</div>
        
        <div class="card" id="categories">
  <div class="card-header">Categories</div>
  <div class="card-body">
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/AI/feed"><img src="../../../static/rss-small.png" title="AI RSS Feed" label="AI RSS Feed" alt="AI RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/AI" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="AI" /> <small><em>2</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/AWS/feed"><img src="../../../static/rss-small.png" title="AWS RSS Feed" label="AWS RSS Feed" alt="AWS RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/AWS" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="AWS" /> <small><em>1</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Arduino/feed"><img src="../../../static/rss-small.png" title="Arduino RSS Feed" label="Arduino RSS Feed" alt="Arduino RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Arduino" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Arduino" /> <small><em>7</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Authentication/feed"><img src="../../../static/rss-small.png" title="Authentication RSS Feed" label="Authentication RSS Feed" alt="Authentication RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Authentication" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Authentication" /> <small><em>10</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Blog/feed"><img src="../../../static/rss-small.png" title="Blog RSS Feed" label="Blog RSS Feed" alt="Blog RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Blog" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Blog" /> <small><em>1</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/C++/feed"><img src="../../../static/rss-small.png" title="C++ RSS Feed" label="C++ RSS Feed" alt="C++ RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/C++" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="C++" /> <small><em>5</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/CSS/feed"><img src="../../../static/rss-small.png" title="CSS RSS Feed" label="CSS RSS Feed" alt="CSS RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/CSS" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="CSS" /> <small><em>1</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Cloud/feed"><img src="../../../static/rss-small.png" title="Cloud RSS Feed" label="Cloud RSS Feed" alt="Cloud RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Cloud" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Cloud" /> <small><em>10</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Database/feed"><img src="../../../static/rss-small.png" title="Database RSS Feed" label="Database RSS Feed" alt="Database RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Database" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Database" /> <small><em>22</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Docker/feed"><img src="../../../static/rss-small.png" title="Docker RSS Feed" label="Docker RSS Feed" alt="Docker RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Docker" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Docker" /> <small><em>5</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Filmmaking/feed"><img src="../../../static/rss-small.png" title="Filmmaking RSS Feed" label="Filmmaking RSS Feed" alt="Filmmaking RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Filmmaking" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Filmmaking" /> <small><em>6</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Flask/feed"><img src="../../../static/rss-small.png" title="Flask RSS Feed" label="Flask RSS Feed" alt="Flask RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Flask" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Flask" /> <small><em>126</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Games/feed"><img src="../../../static/rss-small.png" title="Games RSS Feed" label="Games RSS Feed" alt="Games RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Games" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Games" /> <small><em>1</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Heroku/feed"><img src="../../../static/rss-small.png" title="Heroku RSS Feed" label="Heroku RSS Feed" alt="Heroku RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Heroku" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Heroku" /> <small><em>1</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/IoT/feed"><img src="../../../static/rss-small.png" title="IoT RSS Feed" label="IoT RSS Feed" alt="IoT RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/IoT" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="IoT" /> <small><em>8</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/JavaScript/feed"><img src="../../../static/rss-small.png" title="JavaScript RSS Feed" label="JavaScript RSS Feed" alt="JavaScript RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/JavaScript" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="JavaScript" /> <small><em>35</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/MicroPython/feed"><img src="../../../static/rss-small.png" title="MicroPython RSS Feed" label="MicroPython RSS Feed" alt="MicroPython RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/MicroPython" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="MicroPython" /> <small><em>9</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Microdot/feed"><img src="../../../static/rss-small.png" title="Microdot RSS Feed" label="Microdot RSS Feed" alt="Microdot RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Microdot" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Microdot" /> <small><em>1</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Microservices/feed"><img src="../../../static/rss-small.png" title="Microservices RSS Feed" label="Microservices RSS Feed" alt="Microservices RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Microservices" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Microservices" /> <small><em>2</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Movie Reviews/feed"><img src="../../../static/rss-small.png" title="Movie Reviews RSS Feed" label="Movie Reviews RSS Feed" alt="Movie Reviews RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Movie Reviews" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Movie Reviews" /> <small><em>5</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/OpenStack/feed"><img src="../../../static/rss-small.png" title="OpenStack RSS Feed" label="OpenStack RSS Feed" alt="OpenStack RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/OpenStack" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="OpenStack" /> <small><em>1</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Personal/feed"><img src="../../../static/rss-small.png" title="Personal RSS Feed" label="Personal RSS Feed" alt="Personal RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Personal" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Personal" /> <small><em>3</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Photography/feed"><img src="../../../static/rss-small.png" title="Photography RSS Feed" label="Photography RSS Feed" alt="Photography RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Photography" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Photography" /> <small><em>7</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Product Reviews/feed"><img src="../../../static/rss-small.png" title="Product Reviews RSS Feed" label="Product Reviews RSS Feed" alt="Product Reviews RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Product Reviews" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Product Reviews" /> <small><em>2</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Programming/feed"><img src="../../../static/rss-small.png" title="Programming RSS Feed" label="Programming RSS Feed" alt="Programming RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Programming" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Programming" /> <small><em>187</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Project Management/feed"><img src="../../../static/rss-small.png" title="Project Management RSS Feed" label="Project Management RSS Feed" alt="Project Management RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Project Management" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Project Management" /> <small><em>1</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Python/feed"><img src="../../../static/rss-small.png" title="Python RSS Feed" label="Python RSS Feed" alt="Python RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Python" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Python" /> <small><em>169</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/REST/feed"><img src="../../../static/rss-small.png" title="REST RSS Feed" label="REST RSS Feed" alt="REST RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/REST" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="REST" /> <small><em>7</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Rackspace/feed"><img src="../../../static/rss-small.png" title="Rackspace RSS Feed" label="Rackspace RSS Feed" alt="Rackspace RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Rackspace" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Rackspace" /> <small><em>1</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Raspberry Pi/feed"><img src="../../../static/rss-small.png" title="Raspberry Pi RSS Feed" label="Raspberry Pi RSS Feed" alt="Raspberry Pi RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Raspberry Pi" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Raspberry Pi" /> <small><em>8</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/React/feed"><img src="../../../static/rss-small.png" title="React RSS Feed" label="React RSS Feed" alt="React RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/React" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="React" /> <small><em>18</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Robotics/feed"><img src="../../../static/rss-small.png" title="Robotics RSS Feed" label="Robotics RSS Feed" alt="Robotics RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Robotics" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Robotics" /> <small><em>6</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Security/feed"><img src="../../../static/rss-small.png" title="Security RSS Feed" label="Security RSS Feed" alt="Security RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Security" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Security" /> <small><em>12</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Video/feed"><img src="../../../static/rss-small.png" title="Video RSS Feed" label="Video RSS Feed" alt="Video RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Video" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Video" /> <small><em>22</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/WebSocket/feed"><img src="../../../static/rss-small.png" title="WebSocket RSS Feed" label="WebSocket RSS Feed" alt="WebSocket RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/WebSocket" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="WebSocket" /> <small><em>2</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Webcast/feed"><img src="../../../static/rss-small.png" title="Webcast RSS Feed" label="Webcast RSS Feed" alt="Webcast RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Webcast" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Webcast" /> <small><em>3</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Windows/feed"><img src="../../../static/rss-small.png" title="Windows RSS Feed" label="Windows RSS Feed" alt="Windows RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Windows" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Windows" /> <small><em>1</em></small>
      </form>
    </div>
    
  </div>
</div>
        
      </div>
    </div>
    
  </div>
  <div id="footer">
    
    <p>&copy; 2012-<script type="text/javascript">document.write(new Date().getFullYear());</script> by Miguel Grinberg. All rights reserved. <a href="mailto:webmaster _at_ miguelgrinberg _dot_ com">Questions?</a></p>
  </div>
</div>

  
    <script src="../../../../cdn.jsdelivr.net/npm/bootstrap%405.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
  <script type="text/javascript" src="../../../static/prettify.js"></script>
  <script src="../../../../cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.4/moment-with-locales.min.js" integrity="sha512-42PE0rd+wZ2hNXftlM78BSehIGzezNeQuzihiBCvUEB3CVxHvsShF86wBWwQORNxNINlBPuq7rG4WWhNiTVHFg==" crossorigin="anonymous"></script>

<script>
moment.locale("en");
function flask_moment_render(elem) {{
    const timestamp = moment(elem.dataset.timestamp);
    const func = elem.dataset.function;
    const format = elem.dataset.format;
    const timestamp2 = elem.dataset.timestamp2;
    const no_suffix = elem.dataset.nosuffix;
    const units = elem.dataset.units;
    let args = [];
    if (format)
        args.push(format);
    if (timestamp2)
        args.push(moment(timestamp2));
    if (no_suffix)
        args.push(no_suffix);
    if (units)
        args.push(units);
    elem.textContent = timestamp[func].apply(timestamp, args);
    elem.classList.remove('flask-moment');
    elem.style.display = "";
}}
function flask_moment_render_all() {{
    const moments = document.querySelectorAll('.flask-moment');
    moments.forEach(function(moment) {{
        flask_moment_render(moment);
        const refresh = moment.dataset.refresh;
        if (refresh && refresh > 0) {{
            (function(elem, interval) {{
                setInterval(function() {{
                    flask_moment_render(elem);
                }}, interval);
            }})(moment, refresh);
        }}
    }})
}}
document.addEventListener("DOMContentLoaded", flask_moment_render_all);
</script>

  
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-20EHZP9GRZ"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-20EHZP9GRZ');
  </script>
  
  <script type="text/javascript">
    function setThemeUI() {
      document.getElementById('select-theme-auto').classList.remove('active');
      document.getElementById('select-theme-light').classList.remove('active');
      document.getElementById('select-theme-dark').classList.remove('active');
      const theme = getPreferredTheme();
      const actualTheme = document.documentElement.getAttribute('data-bs-theme', 'light');
      document.getElementById('select-theme-' + theme).classList.add('active');
      document.getElementById('current-theme').href.baseVal = `#icon-theme-${actualTheme}`;
    };

    function updateTheme(theme) {
      if (theme === 'auto') {
        localStorage.removeItem('theme')
      }
      else {
        localStorage.setItem('theme', theme)
      }
      setTheme(getPreferredTheme());
    }

    setThemeUI();

    const darkModePreference = window.matchMedia("(prefers-color-scheme: dark)");
    darkModePreference.addEventListener("change", e => {
      if (getPreferredTheme() === 'auto') {
        setTheme('auto');
      }
    });

    document.addEventListener("DOMContentLoaded", () => {
      // add prettyprint class to all <pre><code></code></pre> blocks
      let prettify = false;
      document.querySelectorAll('div.post-body pre code').forEach((code) => {
        code.parentNode.classList.add('prettyprint');
        prettify = true;
      });
      prettyPrint();
    });
  </script>

  </body>

<!-- Mirrored from blog.miguelgrinberg.com/post/the-flask-mega-tutorial-part-xvii-deployment-on-linux-2018/page/9 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 22 Oct 2024 09:46:15 GMT -->
</html>