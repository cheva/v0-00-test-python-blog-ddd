<!doctype html>
<html lang="en">
  
<!-- Mirrored from blog.miguelgrinberg.com/post/the-flask-mega-tutorial-part-x-email-support-2018/page/4 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 22 Oct 2024 08:50:14 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    
  <script type="text/javascript">
    function getPreferredTheme() {
      const storedTheme = localStorage.getItem('theme')
      if (storedTheme) {
        return storedTheme
      }
      return 'auto';
    }

    function setTheme(theme) {
      if (theme === 'auto') {
        theme = window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light'
      }
      document.documentElement.setAttribute('data-bs-theme', theme);
    };

    setTheme(getPreferredTheme());
  </script>
  
    <title>
  
    The Flask Mega-Tutorial Part X: Email Support (2018) - miguelgrinberg.com
  
</title>
  
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="description" content="miguelgrinberg.com">
  <meta name="copyright" content="Copyright (c) 2012-2024 Miguel Grinberg">
  <meta name="author" content="Miguel Grinberg">
  
  <meta name="keywords" content="Programming, Python, Flask, Email, Flask-Mail, Gmail">
  
  
  <link rel="canonical" href="../../the-flask-mega-tutorial-part-x-email-support-2018.html">
  

  
    <link href="../../../../cdn.jsdelivr.net/npm/bootstrap%405.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
  <link rel="preconnect" href="https://fonts.googleapis.com/">
  <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400&amp;display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@700&amp;display=swap" rel="stylesheet">

  <link href="../../../static/tomorrow.min.css" type="text/css" rel="stylesheet" />
  <link href="../../../static/tomorrow-night.min.css" type="text/css" rel="stylesheet" />
  <link href="../../../static/social.css" rel="stylesheet" type="text/css" />
  <link href="../../../static/style_20231230.css" rel="stylesheet" type="text/css" />

  <link rel="shortcut icon" href="https://blog.miguelgrinberg.com/static/favicon.ico">
  <link rel="alternate" type="application/rss+xml" href="https://blog.miguelgrinberg.com/feed" title="miguelgrinberg.com RSS feed">

    <meta property="og:title" content="The Flask Mega-Tutorial Part X: Email Support (2018)">
    <meta property="og:description" content="(Great news! There is a new version of this tutorial!)This is the tenth installment of the Flask Mega-Tutorial series, in which I&#39;m going to tell you how your application can send emails to your…">
    <meta property="og:image" content="https://blog.miguelgrinberg.com/static/cards/the-flask-mega-tutorial-part-x-email-support-2018.jpg">
    <meta property="og:url" content="https://blog.miguelgrinberg.com/post/the-flask-mega-tutorial-part-x-email-support-2018">
    <meta name="twitter:title" content="The Flask Mega-Tutorial Part X: Email Support (2018)">
    <meta name="twitter:description" content="(Great news! There is a new version of this tutorial!)This is the tenth installment of the Flask Mega-Tutorial series, in which I&#39;m going to tell you how your application can send emails to your…">
    <meta name="twitter:image" content="https://blog.miguelgrinberg.com/static/cards/the-flask-mega-tutorial-part-x-email-support-2018.jpg">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@miguelgrinberg">

  </head>
  <body>
    <svg style="display: none" version="2.0">
      <defs>
        <symbol id="icon-theme-auto" xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="bi bi-circle-half" viewBox="0 0 16 16">
          <path d="M8 15A7 7 0 1 0 8 1zm0 1A8 8 0 1 1 8 0a8 8 0 0 1 0 16"/>
        </symbol>
        <symbol id="icon-theme-light" xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="bi bi-brightness-high-fill" viewBox="0 0 16 16">
          <path d="M8 11a3 3 0 1 1 0-6 3 3 0 0 1 0 6m0 1a4 4 0 1 0 0-8 4 4 0 0 0 0 8M8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0m0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13m8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5M3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8m10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0m-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707M4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"/>
        </symbol>
        <symbol id="icon-theme-dark" xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="bi bi-moon-stars-fill" viewBox="0 0 16 16">
          <path d="M6 .278a.768.768 0 0 1 .08.858 7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278"/>
          <path d="M10.794 3.148a.217.217 0 0 1 .412 0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217 0 0 1 0 .412l-1.162.387a1.734 1.734 0 0 0-1.097 1.097l-.387 1.162a.217.217 0 0 1-.412 0l-.387-1.162A1.734 1.734 0 0 0 9.31 6.593l-1.162-.387a.217.217 0 0 1 0-.412l1.162-.387a1.734 1.734 0 0 0 1.097-1.097l.387-1.162zM13.863.099a.145.145 0 0 1 .274 0l.258.774c.115.346.386.617.732.732l.774.258a.145.145 0 0 1 0 .274l-.774.258a1.156 1.156 0 0 0-.732.732l-.258.774a.145.145 0 0 1-.274 0l-.258-.774a1.156 1.156 0 0 0-.732-.732l-.774-.258a.145.145 0 0 1 0-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z"/>
        </symbol>
      </defs>
    </svg>
<nav class="navbar navbar-expand-lg">
  <div class="container">
    <a class="navbar-brand" href="https://blog.miguelgrinberg.com/index">miguelgrinberg.com</a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarCollapse">
      <ul class="navbar-nav me-auto">
        <li class="nav-item"><a class="nav-link" aria-current="page" href="https://blog.miguelgrinberg.com/index">Home</a></li>
        <li class="nav-item"><a class="nav-link" aria-current="page" href="../../my-courses-and-books.html">My Courses and Books</a></li>
        <li class="nav-item"><a class="nav-link" aria-current="page" href="../../hire-me.html">Consulting</a></li>
        <li class="nav-item"><a class="nav-link" aria-current="page" href="../../about-me.html">About Me</a></li>
        
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
            <svg width="20" height="20" version="2.0"><use id="current-theme" href="#icon-theme-light"></svg>
          </a>
          <ul class="dropdown-menu">
            <li>
              <a id="select-theme-light" class="dropdown-item" href="javascript:updateTheme('light')">
                <svg width="16" height="16" version="2.0"><use href="#icon-theme-light"></svg>&nbsp; Light Mode
              </a>
            </li>
            <li>
              <a id="select-theme-dark" class="dropdown-item" href="javascript:updateTheme('dark')">
                <svg width="16" height="16" version="2.0"><use href="#icon-theme-dark"></svg>&nbsp; Dark Mode
              </a>
            </li>
            <li><hr class="dropdown-divider"></li>
            <li>
              <a id="select-theme-auto" class="dropdown-item" href="javascript:updateTheme('auto')">
                <svg width="16" height="16" version="2.0"><use href="#icon-theme-auto"></svg>&nbsp; System Default
              </a>
            </li>
          </ul>
        </li>
        
      </ul>
      <ul class="navbar-nav">
        <li class="nav-item social-icons">
          <a type="application/rss+xml" href="https://blog.miguelgrinberg.com/feed"><img src="../../../static/social/rss.png" alt="RSS Feed" title="RSS Feed" /></a>
          <a href="https://twitter.com/miguelgrinberg"><img src="../../../static/social/twitter.png" alt="Twitter" title="Twitter" /></a>
          <a rel="me" href="https://mstdn.social/@miguelgrinberg"><img src="../../../static/social/mastodon.png" alt="Mastodon" title="Mastodon" /></a>
          <a href="http://github.com/miguelgrinberg"><img src="../../../static/social/github.png" alt="GitHub" title="GitHub" /></a>
          <a href="https://youtube.com/miguelgrinberg"><img src="../../../static/social/youtube.png" alt="YouTube" title="YouTube" /></a>
          <a href="http://www.linkedin.com/in/miguelgrinberg"><img src="../../../static/social/linkedin.png" alt="LinkedIn" title="LinkedIn" /></a>
          <a href="https://patreon.com/miguelgrinberg"><img src="../../../static/social/patreon.png" alt="Patreon" title="Patreon" /></a>
          <!--<a href="https://www.facebook.com/miguelgrinbergblog"><img src="/static/social/facebook.png" alt="Facebook" title="Facebook" /></a>-->
        </li>
      </ul>
    </div>
  </div>
</nav>

<div class="container">
  <div class="row">
    <div class="col-md-8">
      <div id="main">
        
        
        
        
        

<div class="post">

<div class="post-header">
  <h1><a href="../../the-flask-mega-tutorial-part-x-email-support-2018.html">The Flask Mega-Tutorial Part X: Email Support (2018)</a></h1>
  <h2>
    Posted by
    <form action="https://blog.miguelgrinberg.com/author/Miguel Grinberg" method="POST">
      <input type="submit" class="btn btn-danger btn-sm" value="Miguel Grinberg" />
    </form>
    on
    <button class="btn btn-secondary btn-sm" disabled><span class="flask-moment" data-timestamp="2018-02-06T15:11:28Z" data-function="format" data-format="LL" data-refresh="0" style="display: none">2018-02-06T15:11:28Z</span></button>
    under
    
      <form action="https://blog.miguelgrinberg.com/category/Programming" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Programming" />
      </form>
    
      <form action="https://blog.miguelgrinberg.com/category/Python" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Python" />
      </form>
    
      <form action="https://blog.miguelgrinberg.com/category/Flask" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Flask" />
      </form>
    
    
  </h2>
</div>
<div class="post-body"><p><em>(Great news! There is a <a href="../../the-flask-mega-tutorial-part-i-hello-world.html">new version of this tutorial</a>!)</em></p>
<p>This is the tenth installment of the Flask Mega-Tutorial series, in which I'm going to tell you how your application can send emails to your users, and how to build a password recovery feature on top of the email support.</p>
<p>For your reference, below is a list of the articles in this series.</p>
<ul>
<li><a href="../../the-flask-mega-tutorial-part-i-hello-world-2018.html">Chapter 1: Hello, World!</a></li>
<li><a href="../../the-flask-mega-tutorial-part-ii-templates-2018.html">Chapter 2: Templates</a></li>
<li><a href="../../the-flask-mega-tutorial-part-iii-web-forms-2018.html">Chapter 3: Web Forms</a></li>
<li><a href="../../the-flask-mega-tutorial-part-iv-database-2018.html">Chapter 4: Database</a></li>
<li><a href="../../the-flask-mega-tutorial-part-v-user-logins-2018.html">Chapter 5: User Logins</a></li>
<li><a href="../../the-flask-mega-tutorial-part-vi-profile-page-and-avatars-2018.html">Chapter 6: Profile Page and Avatars</a></li>
<li><a href="../../the-flask-mega-tutorial-part-vii-error-handling-2018.html">Chapter 7: Error Handling</a></li>
<li><a href="../../the-flask-mega-tutorial-part-viii-followers-2018.html">Chapter 8: Followers</a></li>
<li><a href="../../the-flask-mega-tutorial-part-ix-pagination-2018.html">Chapter 9: Pagination</a></li>
<li><a href="../../the-flask-mega-tutorial-part-x-email-support-2018.html">Chapter 10: Email Support</a> (this article)</li>
<li><a href="../../the-flask-mega-tutorial-part-xi-facelift-2018.html">Chapter 11: Facelift</a></li>
<li><a href="../../the-flask-mega-tutorial-part-xii-dates-and-times-2018.html">Chapter 12: Dates and Times</a></li>
<li><a href="../../the-flask-mega-tutorial-part-xiii-i18n-and-l10n-2018.html">Chapter 13: I18n and L10n</a></li>
<li><a href="../../the-flask-mega-tutorial-part-xiv-ajax-2018.html">Chapter 14: Ajax</a></li>
<li><a href="../../the-flask-mega-tutorial-part-xv-a-better-application-structure-2018.html">Chapter 15: A Better Application Structure</a></li>
<li><a href="../../the-flask-mega-tutorial-part-xvi-full-text-search-2018.html">Chapter 16: Full-Text Search</a></li>
<li><a href="../../the-flask-mega-tutorial-part-xvii-deployment-on-linux-2018.html">Chapter 17: Deployment on Linux</a></li>
<li><a href="../../the-flask-mega-tutorial-part-xviii-deployment-on-heroku-2018.html">Chapter 18: Deployment on Heroku</a></li>
<li><a href="../../the-flask-mega-tutorial-part-xix-deployment-on-docker-containers-2018.html">Chapter 19: Deployment on Docker Containers</a></li>
<li><a href="../../the-flask-mega-tutorial-part-xx-some-javascript-magic-2018.html">Chapter 20: Some JavaScript Magic</a></li>
<li><a href="../../the-flask-mega-tutorial-part-xxi-user-notifications-2018.html">Chapter 21: User Notifications</a></li>
<li><a href="../../the-flask-mega-tutorial-part-xxii-background-jobs-2018.html">Chapter 22: Background Jobs</a></li>
<li><a href="../../the-flask-mega-tutorial-part-xxiii-application-programming-interfaces-apis-2018.html">Chapter 23: Application Programming Interfaces (APIs)</a></li>
</ul>
<p>The application is doing pretty well on the database front now, so in this chapter I want to depart from that topic and add another important piece that most web applications need, which is the sending of emails.</p>
<p>Why does an application need to email its users? There are many reasons, but one common one is to solve authentication related problems. In this chapter I'm going to add a password reset feature for users that forget their password. When a user requests a password reset, the application will send an email with a specially crafted link. The user then needs to click that link to have access to a form in which to set a new password.</p>
<p><em>The GitHub links for this chapter are: <a href="https://github.com/miguelgrinberg/microblog/tree/v0.10">Browse</a>, <a href="https://github.com/miguelgrinberg/microblog-2018/archive/v0.10.zip">Zip</a>, <a href="https://github.com/miguelgrinberg/microblog/compare/v0.9...v0.10">Diff</a>.</em></p>
<h2>Introduction to Flask-Mail</h2>
<p>As far as the actual sending of emails, Flask has a popular extension called <a href="https://pythonhosted.org/Flask-Mail/">Flask-Mail</a> that can make the task very easy. As always, this extension is installed with pip:</p>
<pre><code>(venv) $ pip install flask-mail
</code></pre>
<p>The password reset links will have a secure token in them. To generate these tokens, I'm going to use <a href="https://jwt.io/">JSON Web Tokens</a>, which also have a popular Python package:</p>
<pre><code>(venv) $ pip install pyjwt
</code></pre>
<p>The Flask-Mail extension is configured from the <code>app.config</code> object. Remember when in <a href="../../the-flask-mega-tutorial-part-vii-error-handling-2018.html">Chapter 7</a> I added the email configuration for sending yourself an email whenever an error occurred in production? I did not tell you this then, but my choice of configuration variables was modeled after Flask-Mail's requirements, so there isn't really any additional work that is needed, the configuration variables are already in the application.</p>
<p>Like most Flask extensions, you need to create an instance right after the Flask application is created. In this case this is an object of class <code>Mail</code>:</p>
<p class="code_title"><i>app/__init__.py</i>: Flask-Mail instance.</p>

<pre><code class="language-python"># ...
from flask_mail import Mail

app = Flask(__name__)
# ...
mail = Mail(app)
</code></pre>
<p>If you are planning to test sending of emails you have the same options I mentioned in <a href="../../the-flask-mega-tutorial-part-vii-error-handling-2018.html">Chapter 7</a>. If you want to use an emulated email server, Python provides one that is very handy that you can start in a second terminal with the following command:</p>
<pre><code>(venv) $ python -m smtpd -n -c DebuggingServer localhost:8025
</code></pre>
<p>To configure for this server you will need to set two environment variables:</p>
<pre><code class="language-bash">(venv) $ export MAIL_SERVER=localhost
(venv) $ export MAIL_PORT=8025
</code></pre>
<p>If you prefer to have emails sent for real, you need to use a real email server. If you have one, then you just need to set the <code>MAIL_SERVER</code>, <code>MAIL_PORT</code>, <code>MAIL_USE_TLS</code>, <code>MAIL_USERNAME</code> and <code>MAIL_PASSWORD</code> environment variables for it. If you want a quick solution, you can use a Gmail account to send email, with the following settings:</p>
<pre><code class="language-bash">(venv) $ export MAIL_SERVER=smtp.googlemail.com
(venv) $ export MAIL_PORT=587
(venv) $ export MAIL_USE_TLS=1
(venv) $ export MAIL_USERNAME=&lt;your-gmail-username&gt;
(venv) $ export MAIL_PASSWORD=&lt;your-gmail-password&gt;
</code></pre>
<p>If you are using Microsoft Windows, you need to replace <code>export</code> with <code>set</code> in each of the <code>export</code> statements above.</p>
<p>Remember that the security features in your Gmail account may prevent the application from sending emails through it unless you explicitly allow "less secure apps" access to your Gmail account. You can read about this <a href="https://support.google.com/accounts/answer/6010255?hl=en">here</a>, and if you are concerned about the security of your account, you can create a secondary account that you configure just for testing emails, or you can enable less secure apps only temporarily to run your tests and then revert back to the more secure default.</p>
<p>If you'd like to use a real email server, but don't want to complicate yourself with the Gmail configuration, <a href="https://sendgrid.com/">SendGrid</a> is a good option that gives you 100 emails per day using a free account.</p>
<h2>Flask-Mail Usage</h2>
<p>To learn how Flask-Mail works, I'll show you how to send an email from a Python shell. So fire up Python with <code>flask shell</code>, and then run the following commands:</p>
<pre><code class="language-python">&gt;&gt;&gt; from flask_mail import Message
&gt;&gt;&gt; from app import mail
&gt;&gt;&gt; msg = Message('test subject', sender=app.config['ADMINS'][0],
... recipients=['your-email@example.com'])
&gt;&gt;&gt; msg.body = 'text body'
&gt;&gt;&gt; msg.html = '&lt;h1&gt;HTML body&lt;/h1&gt;'
&gt;&gt;&gt; mail.send(msg)
</code></pre>
<p>The snippet of code above will send an email to a list of email addresses that you put in the <code>recipients</code> argument. I put the sender as the first configured admin (I've added the <code>ADMINS</code> configuration variable in <a href="../../the-flask-mega-tutorial-part-vii-error-handling-2018.html">Chapter 7</a>). The email will have plain text and HTML versions, so depending on how your email client is configured you may see one or the other.</p>
<p>So as you see, this is pretty simple. Now let's integrate emails into the application.</p>
<h2>A Simple Email Framework</h2>
<p>I will begin by writing a helper function that sends an email, which is basically a generic version of the shell exercise from the previous section. I will put this function in a new module called <code>app/email.py</code>:</p>
<p class="code_title"><i>app/email.py</i>: Email sending wrapper function.</p>

<pre><code class="language-python">from flask_mail import Message
from app import mail

def send_email(subject, sender, recipients, text_body, html_body):
    msg = Message(subject, sender=sender, recipients=recipients)
    msg.body = text_body
    msg.html = html_body
    mail.send(msg)
</code></pre>
<p>Flask-Mail supports some features that I'm not utilizing here such as Cc and Bcc lists. Be sure to check the <a href="https://pythonhosted.org/Flask-Mail/">Flask-Mail Documentation</a> if you are interested in those options.</p>
<h2>Requesting a Password Reset</h2>
<p>As I mentioned above, I want users to have the option to request their password to be reset. For this purpose I'm going to add a link in the login page:</p>
<p class="code_title"><i>app/templates/login.html</i>: Password reset link in login form.</p>

<pre><code class="language-html">    &lt;p&gt;
        Forgot Your Password?
        &lt;a href=&quot;{{ url_for('reset_password_request') }}&quot;&gt;Click to Reset It&lt;/a&gt;
    &lt;/p&gt;
</code></pre>
<p>When the user clicks the link, a new web form will appear that requests the user's email address as a way to initiate the password reset process. Here is the form class:</p>
<p class="code_title"><i>app/forms.py</i>: Reset password request form.</p>

<pre><code class="language-python">class ResetPasswordRequestForm(FlaskForm):
    email = StringField('Email', validators=[DataRequired(), Email()])
    submit = SubmitField('Request Password Reset')
</code></pre>
<p>And here is the corresponding HTML template:</p>
<p class="code_title"><i>app/templates/reset_password_request.html</i>: Reset password request template.</p>

<pre><code class="language-html">{% extends &quot;base.html&quot; %}

{% block content %}
    &lt;h1&gt;Reset Password&lt;/h1&gt;
    &lt;form action=&quot;&quot; method=&quot;post&quot;&gt;
        {{ form.hidden_tag() }}
        &lt;p&gt;
            {{ form.email.label }}&lt;br&gt;
            {{ form.email(size=64) }}&lt;br&gt;
            {% for error in form.email.errors %}
            &lt;span style=&quot;color: red;&quot;&gt;[{{ error }}]&lt;/span&gt;
            {% endfor %}
        &lt;/p&gt;
        &lt;p&gt;{{ form.submit() }}&lt;/p&gt;
    &lt;/form&gt;
{% endblock %}
</code></pre>
<p>I also need a view function to handle this form:</p>
<p class="code_title"><i>app/routes.py</i>: Reset password request view function.</p>

<pre><code class="language-python">from app.forms import ResetPasswordRequestForm
from app.email import send_password_reset_email

@app.route('/reset_password_request', methods=['GET', 'POST'])
def reset_password_request():
    if current_user.is_authenticated:
        return redirect(url_for('index'))
    form = ResetPasswordRequestForm()
    if form.validate_on_submit():
        user = User.query.filter_by(email=form.email.data).first()
        if user:
            send_password_reset_email(user)
        flash('Check your email for the instructions to reset your password')
        return redirect(url_for('login'))
    return render_template('reset_password_request.html',
                           title='Reset Password', form=form)
</code></pre>
<p>This view function is fairly similar to others that process a form. I start by making sure the user is not logged in. If the user is logged in, then there is no point in using the password reset functionality, so I redirect to the index page.</p>
<p>When the form is submitted and valid, I look up the user by the email provided by the user in the form. If I find the user, I send a password reset email. The <code>send_password_reset_email()</code> helper function performs this task. I will show you this function below.</p>
<p>After the email is sent, I flash a message directing the user to look for the email for further instructions, and then redirect back to the login page. You may notice that the flashed message is displayed even if the email provided by the user is unknown. This is so that clients cannot use this form to figure out if a given user is a member or not.</p>
<h2>Password Reset Tokens</h2>
<p>Before I implement the <code>send_password_reset_email()</code> function, I need to have a way to generate a password request link. This is going to be the link that is sent to the user via email. When the link is clicked, a page where a new password can be set is presented to the user. The tricky part of this plan is to make sure that only valid reset links can be used to reset an account's password.</p>
<p>The links are going to be provisioned with a <em>token</em>, and this token will be validated before allowing the password change, as proof that the user that requested the email has access to the email address on the account. A very popular token standard for this type of process is the JSON Web Token, or JWT. The nice thing about JWTs is that they are self contained. You can send a token to a user in an email, and when the user clicks the link that feeds the token back into the application, it can be verified on its own.</p>
<p>How do JWTs work? Nothing better than a quick Python shell session to understand them:</p>
<pre><code class="language-python">&gt;&gt;&gt; import jwt
&gt;&gt;&gt; token = jwt.encode({'a': 'b'}, 'my-secret', algorithm='HS256')
&gt;&gt;&gt; token
'eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJhIjoiYiJ9.dvOo58OBDHiuSHD4uW88nfJik_sfUHq1mDi4G0'
&gt;&gt;&gt; jwt.decode(token, 'my-secret', algorithms=['HS256'])
{'a': 'b'}
</code></pre>
<p>The <code>{'a': 'b'}</code> dictionary is an example payload that is going to be written into the token. To make the token secure, a secret key needs to be provided to be used in creating a cryptographic signature. For this example I have used the string <code>'my-secret'</code>, but with the application I'm going to use the <code>SECRET_KEY</code> from the configuration. The <code>algorithm</code> argument specifies how the token is to be generated. The <code>HS256</code> algorithm is the most widely used.</p>
<p>As you can see the resulting token is a long sequence of characters. But do not think that this is an encrypted token. The contents of the token, including the payload, can be decoded easily by anyone (don't believe me? Copy the above token and then enter it in the <a href="https://jwt.io/#debugger-io">JWT debugger</a> to see its contents). What makes the token secure is that the payload is <em>signed</em>. If somebody tried to forge or tamper with the payload in a token, then the signature would be invalidated, and to generate a new signature the secret key is needed. When a token is verified, the contents of the payload are decoded and returned back to the caller. If the token's signature was validated, then the payload can be trusted as authentic.</p>
<p>The payload that I'm going to use for the password reset tokens is going to have the format <code>{'reset_password': user_id, 'exp': token_expiration}</code>. The <code>exp</code> field is standard for JWTs and if present it indicates an expiration time for the token. If a token has a valid signature, but it is past its expiration timestamp, then it will also be considered invalid. For the password reset feature, I'm going to give these tokens 10 minutes of life.</p>
<p>When the user clicks on the emailed link, the token is going to be sent back to the application as part of the URL, and the first thing the view function that handles this URL will do is to verify it. If the signature is valid, then the user can be identified by the ID stored in the payload. Once the user's identity is known, the application can ask for a new password and set it on the user's account.</p>
<p>Since these tokens belong to users, I'm going to write the token generation and verification functions as methods in the <code>User</code> model:</p>
<p class="code_title"><i>app/models.py</i>: Reset password token methods.</p>

<pre><code class="language-python">from time import time
import jwt
from app import app

class User(UserMixin, db.Model):
    # ...

    def get_reset_password_token(self, expires_in=600):
        return jwt.encode(
            {'reset_password': self.id, 'exp': time() + expires_in},
            app.config['SECRET_KEY'], algorithm='HS256')

    @staticmethod
    def verify_reset_password_token(token):
        try:
            id = jwt.decode(token, app.config['SECRET_KEY'],
                            algorithms=['HS256'])['reset_password']
        except:
            return
        return User.query.get(id)
</code></pre>
<p>The <code>get_reset_password_token()</code> function returns a JWT token as a string, which is generated directly by the <code>jwt.encode()</code> function.</p>
<p>The <code>verify_reset_password_token()</code> is a static method, which means that it can be invoked directly from the class. A static method is similar to a class method, with the only difference that static methods do not receive the class as a first argument. This method takes a token and attempts to decode it by invoking PyJWT's <code>jwt.decode()</code> function. If the token cannot be validated or is expired, an exception will be raised, and in that case I catch it to prevent the error, and then return <code>None</code> to the caller. If the token is valid, then the value of the <code>reset_password</code> key from the token's payload is the ID of the user, so I can load the user and return it.</p>
<h2>Sending a Password Reset Email</h2>
<p>The <code>send_password_reset_email()</code> function relies on the <code>send_email()</code> function I wrote above to generate the password reset emails. </p>
<p class="code_title"><i>app/email.py</i>: Send password reset email function.</p>

<pre><code class="language-python">from flask import render_template
from app import app

# ...

def send_password_reset_email(user):
    token = user.get_reset_password_token()
    send_email('[Microblog] Reset Your Password',
               sender=app.config['ADMINS'][0],
               recipients=[user.email],
               text_body=render_template('email/reset_password.txt',
                                         user=user, token=token),
               html_body=render_template('email/reset_password.html',
                                         user=user, token=token))
</code></pre>
<p>The interesting part in this function is that the text and HTML content for the emails is generated from templates using the familiar <code>render_template()</code> function. The templates receive the user and the token as arguments, so that a personalized email message can be generated. Here is the text template for the reset password email:</p>
<p class="code_title"><i>app/templates/email/reset_password.txt</i>: Text for password reset email.</p>

<pre><code>Dear {{ user.username }},

To reset your password click on the following link:

{{ url_for('reset_password', token=token, _external=True) }}

If you have not requested a password reset simply ignore this message.

Sincerely,

The Microblog Team
</code></pre>
<p>And here is the nicer HTML version of the same email:</p>
<p class="code_title"><i>app/templates/email/reset_password.html</i>: HTML for password reset email.</p>

<pre><code class="language-html">&lt;p&gt;Dear {{ user.username }},&lt;/p&gt;
&lt;p&gt;
    To reset your password
    &lt;a href=&quot;{{ url_for('reset_password', token=token, _external=True) }}&quot;&gt;
        click here
    &lt;/a&gt;.
&lt;/p&gt;
&lt;p&gt;Alternatively, you can paste the following link in your browser's address bar:&lt;/p&gt;
&lt;p&gt;{{ url_for('reset_password', token=token, _external=True) }}&lt;/p&gt;
&lt;p&gt;If you have not requested a password reset simply ignore this message.&lt;/p&gt;
&lt;p&gt;Sincerely,&lt;/p&gt;
&lt;p&gt;The Microblog Team&lt;/p&gt;
</code></pre>
<p>The <code>reset_password</code> route that is referenced in the <code>url_for()</code> call in these two email templates does not exist yet, this will be added in the next section. The <code>_external=True</code> argument that I included in the <code>url_for()</code> calls in both templates is also new. The URLs that are generated by <code>url_for()</code> by default are relative URLs that only include the path portion of the URL. This is normally sufficient for links that are generated in web pages, because the web browser completes the URL by taking the missing parts from the URL in the address bar. When sending a URL by email however, that context does not exist, so fully qualified URLs need to be used. When <code>_external=True</code> is passed as an argument, complete URLs are generated, so the previous example would return <em>http://localhost:5000/user/susan</em>, or the appropriate URL when the application is deployed on a domain name.</p>
<h2>Resetting a User Password</h2>
<p>When the user clicks on the email link, a second route associated with this feature is triggered. Here is the password request view function:</p>
<p class="code_title"><i>app/routes.py</i>: Password reset view function.</p>

<pre><code class="language-python">from app.forms import ResetPasswordForm

@app.route('/reset_password/&lt;token&gt;', methods=['GET', 'POST'])
def reset_password(token):
    if current_user.is_authenticated:
        return redirect(url_for('index'))
    user = User.verify_reset_password_token(token)
    if not user:
        return redirect(url_for('index'))
    form = ResetPasswordForm()
    if form.validate_on_submit():
        user.set_password(form.password.data)
        db.session.commit()
        flash('Your password has been reset.')
        return redirect(url_for('login'))
    return render_template('reset_password.html', form=form)
</code></pre>
<p>In this view function I first make sure the user is not logged in, and then I determine who the user is by invoking the token verification method in the <code>User</code> class. This method returns the user if the token is valid, or <code>None</code> if not. If the token is invalid I redirect to the home page.</p>
<p>If the token is valid, then I present the user with a second form, in which the new password is requested. This form is processed in a way similar to previous forms, and as a result of a valid form submission, I invoke the <code>set_password()</code> method of <code>User</code> to change the password, and then redirect to the login page, where the user can now login.</p>
<p>Here is the <code>ResetPasswordForm</code> class:</p>
<p class="code_title"><i>app/forms.py</i>: Password reset form.</p>

<pre><code class="language-python">class ResetPasswordForm(FlaskForm):
    password = PasswordField('Password', validators=[DataRequired()])
    password2 = PasswordField(
        'Repeat Password', validators=[DataRequired(), EqualTo('password')])
    submit = SubmitField('Request Password Reset')
</code></pre>
<p>And here is the corresponding HTML template:</p>
<p class="code_title"><i>app/templates/reset_password.html</i>: Password reset form template.</p>

<pre><code class="language-html">{% extends &quot;base.html&quot; %}

{% block content %}
    &lt;h1&gt;Reset Your Password&lt;/h1&gt;
    &lt;form action=&quot;&quot; method=&quot;post&quot;&gt;
        {{ form.hidden_tag() }}
        &lt;p&gt;
            {{ form.password.label }}&lt;br&gt;
            {{ form.password(size=32) }}&lt;br&gt;
            {% for error in form.password.errors %}
            &lt;span style=&quot;color: red;&quot;&gt;[{{ error }}]&lt;/span&gt;
            {% endfor %}
        &lt;/p&gt;
        &lt;p&gt;
            {{ form.password2.label }}&lt;br&gt;
            {{ form.password2(size=32) }}&lt;br&gt;
            {% for error in form.password2.errors %}
            &lt;span style=&quot;color: red;&quot;&gt;[{{ error }}]&lt;/span&gt;
            {% endfor %}
        &lt;/p&gt;
        &lt;p&gt;{{ form.submit() }}&lt;/p&gt;
    &lt;/form&gt;
{% endblock %}
</code></pre>
<p>The password reset feature is now complete, so make sure you try it.</p>
<h2>Asynchronous Emails</h2>
<p>If you are using the simulated email server that Python provides you may not have noticed this, but sending an email slows the application down considerably. All the interactions that need to happen when sending an email make the task slow, it usually takes a few seconds to get an email out, and maybe more if the email server of the addressee is slow, or if there are multiple addressees.</p>
<p>What I really want is for the <code>send_email()</code> function to be <em>asynchronous</em>. What does that mean? It means that when this function is called, the task of sending the email is scheduled to happen in the background, freeing the <code>send_email()</code> to return immediately so that the application can continue running concurrently with the email being sent.</p>
<p>Python has support for running asynchronous tasks, actually in more than one way. The <code>threading</code> and <code>multiprocessing</code> modules can both do this. Starting a background thread for email being sent is much less resource intensive than starting a brand new process, so I'm going to go with that approach:</p>
<p class="code_title"><i>app/email.py</i>: Send emails asynchronously.</p>

<pre><code class="language-python">from threading import Thread
# ...

def send_async_email(app, msg):
    with app.app_context():
        mail.send(msg)


def send_email(subject, sender, recipients, text_body, html_body):
    msg = Message(subject, sender=sender, recipients=recipients)
    msg.body = text_body
    msg.html = html_body
    Thread(target=send_async_email, args=(app, msg)).start()
</code></pre>
<p>The <code>send_async_email</code> function now runs in a background thread, invoked via the <code>Thread</code> class in the last line of <code>send_email()</code>. With this change, the sending of the email will run in the thread, and when the process completes the thread will end and clean itself up. If you have configured a real email server, you will definitely notice a speed improvement when you press the submit button on the password reset request form.</p>
<p>You probably expected that only the <code>msg</code> argument would be sent to the thread, but as you can see in the code, I'm also sending the application instance. When working with threads there is an important design aspect of Flask that needs to be kept in mind. Flask uses <em>contexts</em> to avoid having to pass arguments across functions. I'm not going to go into a lot of detail on this, but know that there are two types of contexts, the <em>application context</em> and the <em>request context</em>. In most cases, these contexts are automatically managed by the framework, but when the application starts custom threads, contexts for those threads may need to be manually created.</p>
<p>There are many extensions that require an application context to be in place to work, because that allows them to find the Flask application instance without it being passed as an argument. The reason many extensions need to know the application instance is because they have their configuration stored in the <code>app.config</code> object. This is exactly the situation with Flask-Mail. The <code>mail.send()</code> method needs to access the configuration values for the email server, and that can only be done by knowing what the application is. The application context that is created with the <code>with app.app_context()</code> call makes the application instance accessible via the <code>current_app</code> variable from Flask.</p></div>

<div class="card patreon-bar">
  <div class="card-body">
    <h5>Become a Patron!</h5>
    <p class="card-text">Hello, and thank you for visiting my blog! If you enjoyed this article, please consider supporting my work on this blog on <a href="https://patreon.com/miguelgrinberg">Patreon</a>!</p>
    <a href="https://patreon.com/miguelgrinberg" alt="Become a Patron!" title="Become a Patron!"><img src="../../../static/patreon-button.png"></a>
  </div>
</div>


<div class="card social-bar">
  <div class="card-body">
    <h5>Share this post:</h5>
      <!-- Sharingbutton Hacker News -->
      <a class="resp-sharing-button__link" href="https://news.ycombinator.com/submitlink?u=https%3A//blog.miguelgrinberg.com/post/the-flask-mega-tutorial-part-x-email-support-2018&amp;t=The%20Flask%20Mega-Tutorial%20Part%20X%3A%20Email%20Support%20%282018%29" target="_blank" rel="noopener" aria-label="Hacker News">
        <div class="resp-sharing-button resp-sharing-button--hackernews resp-sharing-button--medium"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 140 140"><path fill-rule="evenodd" d="M60.94 82.314L17 0h20.08l25.85 52.093c.397.927.86 1.888 1.39 2.883.53.994.995 2.02 1.393 3.08.265.4.463.764.596 1.095.13.334.262.63.395.898.662 1.325 1.26 2.618 1.79 3.877.53 1.26.993 2.42 1.39 3.48 1.06-2.254 2.22-4.673 3.48-7.258 1.26-2.585 2.552-5.27 3.877-8.052L103.49 0h18.69L77.84 83.308v53.087h-16.9v-54.08z"></path></svg></div>Hacker News</div>
      </a>

      <!-- Sharingbutton Reddit -->
      <a class="resp-sharing-button__link" href="https://reddit.com/submit/?url=https%3A//blog.miguelgrinberg.com/post/the-flask-mega-tutorial-part-x-email-support-2018&amp;resubmit=true&amp;title=The%20Flask%20Mega-Tutorial%20Part%20X:%20Email%20Support%20(2018)" target="_blank" rel="noopener" aria-label="Reddit">
        <div class="resp-sharing-button resp-sharing-button--reddit resp-sharing-button--medium"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M24 11.5c0-1.65-1.35-3-3-3-.96 0-1.86.48-2.42 1.24-1.64-1-3.75-1.64-6.07-1.72.08-1.1.4-3.05 1.52-3.7.72-.4 1.73-.24 3 .5C17.2 6.3 18.46 7.5 20 7.5c1.65 0 3-1.35 3-3s-1.35-3-3-3c-1.38 0-2.54.94-2.88 2.22-1.43-.72-2.64-.8-3.6-.25-1.64.94-1.95 3.47-2 4.55-2.33.08-4.45.7-6.1 1.72C4.86 8.98 3.96 8.5 3 8.5c-1.65 0-3 1.35-3 3 0 1.32.84 2.44 2.05 2.84-.03.22-.05.44-.05.66 0 3.86 4.5 7 10 7s10-3.14 10-7c0-.22-.02-.44-.05-.66 1.2-.4 2.05-1.54 2.05-2.84zM2.3 13.37C1.5 13.07 1 12.35 1 11.5c0-1.1.9-2 2-2 .64 0 1.22.32 1.6.82-1.1.85-1.92 1.9-2.3 3.05zm3.7.13c0-1.1.9-2 2-2s2 .9 2 2-.9 2-2 2-2-.9-2-2zm9.8 4.8c-1.08.63-2.42.96-3.8.96-1.4 0-2.74-.34-3.8-.95-.24-.13-.32-.44-.2-.68.15-.24.46-.32.7-.18 1.83 1.06 4.76 1.06 6.6 0 .23-.13.53-.05.67.2.14.23.06.54-.18.67zm.2-2.8c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm5.7-2.13c-.38-1.16-1.2-2.2-2.3-3.05.38-.5.97-.82 1.6-.82 1.1 0 2 .9 2 2 0 .84-.53 1.57-1.3 1.87z"/></svg></div>Reddit</div>
      </a>

      <!-- Sharingbutton Twitter -->
      <a class="resp-sharing-button__link" href="https://twitter.com/intent/tweet/?text=The%20Flask%20Mega-Tutorial%20Part%20X%3A%20Email%20Support%20%282018%29&amp;url=https%3A//blog.miguelgrinberg.com/post/the-flask-mega-tutorial-part-x-email-support-2018" target="_blank" rel="noopener" aria-label="Twitter">
        <div class="resp-sharing-button resp-sharing-button--twitter resp-sharing-button--medium"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M23.44 4.83c-.8.37-1.5.38-2.22.02.93-.56.98-.96 1.32-2.02-.88.52-1.86.9-2.9 1.1-.82-.88-2-1.43-3.3-1.43-2.5 0-4.55 2.04-4.55 4.54 0 .36.03.7.1 1.04-3.77-.2-7.12-2-9.36-4.75-.4.67-.6 1.45-.6 2.3 0 1.56.8 2.95 2 3.77-.74-.03-1.44-.23-2.05-.57v.06c0 2.2 1.56 4.03 3.64 4.44-.67.2-1.37.2-2.06.08.58 1.8 2.26 3.12 4.25 3.16C5.78 18.1 3.37 18.74 1 18.46c2 1.3 4.4 2.04 6.97 2.04 8.35 0 12.92-6.92 12.92-12.93 0-.2 0-.4-.02-.6.9-.63 1.96-1.22 2.56-2.14z"/></svg></div>Twitter</div>
      </a>

      <!-- Sharingbutton LinkedIn -->
      <a class="resp-sharing-button__link" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3A//blog.miguelgrinberg.com/post/the-flask-mega-tutorial-part-x-email-support-2018&amp;title=The%20Flask%20Mega-Tutorial%20Part%20X%3A%20Email%20Support%20%282018%29&amp;summary=The%20Flask%20Mega-Tutorial%20Part%20X%3A%20Email%20Support%20%282018%29&amp;source=https%3A//blog.miguelgrinberg.com/post/the-flask-mega-tutorial-part-x-email-support-2018" target="_blank" rel="noopener" aria-label="LinkedIn">
        <div class="resp-sharing-button resp-sharing-button--linkedin resp-sharing-button--medium"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M6.5 21.5h-5v-13h5v13zM4 6.5C2.5 6.5 1.5 5.3 1.5 4s1-2.4 2.5-2.4c1.6 0 2.5 1 2.6 2.5 0 1.4-1 2.5-2.6 2.5zm11.5 6c-1 0-2 1-2 2v7h-5v-13h5V10s1.6-1.5 4-1.5c3 0 5 2.2 5 6.3v6.7h-5v-7c0-1-1-2-2-2z"/></svg></div>LinkedIn</div>
      </a>

      <!-- Sharingbutton Facebook -->
      <a class="resp-sharing-button__link" href="https://facebook.com/sharer/sharer.php?u=https%3A//blog.miguelgrinberg.com/post/the-flask-mega-tutorial-part-x-email-support-2018" target="_blank" rel="noopener" aria-label="Facebook">
        <div class="resp-sharing-button resp-sharing-button--facebook resp-sharing-button--medium"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18.77 7.46H14.5v-1.9c0-.9.6-1.1 1-1.1h3V.5h-4.33C10.24.5 9.5 3.44 9.5 5.32v2.15h-3v4h3v12h5v-12h3.85l.42-4z"/></svg></div>Facebook</div>
      </a>

      <!-- Sharingbutton E-Mail -->
      <a class="resp-sharing-button__link" href="mailto:?subject=The%20Flask%20Mega-Tutorial%20Part%20X%3A%20Email%20Support%20%282018%29&amp;body=https%3A//blog.miguelgrinberg.com/post/the-flask-mega-tutorial-part-x-email-support-2018" target="_self" rel="noopener" aria-label="E-Mail">
        <div class="resp-sharing-button resp-sharing-button--email resp-sharing-button--medium"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M22 4H2C.9 4 0 4.9 0 6v12c0 1.1.9 2 2 2h20c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zM7.25 14.43l-3.5 2c-.08.05-.17.07-.25.07-.17 0-.34-.1-.43-.25-.14-.24-.06-.55.18-.68l3.5-2c.24-.14.55-.06.68.18.14.24.06.55-.18.68zm4.75.07c-.1 0-.2-.03-.27-.08l-8.5-5.5c-.23-.15-.3-.46-.15-.7.15-.22.46-.3.7-.14L12 13.4l8.23-5.32c.23-.15.54-.08.7.15.14.23.07.54-.16.7l-8.5 5.5c-.08.04-.17.07-.27.07zm8.93 1.75c-.1.16-.26.25-.43.25-.08 0-.17-.02-.25-.07l-3.5-2c-.24-.13-.32-.44-.18-.68s.44-.32.68-.18l3.5 2c.24.13.32.44.18.68z"/></svg></div>E-Mail</div>
      </a>

  </div>
</div>

<div id="comments" class="post-comment-count">
  
  <a class="btn btn-outline-secondary" href="../../the-flask-mega-tutorial-part-x-email-support-2018.html#comments">319 comments</a>
  
</div>


<div class="comments">
  <ul>
    
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/721cae7360e3e5dc51fd7e8f95045d27?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#76</span> <span class="badge text-bg-warning">Krishan Kumar</span> said
    
    <span class="flask-moment" data-timestamp="2018-09-23T08:30:09Z" data-function="fromNow" data-refresh="0" style="display: none">2018-09-23T08:30:09Z</span>
  </p>
  <div>
    <p>Dear Sir</p>
<p>I have been facing problems in sending mail through flask application. I faced the same problem in Chapter 7 also. I have allowed the 'less secure app' feature in my gmail account. <br>
I have set the environment variables:<br>
set MAIL_SERVER=<a href="http://smtp.googlemail.com/" rel="nofollow">smtp.googlemail.com</a><br>
set MAIL_PORT=587<br>
set MAIL_USE_TLS=1<br>
set MAIL_USERNAME=ice.effort<br>
set MAIL_PASSWORD=<strong><em>*</em></strong>*</p>
<p>I have also used this one: set MAIL_USERNAME=ice.effort@gmail.com</p>
<p>My code is same as your code.</p>
<p>Every time, I get this error:</p>
<p>File "&lt;console&gt;", line 1, in &lt;module&gt;<br>
  File "c:\users\krishan_kumar2\desktop\flask mega\megap\2\microblog\venv\lib\site-packages\<a href="http://flask_mail.py/" rel="nofollow">flask_mail.py</a>", line 491, in send<br>
    with self.connect() as connection:<br>
  File "c:\users\krishan_kumar2\desktop\flask mega\megap\2\microblog\venv\lib\site-packages\<a href="http://flask_mail.py/" rel="nofollow">flask_mail.py</a>", line 144, in <strong>enter</strong><br>
    self.host = self.configure_host()<br>
  File "c:\users\krishan_kumar2\desktop\flask mega\megap\2\microblog\venv\lib\site-packages\<a href="http://flask_mail.py/" rel="nofollow">flask_mail.py</a>", line 158, in configure_host<br>
    host = smtplib.SMTP(self.mail.server, self.mail.port)<br>
  File "C:\Users\krishan_kumar2\AppData\Local\Programs\Python\Python37-32\lib\<a href="http://smtplib.py/" rel="nofollow">smtplib.py</a>", line 251, in <strong>init</strong><br>
    (code, msg) = self.connect(host, port)<br>
  File "C:\Users\krishan_kumar2\AppData\Local\Programs\Python\Python37-32\lib\<a href="http://smtplib.py/" rel="nofollow">smtplib.py</a>", line 336, in connect<br>
    self.sock = self._get_socket(host, port, self.timeout)<br>
  File "C:\Users\krishan_kumar2\AppData\Local\Programs\Python\Python37-32\lib\<a href="http://smtplib.py/" rel="nofollow">smtplib.py</a>", line 307, in _get_socket<br>
    self.source_address)<br>
  File "C:\Users\krishan_kumar2\AppData\Local\Programs\Python\Python37-32\lib\<a href="http://socket.py/" rel="nofollow">socket.py</a>", line 727, in create_connection<br>
    raise err<br>
  File "C:\Users\krishan_kumar2\AppData\Local\Programs\Python\Python37-32\lib\<a href="http://socket.py/" rel="nofollow">socket.py</a>", line 716, in create_connection<br>
    sock.connect(sa)<br>
OSError: [WinError 10013] An attempt was made to access a socket in a way forbidden by its access permissions</p>
<p>Please help me with the solution.</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/729e26a2a2c7ff24a71958d4aa4e5f35?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#77</span> <span class="badge text-bg-danger">Miguel Grinberg</span> said
    
    <span class="flask-moment" data-timestamp="2018-09-25T18:02:39Z" data-function="fromNow" data-refresh="0" style="display: none">2018-09-25T18:02:39Z</span>
  </p>
  <div>
    <p>@Krishan: Do you have an antivirus installed? Try disabling it.</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/d62c0c09a716326da30a26fdebc366a6?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#78</span> <span class="badge text-bg-warning">john salzmann</span> said
    
    <span class="flask-moment" data-timestamp="2018-09-27T05:19:21Z" data-function="fromNow" data-refresh="0" style="display: none">2018-09-27T05:19:21Z</span>
  </p>
  <div>
    <p>Mr. Grinberg, </p>
<p>In my eighteen month self-guided journey to learn programming in it's abstract, I have come across multitudes of error-ridden, incomplete, shallow and extraneous tutorials related to web applications. I have seen dead-ends, deprecated syntax, disheveled expressions, and dismal stack traces. Too often have I felt the need to distrust the exposition because careful comparison and execution would not emit the expected result. </p>
<p>...Quite frankly, this is in relation to the JavaScript front-end community, which in fairness - is an endless wealth of knowledge and communication, but is drowned by relentless revisions and tumultuous reverberations, cast as layers of sand in a morphing geography.</p>
<p>I'm not sure if you maintain this frequently, or have chosen the most carefully and substantive pathway possible, yet I feel as though this is the first guide that has me appropriately question myself when errors arise. I feel confidence, when long I had felt doubt, that mistakes are lain by my hands, and that cared attention will carry me to the expectations of your prose.</p>
<p>Seriously though, thank you for this piece of art. I've enjoyed every entry so far, and I'm blown away by what can be done with Python on the back-end.</p>
<p>-john</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/5ec4ea533f6841508734b5433178c8ef?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#79</span> <span class="badge text-bg-warning">Oleg Kovalenko</span> said
    
    <span class="flask-moment" data-timestamp="2018-10-02T08:15:42Z" data-function="fromNow" data-refresh="0" style="display: none">2018-10-02T08:15:42Z</span>
  </p>
  <div>
    <p>Sorry, I had accidentally first posted this comment on your legacy version of this post. Here is that message again.</p>
<p>I've set up my Microblog's web host as a send only mail server to send authenticated (spf / dkim / dmarc) emails through Postfix + Mailx. Do you have any advice for replicating that configuration in Flask-Mail? I haven't found any useful documentation on the use of Flask-Mail on a mail server, let alone for integrating it with an MTA (in the source, it appears to use Python's smtplib directly, so is it essentially its own MTA?). I am starting to think that it is wiser to call mailx through Python and send mail that way. What do you think is best? I suppose the idea you had in mind with this section is that there would be a web host and a web server on different machines, and the web host would relay to the mail server using Flask-Mail.</p>
<p>Thanks for taking the time to read and reply to us all (:</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/be92c0dda264ace8cf374f320cd81f6d?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#80</span> <span class="badge text-bg-warning">James</span> said
    
    <span class="flask-moment" data-timestamp="2018-10-02T18:37:48Z" data-function="fromNow" data-refresh="0" style="display: none">2018-10-02T18:37:48Z</span>
  </p>
  <div>
    <p>Miguel, thanks so much for this outstanding tutorial. As many other comments have noted, you've done a tremendous job introducing readers to the impressive capabilities of Flask. I often skip tutorials, but I'm doing this one line by line because everything you've included adds to my understanding. </p>
<p>I notice that you specify the MAIL_SERVER as '<a href="http://smtp.googlemail.com/" rel="nofollow">smtp.googlemail.com</a>'. I use a hosted Google Apps email address, not a <a href="http://gmail.com/" rel="nofollow">Gmail.com</a> address, so I set my mail server to '<a href="http://smtp.gmail.com/" rel="nofollow">smtp.gmail.com</a>' instead. Just leaving a note here in case anyone else runs into this issue—'<a href="http://smtp.googlemail.com/" rel="nofollow">smtp.googlemail.com</a>' won't work for a Google Apps email account. </p>
<p>Thanks!</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/729e26a2a2c7ff24a71958d4aa4e5f35?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#81</span> <span class="badge text-bg-danger">Miguel Grinberg</span> said
    
    <span class="flask-moment" data-timestamp="2018-10-02T22:06:31Z" data-function="fromNow" data-refresh="0" style="display: none">2018-10-02T22:06:31Z</span>
  </p>
  <div>
    <p>@Oleg: Your mail server is a regular SMTP server. The configuration in Flask-Mail depends on how you configured this email server. The MAIL_SERVER variable is going to be localhost if you have the email server in the same machine as the application. The SERVER_PORT depends on your set up, could be 25, 465 or 587. You have to use the one that you configured. The SSL and credentials also needs to be configured to match your server.</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/5ec4ea533f6841508734b5433178c8ef?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#82</span> <span class="badge text-bg-warning">Oleg Kovalenko</span> said
    
    <span class="flask-moment" data-timestamp="2018-10-05T01:49:54Z" data-function="fromNow" data-refresh="0" style="display: none">2018-10-05T01:49:54Z</span>
  </p>
  <div>
    <p>@Miguel: I have set up Flask-Mail to send mail from the web host by setting the server and port. I assumed that if Postfix is running on the port I tell Flask-Mail to use, then Flask-Mail will send mail using my Postfix configuration. This is not the case, and it looks like I'd have to configure Flask-Mail itself to get my outgoing mail authenticated. There is no documentation on using Flask-Mail like that, and no packages with that use case. It looks like the only robust solution is to send mail using the environment instead of Flask-Mail if the web host is running the mail server. How did you do it?</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/729e26a2a2c7ff24a71958d4aa4e5f35?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#83</span> <span class="badge text-bg-danger">Miguel Grinberg</span> said
    
    <span class="flask-moment" data-timestamp="2018-10-06T09:31:43Z" data-function="fromNow" data-refresh="0" style="display: none">2018-10-06T09:31:43Z</span>
  </p>
  <div>
    <p>@Oleg: Not sure what you mean with regards to missing documentation. As I said above, Postfix is an SMTP server. Once you know how to connect to the server, all you need to do is set the Flask-Mail configuration variables appropriately. It looks like your Postfix server requires authentication, so you have to set those credentials, there is no way around that. If you want something simpler, install your own Postfix server and configure it to accept email without authentication. This is not a secure solution, but if you want to do it for testing it should be fine.</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/5ec4ea533f6841508734b5433178c8ef?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#84</span> <span class="badge text-bg-warning">Oleg Kovalenko</span> said
    
    <span class="flask-moment" data-timestamp="2018-10-06T23:10:21Z" data-function="fromNow" data-refresh="0" style="display: none">2018-10-06T23:10:21Z</span>
  </p>
  <div>
    <p>@Miguel: Thanks for clearing up that Flask-Mail does use an external SMTP server instead of implementing an SMTP server on the app level. I was sorely confused about that.</p>
<p>I have Postfix running on port 25 and Flask-Mail sends mail through that successfully; however, the reason I thought Postfix is being bypassed, is because none of my Postfix configuration seems to be in effect when I send mail using Flask-Mail. This is extremely confusing. Specifically, none of Postfix's address rewriting is triggered, and opendkim doesn't sign the outgoing mail. As a result, the outgoing mail fails all authentication.</p>
<p>Because of this, what I'm doing right now is executing a shell command to send mail. This seems safe because the user doesn't supply any of the input to the command. The fields are filled directly from the database, which is responsible for making sure the fields are secure before committing them.</p>
<p>This seems better than implementing address rewriting and dkim signing on the application level. However, if I could get Flask-Mail to send mail without ignoring my Postfix configuration and opendkim, then that would be a preferable solution.</p>
<p>I haven't found any documentation on getting Flask-Mail to play nice with address rewriting and authentication. If you know of any resources on that topic, I would really appreciate a link.</p>
<p>Thank you for engaging with me in this discussion.</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/729e26a2a2c7ff24a71958d4aa4e5f35?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#85</span> <span class="badge text-bg-danger">Miguel Grinberg</span> said
    
    <span class="flask-moment" data-timestamp="2018-10-06T23:15:57Z" data-function="fromNow" data-refresh="0" style="display: none">2018-10-06T23:15:57Z</span>
  </p>
  <div>
    <p>@Oleg: Flask-Mail has nothing to do with address rewriting or any other features of your MTA. I'm not sure I can help you with this, my opinion is that your problem is a faulty Postfix configuration.</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/5ec4ea533f6841508734b5433178c8ef?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#86</span> <span class="badge text-bg-warning">Oleg Kovalenko</span> said
    
    <span class="flask-moment" data-timestamp="2018-10-07T03:29:55Z" data-function="fromNow" data-refresh="0" style="display: none">2018-10-07T03:29:55Z</span>
  </p>
  <div>
    <p>@Miguel: Well, Postfix works perfectly when I send mail using the mailx command. Certainly something is wrong with how I was trying to use Flask-Mail. If my Postfix configuration were faulty, then surely I would have the same problems with mailx that I have with Flask-Mail.</p>
<p>Thank you for talking me through my issue because I ended up learning about the distinction between MSAs and MTAs and other key concepts. I will continue to use an os.system call to mailx to send my emails successfully.</p>
<p>In general I have never heard of, or managed to find any examples of, anybody using Flask-Mail as the MSA on a mail server. If anyone else goes through the DigitalOcean links in this tutorial and sets up Postfix with opendkim only to find that nothing they send through Flask-Mail is authenticated, then try:</p>
<p>def send_async_email(subject, recipients, body, html):<br>
    os.system("echo '{}' | mailx -s '{}' {}".format(body, subject, ",".join(recipients)))</p>
<p>as a replacement for Flask-Mail.</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/729e26a2a2c7ff24a71958d4aa4e5f35?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#87</span> <span class="badge text-bg-danger">Miguel Grinberg</span> said
    
    <span class="flask-moment" data-timestamp="2018-10-07T07:41:43Z" data-function="fromNow" data-refresh="0" style="display: none">2018-10-07T07:41:43Z</span>
  </p>
  <div>
    <p>@Oleg: I have used Postfix with Flask-Mail for years, so 100% sure it works. This blog uses it.</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/8ea2e07aef1fd8050c4d9f6f06f4c577?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#88</span> <span class="badge text-bg-warning">Danny G</span> said
    
    <span class="flask-moment" data-timestamp="2018-10-15T02:23:44Z" data-function="fromNow" data-refresh="0" style="display: none">2018-10-15T02:23:44Z</span>
  </p>
  <div>
    <p>Hi Miguel, thanks so much for this tutorial!</p>
<p>I don't know if I missed something, but when trying to send an email using python's debugging server and some previous configurations, the mail.send(msg) call would fail because under the hood, smtplib is expecting credentials for the server (which doesn't use any) and it's expecting credentials because in <a href="http://config.py/" rel="nofollow">config.py</a>, we set them to the environment variables (if set) or a made up string if not as follows: </p>
<p>MAIL_USERNAME = os.environ.get('MAIL_USERNAME') or 'danny'<br>
 MAIL_PASSWORD = os.environ.get('MAIL_PASSWORD') or 'password'</p>
<p>For me, the solution was changing the strings to None so that smtplib would no longer require authentication with the server. (I don't have the environment variable set)</p>
<p>Again, I'm not sure if I messed something up while following your tutorial, but just in case this was an omission, I thought you would like to know.</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/729e26a2a2c7ff24a71958d4aa4e5f35?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#89</span> <span class="badge text-bg-danger">Miguel Grinberg</span> said
    
    <span class="flask-moment" data-timestamp="2018-10-15T21:12:00Z" data-function="fromNow" data-refresh="0" style="display: none">2018-10-15T21:12:00Z</span>
  </p>
  <div>
    <p>@Danny: the problem is that with the "or" values that you added in the username and password settings it is impossible to have those set to None. What did you add those defaults? For credentials it is best to not have defaults. If the environment variables aren't defined you want those configuration variables to be set to None.</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/5be9e3020983d0f403ad43f2f0ca5c30?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#90</span> <span class="badge text-bg-warning">AR</span> said
    
    <span class="flask-moment" data-timestamp="2018-10-23T03:45:45Z" data-function="fromNow" data-refresh="0" style="display: none">2018-10-23T03:45:45Z</span>
  </p>
  <div>
    <p>Hi Miguel, </p>
<p>If i send email using address -- noreply@domain.com, then in the user's gmail inbox the email is shown as coming from 'noreply' [in the gamil inbox, first column displays 'noreply' , second column displays the subject of email]. What I would rather want is to display the brand name 'Domain' instead of noreply. How can i do this?</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/729e26a2a2c7ff24a71958d4aa4e5f35?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#91</span> <span class="badge text-bg-danger">Miguel Grinberg</span> said
    
    <span class="flask-moment" data-timestamp="2018-10-23T17:56:34Z" data-function="fromNow" data-refresh="0" style="display: none">2018-10-23T17:56:34Z</span>
  </p>
  <div>
    <p>@AR: not much you can do from your side to control how an email application displays incoming emails. The "from" field in an email needs to be an email address, so the best you can do is use something other than "noreply" as the email username.</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/721b6cdad8db1cbdbe1005ae3aaae233?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#92</span> <span class="badge text-bg-warning">zhoujj</span> said
    
    <span class="flask-moment" data-timestamp="2018-10-24T08:13:53Z" data-function="fromNow" data-refresh="0" style="display: none">2018-10-24T08:13:53Z</span>
  </p>
  <div>
    <p>Hi Miguel. Thanks for the wonderful flask tutorial.<br>
I test email functionality as you described in my MACS.<br>
I run STMP server as "python -m smtpd -n -c DebuggingServer localhost:8025 ".<br>
I came to up an error "SMTPException: STARTTLS extension not supported by server."</p>
<p>Do you have any idea for this error?</p>
<p>Thanks a lot.</p>
<p>Best regards,<br>
zhoujj</p>
<p>More message:<br>
Exception in thread Thread-3:<br>
Traceback (most recent call last):<br>
  File "/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/<a href="http://threading.py/" rel="nofollow">threading.py</a>", line 810, in <strong>bootstrap_inner<br>
    self.run()<br>
  File "/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/<a href="http://threading.py/" rel="nofollow">threading.py</a>", line 763, in run<br>
    self.__target(<em>self.__args, </em>*self.__kwargs)<br>
  File "/Users/zhoujj/project/microblog/app/<a href="http://email.py/" rel="nofollow">email.py</a>", line 10, in send_async_email<br>
    mail.send(msg)<br>
  File "/Users/zhoujj/project/microblog/venv/lib/python2.7/site-packages/<a href="http://flask_mail.py/" rel="nofollow">flask_mail.py</a>", line 491, in send<br>
    with self.connect() as connection:<br>
  File "/Users/zhoujj/project/microblog/venv/lib/python2.7/site-packages/<a href="http://flask_mail.py/" rel="nofollow">flask_mail.py</a>", line 144, in __enter</strong><br>
    self.host = self.configure_host()<br>
  File "/Users/zhoujj/project/microblog/venv/lib/python2.7/site-packages/<a href="http://flask_mail.py/" rel="nofollow">flask_mail.py</a>", line 163, in configure_host<br>
    host.starttls()<br>
  File "/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/<a href="http://smtplib.py/" rel="nofollow">smtplib.py</a>", line 644, in starttls<br>
    raise SMTPException("STARTTLS extension not supported by server.")<br>
SMTPException: STARTTLS extension not supported by server.</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/729e26a2a2c7ff24a71958d4aa4e5f35?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#93</span> <span class="badge text-bg-danger">Miguel Grinberg</span> said
    
    <span class="flask-moment" data-timestamp="2018-10-24T11:38:43Z" data-function="fromNow" data-refresh="0" style="display: none">2018-10-24T11:38:43Z</span>
  </p>
  <div>
    <p>@zhoujj: the debugging SMTP server does not support TLS. You probably have the MAIL_USE_TLS environment variable set. Try deleting this variable from your environment.</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/5be9e3020983d0f403ad43f2f0ca5c30?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#94</span> <span class="badge text-bg-warning">Ankur Tiwari</span> said
    
    <span class="flask-moment" data-timestamp="2018-10-24T12:37:33Z" data-function="fromNow" data-refresh="0" style="display: none">2018-10-24T12:37:33Z</span>
  </p>
  <div>
    <p>Hi,</p>
<p>I got it working, gmail inbox now shows my brand name instead of 'noreply',<br>
Used the tuple -- sender=("Me", "me@example.com"))</p>
<p>Do you think, it comes with any security vulnerability?</p>
<p>Another issue i have is to be able to select sender email address i.e. currently I have configured MAIL SERVER, USER Name Etc for noreply@domain.com, but there will be some emails that I want to send from other emails, say.. contact@domain.com or support@domain.com... For this I will have to configure MAIL server for these to. Since I already have MAIL_USERNAME = noreply@domain.com, how can i configure it for other emails?</p>
<p>Will making MAIL_USERNAME a list be a solution?</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/729e26a2a2c7ff24a71958d4aa4e5f35?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#95</span> <span class="badge text-bg-danger">Miguel Grinberg</span> said
    
    <span class="flask-moment" data-timestamp="2018-10-24T22:22:15Z" data-function="fromNow" data-refresh="0" style="display: none">2018-10-24T22:22:15Z</span>
  </p>
  <div>
    <p>@Ankur: the sender email address has nothing to do with the authenticated user. The same authenticated user can send emails that all have different "from" email addresses.</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/7cacfab56d124816801594170f380c47?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#96</span> <span class="badge text-bg-warning">David</span> said
    
    <span class="flask-moment" data-timestamp="2018-10-31T19:54:26Z" data-function="fromNow" data-refresh="0" style="display: none">2018-10-31T19:54:26Z</span>
  </p>
  <div>
    <p>Hi Miguel, </p>
<p>Thanks for this is a great tutorial!<br>
I have followed it however I am having trouble sending password reset emails. My issue is pretty similar to the one posted by #AnthonyBrown and I wonder you ever found out what the problem is.</p>
<p>I keep getting this error.</p>
<p>127.0.0.1 - - [31/Oct/2018 15:45:46] "GET /auth/login HTTP/1.1" 200 -<br>
Exception in thread Thread-3:<br>
Traceback (most recent call last):<br>
  File "/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/<a href="http://threading.py/" rel="nofollow">threading.py</a>", line 810, in <strong>bootstrap_inner<br>
    self.run()<br>
  File "/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/<a href="http://threading.py/" rel="nofollow">threading.py</a>", line 763, in run<br>
    self.__target(<em>self.__args, </em>*self.__kwargs)<br>
  File "/Users/davidjonathan/Desktop/med-water/app/<a href="http://email.py/" rel="nofollow">email.py</a>", line 9, in send_async_email<br>
    mail.send(msg)<br>
  File "/Library/Python/2.7/site-packages/<a href="http://flask_mail.py/" rel="nofollow">flask_mail.py</a>", line 492, in send<br>
    message.send(connection)<br>
  File "/Library/Python/2.7/site-packages/<a href="http://flask_mail.py/" rel="nofollow">flask_mail.py</a>", line 152, in __exit</strong><br>
    self.host.quit()<br>
  File "/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/<a href="http://smtplib.py/" rel="nofollow">smtplib.py</a>", line 767, in quit<br>
    res = self.docmd("quit")<br>
  File "/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/<a href="http://smtplib.py/" rel="nofollow">smtplib.py</a>", line 393, in docmd<br>
    self.putcmd(cmd, args)<br>
  File "/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/<a href="http://smtplib.py/" rel="nofollow">smtplib.py</a>", line 341, in putcmd<br>
    self.send(str)<br>
  File "/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/<a href="http://smtplib.py/" rel="nofollow">smtplib.py</a>", line 333, in send<br>
    raise SMTPServerDisconnected('please run connect() first')<br>
SMTPServerDisconnected: please run connect() first</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/729e26a2a2c7ff24a71958d4aa4e5f35?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#97</span> <span class="badge text-bg-danger">Miguel Grinberg</span> said
    
    <span class="flask-moment" data-timestamp="2018-11-03T10:25:20Z" data-function="fromNow" data-refresh="0" style="display: none">2018-11-03T10:25:20Z</span>
  </p>
  <div>
    <p>@David: I would be inclined to think this is a problem with the SMTP server that you are using. Does this problem occur if you use the debugging SMTP server, or gmail?</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/ed1226ad741d954044eed43355456f33?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#98</span> <span class="badge text-bg-warning">Dawson</span> said
    
    <span class="flask-moment" data-timestamp="2018-11-05T17:21:51Z" data-function="fromNow" data-refresh="0" style="display: none">2018-11-05T17:21:51Z</span>
  </p>
  <div>
    <p>At least for me, these <code>SMTPServerDisconnected: please run connect() first</code> errors seem to be caused by not setting the MAIL_SERVER and MAIL_PORT environment variables in the terminal/venv that the sending of the mails are being done from.</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/5be9e3020983d0f403ad43f2f0ca5c30?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#99</span> <span class="badge text-bg-warning">AR</span> said
    
    <span class="flask-moment" data-timestamp="2018-11-14T03:08:31Z" data-function="fromNow" data-refresh="0" style="display: none">2018-11-14T03:08:31Z</span>
  </p>
  <div>
    <p>Hi Miguel,</p>
<p>This might be related to comment #49</p>
<p>In reset_password_request.html, how can i link a custom css or even bootstrap.css which is otherwise already linked in  base.html for rest of the pages?</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/729e26a2a2c7ff24a71958d4aa4e5f35?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#100</span> <span class="badge text-bg-danger">Miguel Grinberg</span> said
    
    <span class="flask-moment" data-timestamp="2018-11-15T12:06:38Z" data-function="fromNow" data-refresh="0" style="display: none">2018-11-15T12:06:38Z</span>
  </p>
  <div>
    <p>@AR: you can add any custom CSS in the "head" block. See the Flask-Bootstrap documentation for details.</p>
  </div>
</div>
    </li>
    
  </ul>
</div>

<nav aria-label="Page navigation">
  <ul class="pagination justify-content-center">
    <li class="page-item"><a class="page-link" href="1.html#comments">&laquo;&laquo;</a></li>
    <li class="page-item"><a class="page-link" href="3.html#comments">&laquo;</a></li>
    <li class="page-item"><a class="page-link" href="5.html#comments">&raquo;</a></li>
    <li class="page-item"><a class="page-link" href="0.html#comments">&raquo;&raquo;</a></li>
  </ul>
</nav>



<div id="comment-form">
  <h3>Leave a Comment</h3>

  
  
  

  
<form action="#comment-form" method="post">
  <input id="url" name="url" type="hidden" value="">
<input id="csrf_token" name="csrf_token" type="hidden" value="IjQyYjY5YzZlNTcyYjFkMTVlZGRkOWJjYjA3ZmFlYWFiNTg3YmU5ODki.Zxdm2g.DVwdTx9aqZ6NtgmhSVWaEcOBADE">
    
  <div class="mb-3">
    <label class="form-label" for="name">Name</label>
    <div class="input-group has-validation">
      <input class="form-control" id="name" name="name" required type="text" value="">
    </div>
  </div>

    
    
  <div class="mb-3">
    <label class="form-label" for="email">Email</label>
    <div class="input-group has-validation">
      <input class="form-control" id="email" name="email" required type="text" value="">
    </div>
  </div>

    
  <div class="mb-3">
    <label class="form-label" for="comment">Comment</label>
    <div class="input-group has-validation">
      <textarea class="form-control" id="comment" name="comment" required>
</textarea>
    </div>
  </div>

    
  <div class="mb-3">
    <label class="form-label" for="captcha">Captcha</label>
    <div class="input-group has-validation">
      
<script src='https://www.google.com/recaptcha/api.js' async defer></script>
<div class="g-recaptcha" data-sitekey="6Ld5Zs4SAAAAAOY0DOi4r18bgHlEaz41qAoRf__S"></div>

    </div>
  </div>

    
  <input class="btn btn-primary mb-3" id="submit" name="submit" type="submit" value="Submit">

      
</form>

</div>


</div>

      </div>
    </div>
    
    <div class="col-md-4">
      <div id="sidebar">
        
          
  



<div class="card">
  
  
  <div class="card-header">Flask Web Development, 2nd Edition</div>
  <a class="card-book-cover" href="https://amzn.to/3lE2mok">
    <img src="../../../static/flask2e-book-cover-small.png" alt="Flask Web Development, 2nd Edition">
  </a>
  <div class="card-body">
    <p class="card-text">If you want to learn modern web development techniques with Python and Flask, you may find the second edition of my <a href="https://amzn.to/3lE2mok">O'Reilly book</a> useful.</p>
  </div>
  <div class="card-body">
    <a class="card-link" href="https://amzn.to/3lE2mok">Click here to get this Book!</a><br />
  </div>

  
</div>
        
        <div class="card">
  <div class="card-header">About Miguel</div>
  <div class="card-body">
    <img style="float: right; margin: 0px 8px 8px 0px; padding: 4px; border: 1px solid #ccc;" src="../../../static/miguel.jpg" />
    <p class="card-text">Welcome to my blog!</p>
    <p class="card-text">I'm a software engineer and technical writer, currently living in Drogheda, Ireland.</p>
    <p class="card-text">You can also find me on <a href="https://twitter.com/miguelgrinberg">Twitter</a>, <a href="https://mstdn.social/@miguelgrinberg">Mastodon</a>, <a href="https://github.com/miguelgrinberg">Github</a>, <a href="http://www.linkedin.com/in/miguelgrinberg">LinkedIn</a>, <a href="https://youtube.com/miguelgrinberg">YouTube</a>, <a href="https://www.facebook.com/miguelgrinbergblog">Facebook</a> and <a href="https://patreon.com/miguelgrinberg">Patreon</a>.</p>
    <p class="card-text">Thank you for visiting!</p>
  </div>
</div>
        
        <div class="card" id="categories">
  <div class="card-header">Categories</div>
  <div class="card-body">
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/AI/feed"><img src="../../../static/rss-small.png" title="AI RSS Feed" label="AI RSS Feed" alt="AI RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/AI" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="AI" /> <small><em>2</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/AWS/feed"><img src="../../../static/rss-small.png" title="AWS RSS Feed" label="AWS RSS Feed" alt="AWS RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/AWS" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="AWS" /> <small><em>1</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Arduino/feed"><img src="../../../static/rss-small.png" title="Arduino RSS Feed" label="Arduino RSS Feed" alt="Arduino RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Arduino" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Arduino" /> <small><em>7</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Authentication/feed"><img src="../../../static/rss-small.png" title="Authentication RSS Feed" label="Authentication RSS Feed" alt="Authentication RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Authentication" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Authentication" /> <small><em>10</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Blog/feed"><img src="../../../static/rss-small.png" title="Blog RSS Feed" label="Blog RSS Feed" alt="Blog RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Blog" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Blog" /> <small><em>1</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/C++/feed"><img src="../../../static/rss-small.png" title="C++ RSS Feed" label="C++ RSS Feed" alt="C++ RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/C++" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="C++" /> <small><em>5</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/CSS/feed"><img src="../../../static/rss-small.png" title="CSS RSS Feed" label="CSS RSS Feed" alt="CSS RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/CSS" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="CSS" /> <small><em>1</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Cloud/feed"><img src="../../../static/rss-small.png" title="Cloud RSS Feed" label="Cloud RSS Feed" alt="Cloud RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Cloud" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Cloud" /> <small><em>10</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Database/feed"><img src="../../../static/rss-small.png" title="Database RSS Feed" label="Database RSS Feed" alt="Database RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Database" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Database" /> <small><em>22</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Docker/feed"><img src="../../../static/rss-small.png" title="Docker RSS Feed" label="Docker RSS Feed" alt="Docker RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Docker" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Docker" /> <small><em>5</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Filmmaking/feed"><img src="../../../static/rss-small.png" title="Filmmaking RSS Feed" label="Filmmaking RSS Feed" alt="Filmmaking RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Filmmaking" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Filmmaking" /> <small><em>6</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Flask/feed"><img src="../../../static/rss-small.png" title="Flask RSS Feed" label="Flask RSS Feed" alt="Flask RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Flask" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Flask" /> <small><em>126</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Games/feed"><img src="../../../static/rss-small.png" title="Games RSS Feed" label="Games RSS Feed" alt="Games RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Games" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Games" /> <small><em>1</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Heroku/feed"><img src="../../../static/rss-small.png" title="Heroku RSS Feed" label="Heroku RSS Feed" alt="Heroku RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Heroku" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Heroku" /> <small><em>1</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/IoT/feed"><img src="../../../static/rss-small.png" title="IoT RSS Feed" label="IoT RSS Feed" alt="IoT RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/IoT" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="IoT" /> <small><em>8</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/JavaScript/feed"><img src="../../../static/rss-small.png" title="JavaScript RSS Feed" label="JavaScript RSS Feed" alt="JavaScript RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/JavaScript" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="JavaScript" /> <small><em>35</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/MicroPython/feed"><img src="../../../static/rss-small.png" title="MicroPython RSS Feed" label="MicroPython RSS Feed" alt="MicroPython RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/MicroPython" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="MicroPython" /> <small><em>9</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Microdot/feed"><img src="../../../static/rss-small.png" title="Microdot RSS Feed" label="Microdot RSS Feed" alt="Microdot RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Microdot" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Microdot" /> <small><em>1</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Microservices/feed"><img src="../../../static/rss-small.png" title="Microservices RSS Feed" label="Microservices RSS Feed" alt="Microservices RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Microservices" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Microservices" /> <small><em>2</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Movie Reviews/feed"><img src="../../../static/rss-small.png" title="Movie Reviews RSS Feed" label="Movie Reviews RSS Feed" alt="Movie Reviews RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Movie Reviews" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Movie Reviews" /> <small><em>5</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/OpenStack/feed"><img src="../../../static/rss-small.png" title="OpenStack RSS Feed" label="OpenStack RSS Feed" alt="OpenStack RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/OpenStack" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="OpenStack" /> <small><em>1</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Personal/feed"><img src="../../../static/rss-small.png" title="Personal RSS Feed" label="Personal RSS Feed" alt="Personal RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Personal" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Personal" /> <small><em>3</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Photography/feed"><img src="../../../static/rss-small.png" title="Photography RSS Feed" label="Photography RSS Feed" alt="Photography RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Photography" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Photography" /> <small><em>7</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Product Reviews/feed"><img src="../../../static/rss-small.png" title="Product Reviews RSS Feed" label="Product Reviews RSS Feed" alt="Product Reviews RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Product Reviews" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Product Reviews" /> <small><em>2</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Programming/feed"><img src="../../../static/rss-small.png" title="Programming RSS Feed" label="Programming RSS Feed" alt="Programming RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Programming" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Programming" /> <small><em>187</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Project Management/feed"><img src="../../../static/rss-small.png" title="Project Management RSS Feed" label="Project Management RSS Feed" alt="Project Management RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Project Management" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Project Management" /> <small><em>1</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Python/feed"><img src="../../../static/rss-small.png" title="Python RSS Feed" label="Python RSS Feed" alt="Python RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Python" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Python" /> <small><em>169</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/REST/feed"><img src="../../../static/rss-small.png" title="REST RSS Feed" label="REST RSS Feed" alt="REST RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/REST" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="REST" /> <small><em>7</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Rackspace/feed"><img src="../../../static/rss-small.png" title="Rackspace RSS Feed" label="Rackspace RSS Feed" alt="Rackspace RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Rackspace" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Rackspace" /> <small><em>1</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Raspberry Pi/feed"><img src="../../../static/rss-small.png" title="Raspberry Pi RSS Feed" label="Raspberry Pi RSS Feed" alt="Raspberry Pi RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Raspberry Pi" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Raspberry Pi" /> <small><em>8</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/React/feed"><img src="../../../static/rss-small.png" title="React RSS Feed" label="React RSS Feed" alt="React RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/React" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="React" /> <small><em>18</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Robotics/feed"><img src="../../../static/rss-small.png" title="Robotics RSS Feed" label="Robotics RSS Feed" alt="Robotics RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Robotics" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Robotics" /> <small><em>6</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Security/feed"><img src="../../../static/rss-small.png" title="Security RSS Feed" label="Security RSS Feed" alt="Security RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Security" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Security" /> <small><em>12</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Video/feed"><img src="../../../static/rss-small.png" title="Video RSS Feed" label="Video RSS Feed" alt="Video RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Video" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Video" /> <small><em>22</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/WebSocket/feed"><img src="../../../static/rss-small.png" title="WebSocket RSS Feed" label="WebSocket RSS Feed" alt="WebSocket RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/WebSocket" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="WebSocket" /> <small><em>2</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Webcast/feed"><img src="../../../static/rss-small.png" title="Webcast RSS Feed" label="Webcast RSS Feed" alt="Webcast RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Webcast" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Webcast" /> <small><em>3</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Windows/feed"><img src="../../../static/rss-small.png" title="Windows RSS Feed" label="Windows RSS Feed" alt="Windows RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Windows" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Windows" /> <small><em>1</em></small>
      </form>
    </div>
    
  </div>
</div>
        
      </div>
    </div>
    
  </div>
  <div id="footer">
    
    <p>&copy; 2012-<script type="text/javascript">document.write(new Date().getFullYear());</script> by Miguel Grinberg. All rights reserved. <a href="mailto:webmaster _at_ miguelgrinberg _dot_ com">Questions?</a></p>
  </div>
</div>

  
    <script src="../../../../cdn.jsdelivr.net/npm/bootstrap%405.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
  <script type="text/javascript" src="../../../static/prettify.js"></script>
  <script src="../../../../cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.4/moment-with-locales.min.js" integrity="sha512-42PE0rd+wZ2hNXftlM78BSehIGzezNeQuzihiBCvUEB3CVxHvsShF86wBWwQORNxNINlBPuq7rG4WWhNiTVHFg==" crossorigin="anonymous"></script>

<script>
moment.locale("en");
function flask_moment_render(elem) {{
    const timestamp = moment(elem.dataset.timestamp);
    const func = elem.dataset.function;
    const format = elem.dataset.format;
    const timestamp2 = elem.dataset.timestamp2;
    const no_suffix = elem.dataset.nosuffix;
    const units = elem.dataset.units;
    let args = [];
    if (format)
        args.push(format);
    if (timestamp2)
        args.push(moment(timestamp2));
    if (no_suffix)
        args.push(no_suffix);
    if (units)
        args.push(units);
    elem.textContent = timestamp[func].apply(timestamp, args);
    elem.classList.remove('flask-moment');
    elem.style.display = "";
}}
function flask_moment_render_all() {{
    const moments = document.querySelectorAll('.flask-moment');
    moments.forEach(function(moment) {{
        flask_moment_render(moment);
        const refresh = moment.dataset.refresh;
        if (refresh && refresh > 0) {{
            (function(elem, interval) {{
                setInterval(function() {{
                    flask_moment_render(elem);
                }}, interval);
            }})(moment, refresh);
        }}
    }})
}}
document.addEventListener("DOMContentLoaded", flask_moment_render_all);
</script>

  
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-20EHZP9GRZ"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-20EHZP9GRZ');
  </script>
  
  <script type="text/javascript">
    function setThemeUI() {
      document.getElementById('select-theme-auto').classList.remove('active');
      document.getElementById('select-theme-light').classList.remove('active');
      document.getElementById('select-theme-dark').classList.remove('active');
      const theme = getPreferredTheme();
      const actualTheme = document.documentElement.getAttribute('data-bs-theme', 'light');
      document.getElementById('select-theme-' + theme).classList.add('active');
      document.getElementById('current-theme').href.baseVal = `#icon-theme-${actualTheme}`;
    };

    function updateTheme(theme) {
      if (theme === 'auto') {
        localStorage.removeItem('theme')
      }
      else {
        localStorage.setItem('theme', theme)
      }
      setTheme(getPreferredTheme());
    }

    setThemeUI();

    const darkModePreference = window.matchMedia("(prefers-color-scheme: dark)");
    darkModePreference.addEventListener("change", e => {
      if (getPreferredTheme() === 'auto') {
        setTheme('auto');
      }
    });

    document.addEventListener("DOMContentLoaded", () => {
      // add prettyprint class to all <pre><code></code></pre> blocks
      let prettify = false;
      document.querySelectorAll('div.post-body pre code').forEach((code) => {
        code.parentNode.classList.add('prettyprint');
        prettify = true;
      });
      prettyPrint();
    });
  </script>

  </body>

<!-- Mirrored from blog.miguelgrinberg.com/post/the-flask-mega-tutorial-part-x-email-support-2018/page/4 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 22 Oct 2024 08:50:15 GMT -->
</html>