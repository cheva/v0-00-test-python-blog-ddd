<!doctype html>
<html lang="en">
  
<!-- Mirrored from blog.miguelgrinberg.com/post/the-flask-mega-tutorial-part-xviii-deployment-on-heroku-2018/page/9 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 22 Oct 2024 08:48:35 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    
  <script type="text/javascript">
    function getPreferredTheme() {
      const storedTheme = localStorage.getItem('theme')
      if (storedTheme) {
        return storedTheme
      }
      return 'auto';
    }

    function setTheme(theme) {
      if (theme === 'auto') {
        theme = window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light'
      }
      document.documentElement.setAttribute('data-bs-theme', theme);
    };

    setTheme(getPreferredTheme());
  </script>
  
    <title>
  
    The Flask Mega-Tutorial Part XVIII: Deployment on Heroku (2018) - miguelgrinberg.com
  
</title>
  
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="description" content="miguelgrinberg.com">
  <meta name="copyright" content="Copyright (c) 2012-2024 Miguel Grinberg">
  <meta name="author" content="Miguel Grinberg">
  
  <meta name="keywords" content="heroku, python, flask, programming">
  
  
  <link rel="canonical" href="../../the-flask-mega-tutorial-part-xviii-deployment-on-heroku-2018.html">
  

  
    <link href="../../../../cdn.jsdelivr.net/npm/bootstrap%405.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
  <link rel="preconnect" href="https://fonts.googleapis.com/">
  <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400&amp;display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@700&amp;display=swap" rel="stylesheet">

  <link href="../../../static/tomorrow.min.css" type="text/css" rel="stylesheet" />
  <link href="../../../static/tomorrow-night.min.css" type="text/css" rel="stylesheet" />
  <link href="../../../static/social.css" rel="stylesheet" type="text/css" />
  <link href="../../../static/style_20231230.css" rel="stylesheet" type="text/css" />

  <link rel="shortcut icon" href="https://blog.miguelgrinberg.com/static/favicon.ico">
  <link rel="alternate" type="application/rss+xml" href="https://blog.miguelgrinberg.com/feed" title="miguelgrinberg.com RSS feed">

    <meta property="og:title" content="The Flask Mega-Tutorial Part XVIII: Deployment on Heroku (2018)">
    <meta property="og:description" content="(Great news! There is a new version of this tutorial!)This is the eighteenth installment of the Flask Mega-Tutorial series, in which I&#39;m going to deploy Microblog to the Heroku cloud platform.For…">
    <meta property="og:image" content="https://blog.miguelgrinberg.com/static/cards/the-flask-mega-tutorial-part-xviii-deployment-on-heroku-2018.jpg">
    <meta property="og:url" content="https://blog.miguelgrinberg.com/post/the-flask-mega-tutorial-part-xviii-deployment-on-heroku-2018">
    <meta name="twitter:title" content="The Flask Mega-Tutorial Part XVIII: Deployment on Heroku (2018)">
    <meta name="twitter:description" content="(Great news! There is a new version of this tutorial!)This is the eighteenth installment of the Flask Mega-Tutorial series, in which I&#39;m going to deploy Microblog to the Heroku cloud platform.For…">
    <meta name="twitter:image" content="https://blog.miguelgrinberg.com/static/cards/the-flask-mega-tutorial-part-xviii-deployment-on-heroku-2018.jpg">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@miguelgrinberg">

  </head>
  <body>
    <svg style="display: none" version="2.0">
      <defs>
        <symbol id="icon-theme-auto" xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="bi bi-circle-half" viewBox="0 0 16 16">
          <path d="M8 15A7 7 0 1 0 8 1zm0 1A8 8 0 1 1 8 0a8 8 0 0 1 0 16"/>
        </symbol>
        <symbol id="icon-theme-light" xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="bi bi-brightness-high-fill" viewBox="0 0 16 16">
          <path d="M8 11a3 3 0 1 1 0-6 3 3 0 0 1 0 6m0 1a4 4 0 1 0 0-8 4 4 0 0 0 0 8M8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0m0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13m8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5M3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8m10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0m-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707M4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"/>
        </symbol>
        <symbol id="icon-theme-dark" xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="bi bi-moon-stars-fill" viewBox="0 0 16 16">
          <path d="M6 .278a.768.768 0 0 1 .08.858 7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278"/>
          <path d="M10.794 3.148a.217.217 0 0 1 .412 0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217 0 0 1 0 .412l-1.162.387a1.734 1.734 0 0 0-1.097 1.097l-.387 1.162a.217.217 0 0 1-.412 0l-.387-1.162A1.734 1.734 0 0 0 9.31 6.593l-1.162-.387a.217.217 0 0 1 0-.412l1.162-.387a1.734 1.734 0 0 0 1.097-1.097l.387-1.162zM13.863.099a.145.145 0 0 1 .274 0l.258.774c.115.346.386.617.732.732l.774.258a.145.145 0 0 1 0 .274l-.774.258a1.156 1.156 0 0 0-.732.732l-.258.774a.145.145 0 0 1-.274 0l-.258-.774a1.156 1.156 0 0 0-.732-.732l-.774-.258a.145.145 0 0 1 0-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z"/>
        </symbol>
      </defs>
    </svg>
<nav class="navbar navbar-expand-lg">
  <div class="container">
    <a class="navbar-brand" href="https://blog.miguelgrinberg.com/index">miguelgrinberg.com</a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarCollapse">
      <ul class="navbar-nav me-auto">
        <li class="nav-item"><a class="nav-link" aria-current="page" href="https://blog.miguelgrinberg.com/index">Home</a></li>
        <li class="nav-item"><a class="nav-link" aria-current="page" href="../../my-courses-and-books.html">My Courses and Books</a></li>
        <li class="nav-item"><a class="nav-link" aria-current="page" href="../../hire-me.html">Consulting</a></li>
        <li class="nav-item"><a class="nav-link" aria-current="page" href="../../about-me.html">About Me</a></li>
        
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
            <svg width="20" height="20" version="2.0"><use id="current-theme" href="#icon-theme-light"></svg>
          </a>
          <ul class="dropdown-menu">
            <li>
              <a id="select-theme-light" class="dropdown-item" href="javascript:updateTheme('light')">
                <svg width="16" height="16" version="2.0"><use href="#icon-theme-light"></svg>&nbsp; Light Mode
              </a>
            </li>
            <li>
              <a id="select-theme-dark" class="dropdown-item" href="javascript:updateTheme('dark')">
                <svg width="16" height="16" version="2.0"><use href="#icon-theme-dark"></svg>&nbsp; Dark Mode
              </a>
            </li>
            <li><hr class="dropdown-divider"></li>
            <li>
              <a id="select-theme-auto" class="dropdown-item" href="javascript:updateTheme('auto')">
                <svg width="16" height="16" version="2.0"><use href="#icon-theme-auto"></svg>&nbsp; System Default
              </a>
            </li>
          </ul>
        </li>
        
      </ul>
      <ul class="navbar-nav">
        <li class="nav-item social-icons">
          <a type="application/rss+xml" href="https://blog.miguelgrinberg.com/feed"><img src="../../../static/social/rss.png" alt="RSS Feed" title="RSS Feed" /></a>
          <a href="https://twitter.com/miguelgrinberg"><img src="../../../static/social/twitter.png" alt="Twitter" title="Twitter" /></a>
          <a rel="me" href="https://mstdn.social/@miguelgrinberg"><img src="../../../static/social/mastodon.png" alt="Mastodon" title="Mastodon" /></a>
          <a href="http://github.com/miguelgrinberg"><img src="../../../static/social/github.png" alt="GitHub" title="GitHub" /></a>
          <a href="https://youtube.com/miguelgrinberg"><img src="../../../static/social/youtube.png" alt="YouTube" title="YouTube" /></a>
          <a href="http://www.linkedin.com/in/miguelgrinberg"><img src="../../../static/social/linkedin.png" alt="LinkedIn" title="LinkedIn" /></a>
          <a href="https://patreon.com/miguelgrinberg"><img src="../../../static/social/patreon.png" alt="Patreon" title="Patreon" /></a>
          <!--<a href="https://www.facebook.com/miguelgrinbergblog"><img src="/static/social/facebook.png" alt="Facebook" title="Facebook" /></a>-->
        </li>
      </ul>
    </div>
  </div>
</nav>

<div class="container">
  <div class="row">
    <div class="col-md-8">
      <div id="main">
        
        
        
        
        

<div class="post">

<div class="post-header">
  <h1><a href="../../the-flask-mega-tutorial-part-xviii-deployment-on-heroku-2018.html">The Flask Mega-Tutorial Part XVIII: Deployment on Heroku (2018)</a></h1>
  <h2>
    Posted by
    <form action="https://blog.miguelgrinberg.com/author/Miguel Grinberg" method="POST">
      <input type="submit" class="btn btn-danger btn-sm" value="Miguel Grinberg" />
    </form>
    on
    <button class="btn btn-secondary btn-sm" disabled><span class="flask-moment" data-timestamp="2018-04-03T19:15:17Z" data-function="format" data-format="LL" data-refresh="0" style="display: none">2018-04-03T19:15:17Z</span></button>
    under
    
      <form action="https://blog.miguelgrinberg.com/category/Python" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Python" />
      </form>
    
      <form action="https://blog.miguelgrinberg.com/category/Flask" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Flask" />
      </form>
    
      <form action="https://blog.miguelgrinberg.com/category/Programming" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Programming" />
      </form>
    
      <form action="https://blog.miguelgrinberg.com/category/Cloud" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Cloud" />
      </form>
    
    
  </h2>
</div>
<div class="post-body"><p><em>(Great news! There is a <a href="../../the-flask-mega-tutorial-part-i-hello-world.html">new version of this tutorial</a>!)</em></p>
<p>This is the eighteenth installment of the Flask Mega-Tutorial series, in which I'm going to deploy Microblog to the Heroku cloud platform.</p>
<p>For your reference, below is a list of the articles in this series.</p>
<ul>
<li><a href="../../the-flask-mega-tutorial-part-i-hello-world-2018.html">Chapter 1: Hello, World!</a></li>
<li><a href="../../the-flask-mega-tutorial-part-ii-templates-2018.html">Chapter 2: Templates</a></li>
<li><a href="../../the-flask-mega-tutorial-part-iii-web-forms-2018.html">Chapter 3: Web Forms</a></li>
<li><a href="../../the-flask-mega-tutorial-part-iv-database-2018.html">Chapter 4: Database</a></li>
<li><a href="../../the-flask-mega-tutorial-part-v-user-logins-2018.html">Chapter 5: User Logins</a></li>
<li><a href="../../the-flask-mega-tutorial-part-vi-profile-page-and-avatars-2018.html">Chapter 6: Profile Page and Avatars</a></li>
<li><a href="../../the-flask-mega-tutorial-part-vii-error-handling-2018.html">Chapter 7: Error Handling</a></li>
<li><a href="../../the-flask-mega-tutorial-part-viii-followers-2018.html">Chapter 8: Followers</a></li>
<li><a href="../../the-flask-mega-tutorial-part-ix-pagination-2018.html">Chapter 9: Pagination</a></li>
<li><a href="../../the-flask-mega-tutorial-part-x-email-support-2018.html">Chapter 10: Email Support</a></li>
<li><a href="../../the-flask-mega-tutorial-part-xi-facelift-2018.html">Chapter 11: Facelift</a></li>
<li><a href="../../the-flask-mega-tutorial-part-xii-dates-and-times-2018.html">Chapter 12: Dates and Times</a></li>
<li><a href="../../the-flask-mega-tutorial-part-xiii-i18n-and-l10n-2018.html">Chapter 13: I18n and L10n</a></li>
<li><a href="../../the-flask-mega-tutorial-part-xiv-ajax-2018.html">Chapter 14: Ajax</a></li>
<li><a href="../../the-flask-mega-tutorial-part-xv-a-better-application-structure-2018.html">Chapter 15: A Better Application Structure</a></li>
<li><a href="../../the-flask-mega-tutorial-part-xvi-full-text-search-2018.html">Chapter 16: Full-Text Search</a></li>
<li><a href="../../the-flask-mega-tutorial-part-xvii-deployment-on-linux-2018.html">Chapter 17: Deployment on Linux</a></li>
<li><a href="../../the-flask-mega-tutorial-part-xviii-deployment-on-heroku-2018.html">Chapter 18: Deployment on Heroku</a> (this article)</li>
<li><a href="../../the-flask-mega-tutorial-part-xix-deployment-on-docker-containers-2018.html">Chapter 19: Deployment on Docker Containers</a></li>
<li><a href="../../the-flask-mega-tutorial-part-xx-some-javascript-magic-2018.html">Chapter 20: Some JavaScript Magic</a></li>
<li><a href="../../the-flask-mega-tutorial-part-xxi-user-notifications-2018.html">Chapter 21: User Notifications</a></li>
<li><a href="../../the-flask-mega-tutorial-part-xxii-background-jobs-2018.html">Chapter 22: Background Jobs</a></li>
<li><a href="../../the-flask-mega-tutorial-part-xxiii-application-programming-interfaces-apis-2018.html">Chapter 23: Application Programming Interfaces (APIs)</a></li>
</ul>
<p>In the previous article I showed you the "traditional" way to host a Python application, and I gave you two actual examples of deployment to Linux based servers. If you are not used to manage a Linux system, you probably thought that the amount of effort that needs to be put into the task was big, and that surely there must be an easier way.</p>
<p>In this chapter I'm going to show you a completely different approach, in which you rely on a third-party <em>cloud</em> hosting provider to perform most of the administration tasks, freeing you to spend more time working on your application.</p>
<p>Many cloud hosting providers offer a managed platform on which applications can run. All you need to provide to have your application deployed on these platforms is the actual application, because the hardware, operating system, scripting language interpreters, database, etc. are all managed by the service. This type of service is called <a href="https://en.wikipedia.org/wiki/Platform_as_a_service">Platform as a Service</a>, or PaaS.</p>
<p>Sounds too good to be true, right?</p>
<p>I will look at deploying Microblog to <a href="http://heroku.com/">Heroku</a>, a popular cloud hosting service that is very friendly for Python applications. I picked Heroku not only because it is popular, but also because it has a free service tier that will allow you to follow me and do a complete deployment without spending any money.</p>
<p><em>The GitHub links for this chapter are: <a href="https://github.com/miguelgrinberg/microblog/tree/v0.18">Browse</a>, <a href="https://github.com/miguelgrinberg/microblog-2018/archive/v0.18.zip">Zip</a>, <a href="https://github.com/miguelgrinberg/microblog/compare/v0.17...v0.18">Diff</a>.</em></p>
<h2>Hosting on Heroku</h2>
<p>Heroku was one of the first platform as a service providers. It started as a hosting option for Ruby based applications, but then grew to support many other languages like Java, Node.js and of course Python.</p>
<p>Deploying a web application to Heroku is done through the <code>git</code> version control tool, so you must have your application in a git repository. Heroku looks for a file called <em>Procfile</em> in the application's root directory for instructions on how to start the application. For Python projects, Heroku also expects a <em>requirements.txt</em> file that lists all the module dependencies that need to be installed. After the application is uploaded to Heroku's servers through a git push operation, you are essentially done and just need to wait a few seconds until the application is online. It's really that simple.</p>
<p>The different service tiers Heroku offers allow you to choose how much computing power and time you get for your application, so as your user base grows you may outgrow the free allowance and will need to buy more units of computing, which Heroku calls "dynos".</p>
<p>Ready to try Heroku? Let's get started!</p>
<h2>Creating a Heroku account</h2>
<p>Before you can deploy to Heroku you need to have an account with them. So visit <a href="https://id.heroku.com/signup">heroku.com</a> and create a free account. Once you have an account and log in to Heroku, you will have access to a dashboard, where all your applications are listed.</p>
<h2>Installing the Heroku CLI</h2>
<p>Heroku provides a command-line tool for interacting with their service called <a href="https://devcenter.heroku.com/articles/heroku-cli">Heroku CLI</a>, available for Windows, Mac OS X and Linux. The documentation includes installation instructions for all the supported platforms. Go ahead and install it on your system if you plan on deploying the application to test the service.</p>
<p>The first thing you should do once the CLI is installed is login to your Heroku account:</p>
<pre><code>$ heroku login
</code></pre>
<p>Heroku CLI will ask you to enter your email address and your account password. Your authenticated status will be remembered in subsequent commands.</p>
<h2>Setting Up Git</h2>
<p>The <code>git</code> tool is core to the deployment of applications to Heroku, so you must install it on your system if you don't have it yet. If you don't have a package available for your operating system, you can visit the <a href="https://git-scm.com/">git website</a> to download an installer.</p>
<p>There are a lot of reasons why using <code>git</code> for your projects makes sense. If you plan to deploy to Heroku, you have one more, because to deploy to Heroku, your application must be in a <code>git</code> repository. If you are going to do a test deployment for Microblog, you can clone my version of this application from GitHub: </p>
<pre><code>$ git clone https://github.com/miguelgrinberg/microblog
$ cd microblog
$ git checkout v0.18
</code></pre>
<p>The <code>git checkout</code> command selects the specific commit that has the application at the point in its history that corresponds to this chapter.</p>
<p>If you prefer to work with your own code instead of mine, you can transform your own project into a <code>git</code> repository by running <code>git init .</code> on the top-level directory (note the period after <code>init</code>, which tells git that you want to create the repository in the current directory). Once the git repository is created, use the <code>git add</code> command to add all your source files, and <code>git commit</code> to commit them to the repository.</p>
<h2>Creating a Heroku Application</h2>
<p>To register a new application with Heroku, you use the <code>apps:create</code> command from the root directory of the application, passing the application name as the only argument:</p>
<pre><code>$ heroku apps:create flask-microblog
Creating flask-microblog... done
http://flask-microblog.herokuapp.com/ | https://git.heroku.com/flask-microblog.git
</code></pre>
<p>Heroku requires that applications have a unique name. The name <code>flask-microblog</code> that I used above is not going to be available to you because I'm using it, so you will need to pick a different name for your deployment.</p>
<p>The output of this command will include the URL that Heroku assigned to the application, and also its git repository on Heroku's servers. Your local git repository will be configured with an extra <em>remote</em>, called <code>heroku</code> set to this repository. You can verify that it exists with the <code>git remote</code> command:</p>
<pre><code>$ git remote -v
heroku  https://git.heroku.com/flask-microblog.git (fetch)
heroku  https://git.heroku.com/flask-microblog.git (push)
</code></pre>
<p>Depending on how you created your git repository, the output of the above command could also include another remote called <code>origin</code> which is not used by Heroku.</p>
<h2>The Ephemeral File System</h2>
<p>The Heroku platform is different to other deployment platforms in that it features an <em>ephemeral</em> file system that runs on a virtualized platform. What does that mean? It means that at any time, Heroku can reset the virtual server on which your server runs back to a clean state. You cannot assume that any data that you save to the file system will persist, and in fact, Heroku recycles servers very often.</p>
<p>Working under these conditions introduces some problems for my application, which uses a few files:</p>
<ul>
<li>The default SQLite database engine writes data in a disk file</li>
<li>Logs for the application are also written to the file system</li>
<li>The compiled language translation repositories are also written to local files</li>
</ul>
<p>The following sections will address these three areas.</p>
<h2>Working with a Heroku Postgres Database</h2>
<p>To address the first problem, I'm going to switch to a different database engine. In <a href="../../the-flask-mega-tutorial-part-xvii-deployment-on-linux-2018.html">Chapter 17</a> you saw me use a MySQL database to add robustness to the Ubuntu deployment. Heroku has a database offering of its own, based on the Postgres database, so I'm going to switch to that to avoid the file-based SQLite.</p>
<p>Databases for Heroku applications are provisioned with the same Heroku CLI. In this case I'm going to create a database on the free tier:</p>
<pre><code>$ heroku addons:add heroku-postgresql:hobby-dev
Creating heroku-postgresql:hobby-dev on flask-microblog... free
Database has been created and is available
 ! This database is empty. If upgrading, you can transfer
 ! data from another database with pg:copy
Created postgresql-parallel-56076 as DATABASE_URL
Use heroku addons:docs heroku-postgresql to view documentation
</code></pre>
<p>The URL for the newly created database is stored in a <code>DATABASE_URL</code> environment variable that will be available when the application runs on Heroku's platform. This is very convenient, because the application already looks for the database URL in that variable.</p>
<p>To make sure that the <code>DATABASE_URL</code> variable is configured in your Heroku application, you can use the following command:</p>
<pre><code>$ heroku config
DATABASE_URL:  postgres://...
</code></pre>
<p>An unfortunate problem with recent versions of SQLAlchemy is that they expect Postgres database URLs to begin with <code>postgresql://</code>, instead of the <code>postgres://</code> that Heroku uses. To ensure that the application can connect to the database, it is necessary to update the URL to the format required by SQLAlchemy. This can be done with a string replacement operation in the <code>Config</code> class:</p>
<p class="code_title"><i>config.py</i>: Fix Postgres database URLs to be compatible with SQLAlchemy.</p>

<pre><code class="language-python">class Config(object):
    # ...
    SQLALCHEMY_DATABASE_URI = os.environ.get('DATABASE_URL', '').replace(
        'postgres://', 'postgresql://') or \
        'sqlite:///' + os.path.join(basedir, 'app.db')
    # ...
</code></pre>
<p>This string replacement operation is safe to use even when the <code>DATABASE_URL</code> variable is set to a different database, in which case it will not affect it.</p>
<h2>Logging to stdout</h2>
<p>Heroku expects applications to log directly to <code>stdout</code>. Anything the application prints to the standard output is saved and returned when you use the <code>heroku logs</code> command. So I'm going to add a configuration variable that indicates if I need to log to <code>stdout</code> or to a file like I've been doing. Here is the change in the configuration:</p>
<p class="code_title"><i>config.py</i>: Option to log to stdout.</p>

<pre><code class="language-python">class Config(object):
    # ...
    LOG_TO_STDOUT = os.environ.get('LOG_TO_STDOUT')
</code></pre>
<p>Then in the application factory function I can check this configuration to know how to configure the application's logger:</p>
<p class="code_title"><i>app/__init__.py</i>: Log to stdout or file.</p>

<pre><code class="language-python">def create_app(config_class=Config):
    # ...
    if not app.debug and not app.testing:
        # ...

        if app.config['LOG_TO_STDOUT']:
            stream_handler = logging.StreamHandler()
            stream_handler.setLevel(logging.INFO)
            app.logger.addHandler(stream_handler)
        else:
            if not os.path.exists('logs'):
                os.mkdir('logs')
            file_handler = RotatingFileHandler('logs/microblog.log',
                                               maxBytes=10240, backupCount=10)
            file_handler.setFormatter(logging.Formatter(
                '%(asctime)s %(levelname)s: %(message)s '
                '[in %(pathname)s:%(lineno)d]'))
            file_handler.setLevel(logging.INFO)
            app.logger.addHandler(file_handler)

        app.logger.setLevel(logging.INFO)
        app.logger.info('Microblog startup')

    return app
</code></pre>
<p>So now I need to set the <code>LOG_TO_STDOUT</code> environment variable when the application runs in Heroku, but not in other configurations. The Heroku CLI makes this easy, as it provides an option to set environment variables to be used at runtime:</p>
<pre><code>$ heroku config:set LOG_TO_STDOUT=1
Setting LOG_TO_STDOUT and restarting flask-microblog... done, v4
LOG_TO_STDOUT: 1
</code></pre>
<h2>Compiled Translations</h2>
<p>The third aspect of Microblog that relies on local files is the compiled language translation files. The more direct option to ensure those files never disappear from the ephemeral file system is to add the compiled language files to the git repository, so that they become part of the initial state of the application once it is deployed to Heroku.</p>
<p>A more elegant option, in my opinion, is to include the <code>flask translate compile</code> command in the start up command given to Heroku, so that any time the server is restarted those files are compiled again. I'm going to go with this option, since I know that my start up procedure is going to require more than one command anyway, asI also need to run the database migrations. So for now, I will set this problem aside, and will revisit it later when I write the <em>Procfile</em>.</p>
<h2>Elasticsearch Hosting</h2>
<p>Elasticsearch is one of the many services that can be added to a Heroku project, but unlike Postgres, this is not a service provided by Heroku, but by third parties that partner with Heroku to provide add-ons. At the time I'm writing this, there are three different providers of an integrated Elasticsearch service.</p>
<p>Before you configure Elasticsearch, be aware that Heroku requires your account to have a credit card on file before any third party add-on is installed, even if you stay within the free tier. If you prefer not to provide your credit card to Heroku, then skip this section. You will still be able to deploy the application, but the search functionality is not going to be enabled.</p>
<p>Out of the Elasticsearch options that are available as add-ons, I decided to try <a href="https://elements.heroku.com/addons/searchbox">SearchBox</a>, which comes with a free starter plan. To add SearchBox to your account, you have to run the following command while being logged in to Heroku:</p>
<pre><code>$ heroku addons:create searchbox:starter
</code></pre>
<p>This command will deploy an Elasticsearch service and leave the connection URL for the service in a <code>SEARCHBOX_URL</code> environment variable associated with your application. Once more keep in mind that this command will fail unless you add your credit card to your Heroku account.</p>
<p>If you recall from <a href="../../the-flask-mega-tutorial-part-xvi-full-text-search-2018.html">Chapter 16</a>, my application looks for the Elasticsearch connection URL in the <code>ELASTICSEARCH_URL</code> variable, so I need to add this variable and set it to the connection URL assigned by SearchBox:</p>
<pre><code>$ heroku config:get SEARCHBOX_URL
&lt;your-elasticsearch-url&gt;
$ heroku config:set ELASTICSEARCH_URL=&lt;your-elasticsearch-url&gt;
</code></pre>
<p>Here I first asked Heroku to print the value of <code>SEARCHBOX_URL</code>, and then I added a new environment variable with the name <code>ELASTICSEARCH_URL</code> set to that same value.</p>
<p>Many other features of the application are also configured through environment variables, for example <code>SECRET_KEY</code>, <code>MS_TRANSLATOR_KEY</code>, <code>MAIL_SERVER</code> and a few more. These variables need to also be copied over to the Heroku deployment, so that they are accessible to the application. The <code>heroku config:set</code> can be used to transfer these variables from your <em>.env</em> file to Heroku.</p>
<p>The exampe below configures a secret key:</p>
<pre><code>heroku config:set SECRET_KEY=7853fbd853a249c586f7d810a7938b43
</code></pre>
<h2>Updates to Requirements</h2>
<p>Heroku expects the dependencies to be in the <em>requirements.txt</em> file, exactly like I defined it in <a href="../../the-flask-mega-tutorial-part-xv-a-better-application-structure-2018.html">Chapter 15</a>. But for the application to run on Heroku I need to add two new dependencies to this file.</p>
<p>Heroku does not provide a web server of its own. Instead, it expects the application to start its own web server on the port number given in the environment variable <code>$PORT</code>. Since the Flask development web server is not robust enough to use for production, I'm going to use <a href="http://gunicorn.org/">gunicorn</a> again, the server recommended by Heroku for Python applications.</p>
<p>The application will also be connecting to a Postgres database, and for that SQLAlchemy requires the <code>psycopg2</code> or <code>psycopg2-binary</code> packages to be installed. The binary version is, in general, preferred as it installs an already built version of this package, as opposite to <code>psycopg2</code> which requires a C compiler to be installed to build the package during installation.</p>
<p>Both <code>gunicorn</code> and <code>psycopg2-binary</code> need to be added to the <em>requirements.txt</em> file.</p>
<h2>The Procfile</h2>
<p>Heroku needs to know how to execute the application, and for that it uses a file named <em>Procfile</em> in the root directory of the application. The format of this file is simple, each line includes a process name, a colon, and then the command that starts the process. The most common type of application that runs on Heroku is a web application, and for this type of application the process name should be <code>web</code>. Below you can see a <em>Procfile</em> for Microblog:</p>
<p class="code_title"><i>Procfile</i>: Heroku Procfile.</p>

<pre><code>web: flask db upgrade; flask translate compile; gunicorn microblog:app
</code></pre>
<p>Here I defined the command to start the web application as three commands in sequence. First I run a database migration upgrade, then I compile the language translations, and finally I start the server.</p>
<p>Because the first two sub-commands are based on the <code>flask</code> command, I need to add the <code>FLASK_APP</code> environment variable:</p>
<pre><code>$ heroku config:set FLASK_APP=microblog.py
Setting FLASK_APP and restarting flask-microblog... done, v6
FLASK_APP: microblog.py
</code></pre>
<p>The application also relies on other environment variables, such as those that configure the email server or the token for the live translations. Those need to be added with more <code>heroku config:set</code> commands.</p>
<p>The <code>gunicorn</code> command is simpler than what I used for the Ubuntu deployment, because this server has a very good integration with the Heroku environment. For example, the <code>$PORT</code> environment variable is honored by default, and instead of using the <code>-w</code> option to set the number of workers, heroku recommends adding a variable called <code>WEB_CONCURRENCY</code>, which <code>gunicorn</code> uses when <code>-w</code> is not provided, giving you the flexibility to control the number of workers without having to modify the Procfile.</p>
<h2>Deploying the Application</h2>
<p>All the preparatory steps are complete, so now it is time to run the deployment. To upload the application to Heroku's servers for deployment, the <code>git push</code> command is used. This is similar to how you push changes in your local git repository to GitHub or other remote git server.</p>
<p>There are a couple of variations on how to do this, depending on how you created your git repository. If you are using my <code>v0.18</code> code, then you need to create a branch based on this tag, and push it as the remote <code>main</code> branch, as follows:</p>
<pre><code>$ git checkout -b deploy
$ git push heroku deploy:main
</code></pre>
<p>If instead, you are working with your own repository, then your code is already in a <code>main</code> or <code>master</code> branch, so you first need to make sure that your changes are committed:</p>
<pre><code>$ git commit -a -m &quot;heroku deployment changes&quot;
</code></pre>
<p>And then you can run the following to start the deployment:</p>
<pre><code>$ git push heroku main  # you may need to use &quot;master&quot; instead of &quot;main&quot;
</code></pre>
<p>Regardless of how you push the branch, you should see the following output from Heroku:</p>
<pre><code>$ git push heoroku deploy:main
Enumerating objects: 264, done.
Counting objects: 100% (264/264), done.
Delta compression using up to 12 threads
Compressing objects: 100% (183/183), done.
Writing objects: 100% (264/264), 59.44 KiB | 5.94 MiB/s, done.
Total 264 (delta 132), reused 143 (delta 62)
remote: Compressing source files... done.
remote: Building source:
remote:
remote: -----&gt; Building on the Heroku-20 stack
remote: -----&gt; Determining which buildpack to use for this app
remote: -----&gt; Python app detected
remote: -----&gt; No Python version was specified. Using the buildpack default: python-3.9.6
remote:        To use a different version, see: https://devcenter.heroku.com/articles/...
remote: -----&gt; Installing python-3.9.6
remote: -----&gt; Installing pip 20.2.4, setuptools 47.1.1 and wheel 0.36.2
remote: -----&gt; Installing SQLite3
remote: -----&gt; Installing requirements with pip
...
remote:
remote: -----&gt; Discovering process types
remote:        Procfile declares types -&gt; web
remote:
remote: -----&gt; Compressing...
remote:        Done: 69.2M
remote: -----&gt; Launching...
remote:        Released v7
remote:        https://flask-microblog.herokuapp.com/ deployed to Heroku
remote:
remote: Verifying deploy... done.
To https://git.heroku.com/flask-microblog.git
 * [new branch]      deploy -&gt; main
</code></pre>
<p>The label <code>heroku</code> that we used in the <code>git push</code> command is the remote that was automatically added by the Heroku CLI when the application was created. The <code>deploy:main</code> argument means that I'm pushing the code from the local repository referenced by the <code>deploy</code> branch to the <code>main</code> branch on the Heroku repository. When you work with your own projects, you will likely be pushing with the command <code>git push heroku main</code>, which pushes your local <code>main</code> branch. Because of the way this project is structured, I'm pushing a branch that is not <code>main</code>, but the destination branch on the Heroku side always needs to be <code>main</code> or <code>master</code> as those are the only branch names that Heroku accepts for deployment.</p>
<p>And that is it, the application should now be deployed at the URL that you were given in the output of the command that created the application. In my case, the URL was <em>https://flask-microblog.herokuapp.com</em>, so that is what I need to type to access the application.</p>
<p>If you want to see the log entries for the running application, use the <code>heroku logs</code> command. This can be useful if for any reason the application fails to start. If there were any errors, those will be in the logs.</p>
<h2>Deploying Application Updates</h2>
<p>To deploy a new version of the application, you just need to run a new <code>git push</code> command with the new code. This will repeat the deployment process, take the old deployment offline, and then replace it with the new code. The commands in the Procfile will run again as part of the new deployment, so any new database migrations or translations will be updated during the process.</p></div>

<div class="card patreon-bar">
  <div class="card-body">
    <h5>Become a Patron!</h5>
    <p class="card-text">Hello, and thank you for visiting my blog! If you enjoyed this article, please consider supporting my work on this blog on <a href="https://patreon.com/miguelgrinberg">Patreon</a>!</p>
    <a href="https://patreon.com/miguelgrinberg" alt="Become a Patron!" title="Become a Patron!"><img src="../../../static/patreon-button.png"></a>
  </div>
</div>


<div class="card social-bar">
  <div class="card-body">
    <h5>Share this post:</h5>
      <!-- Sharingbutton Hacker News -->
      <a class="resp-sharing-button__link" href="https://news.ycombinator.com/submitlink?u=https%3A//blog.miguelgrinberg.com/post/the-flask-mega-tutorial-part-xviii-deployment-on-heroku-2018&amp;t=The%20Flask%20Mega-Tutorial%20Part%20XVIII%3A%20Deployment%20on%20Heroku%20%282018%29" target="_blank" rel="noopener" aria-label="Hacker News">
        <div class="resp-sharing-button resp-sharing-button--hackernews resp-sharing-button--medium"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 140 140"><path fill-rule="evenodd" d="M60.94 82.314L17 0h20.08l25.85 52.093c.397.927.86 1.888 1.39 2.883.53.994.995 2.02 1.393 3.08.265.4.463.764.596 1.095.13.334.262.63.395.898.662 1.325 1.26 2.618 1.79 3.877.53 1.26.993 2.42 1.39 3.48 1.06-2.254 2.22-4.673 3.48-7.258 1.26-2.585 2.552-5.27 3.877-8.052L103.49 0h18.69L77.84 83.308v53.087h-16.9v-54.08z"></path></svg></div>Hacker News</div>
      </a>

      <!-- Sharingbutton Reddit -->
      <a class="resp-sharing-button__link" href="https://reddit.com/submit/?url=https%3A//blog.miguelgrinberg.com/post/the-flask-mega-tutorial-part-xviii-deployment-on-heroku-2018&amp;resubmit=true&amp;title=The%20Flask%20Mega-Tutorial%20Part%20XVIII:%20Deployment%20on%20Heroku%20(2018)" target="_blank" rel="noopener" aria-label="Reddit">
        <div class="resp-sharing-button resp-sharing-button--reddit resp-sharing-button--medium"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M24 11.5c0-1.65-1.35-3-3-3-.96 0-1.86.48-2.42 1.24-1.64-1-3.75-1.64-6.07-1.72.08-1.1.4-3.05 1.52-3.7.72-.4 1.73-.24 3 .5C17.2 6.3 18.46 7.5 20 7.5c1.65 0 3-1.35 3-3s-1.35-3-3-3c-1.38 0-2.54.94-2.88 2.22-1.43-.72-2.64-.8-3.6-.25-1.64.94-1.95 3.47-2 4.55-2.33.08-4.45.7-6.1 1.72C4.86 8.98 3.96 8.5 3 8.5c-1.65 0-3 1.35-3 3 0 1.32.84 2.44 2.05 2.84-.03.22-.05.44-.05.66 0 3.86 4.5 7 10 7s10-3.14 10-7c0-.22-.02-.44-.05-.66 1.2-.4 2.05-1.54 2.05-2.84zM2.3 13.37C1.5 13.07 1 12.35 1 11.5c0-1.1.9-2 2-2 .64 0 1.22.32 1.6.82-1.1.85-1.92 1.9-2.3 3.05zm3.7.13c0-1.1.9-2 2-2s2 .9 2 2-.9 2-2 2-2-.9-2-2zm9.8 4.8c-1.08.63-2.42.96-3.8.96-1.4 0-2.74-.34-3.8-.95-.24-.13-.32-.44-.2-.68.15-.24.46-.32.7-.18 1.83 1.06 4.76 1.06 6.6 0 .23-.13.53-.05.67.2.14.23.06.54-.18.67zm.2-2.8c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm5.7-2.13c-.38-1.16-1.2-2.2-2.3-3.05.38-.5.97-.82 1.6-.82 1.1 0 2 .9 2 2 0 .84-.53 1.57-1.3 1.87z"/></svg></div>Reddit</div>
      </a>

      <!-- Sharingbutton Twitter -->
      <a class="resp-sharing-button__link" href="https://twitter.com/intent/tweet/?text=The%20Flask%20Mega-Tutorial%20Part%20XVIII%3A%20Deployment%20on%20Heroku%20%282018%29&amp;url=https%3A//blog.miguelgrinberg.com/post/the-flask-mega-tutorial-part-xviii-deployment-on-heroku-2018" target="_blank" rel="noopener" aria-label="Twitter">
        <div class="resp-sharing-button resp-sharing-button--twitter resp-sharing-button--medium"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M23.44 4.83c-.8.37-1.5.38-2.22.02.93-.56.98-.96 1.32-2.02-.88.52-1.86.9-2.9 1.1-.82-.88-2-1.43-3.3-1.43-2.5 0-4.55 2.04-4.55 4.54 0 .36.03.7.1 1.04-3.77-.2-7.12-2-9.36-4.75-.4.67-.6 1.45-.6 2.3 0 1.56.8 2.95 2 3.77-.74-.03-1.44-.23-2.05-.57v.06c0 2.2 1.56 4.03 3.64 4.44-.67.2-1.37.2-2.06.08.58 1.8 2.26 3.12 4.25 3.16C5.78 18.1 3.37 18.74 1 18.46c2 1.3 4.4 2.04 6.97 2.04 8.35 0 12.92-6.92 12.92-12.93 0-.2 0-.4-.02-.6.9-.63 1.96-1.22 2.56-2.14z"/></svg></div>Twitter</div>
      </a>

      <!-- Sharingbutton LinkedIn -->
      <a class="resp-sharing-button__link" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3A//blog.miguelgrinberg.com/post/the-flask-mega-tutorial-part-xviii-deployment-on-heroku-2018&amp;title=The%20Flask%20Mega-Tutorial%20Part%20XVIII%3A%20Deployment%20on%20Heroku%20%282018%29&amp;summary=The%20Flask%20Mega-Tutorial%20Part%20XVIII%3A%20Deployment%20on%20Heroku%20%282018%29&amp;source=https%3A//blog.miguelgrinberg.com/post/the-flask-mega-tutorial-part-xviii-deployment-on-heroku-2018" target="_blank" rel="noopener" aria-label="LinkedIn">
        <div class="resp-sharing-button resp-sharing-button--linkedin resp-sharing-button--medium"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M6.5 21.5h-5v-13h5v13zM4 6.5C2.5 6.5 1.5 5.3 1.5 4s1-2.4 2.5-2.4c1.6 0 2.5 1 2.6 2.5 0 1.4-1 2.5-2.6 2.5zm11.5 6c-1 0-2 1-2 2v7h-5v-13h5V10s1.6-1.5 4-1.5c3 0 5 2.2 5 6.3v6.7h-5v-7c0-1-1-2-2-2z"/></svg></div>LinkedIn</div>
      </a>

      <!-- Sharingbutton Facebook -->
      <a class="resp-sharing-button__link" href="https://facebook.com/sharer/sharer.php?u=https%3A//blog.miguelgrinberg.com/post/the-flask-mega-tutorial-part-xviii-deployment-on-heroku-2018" target="_blank" rel="noopener" aria-label="Facebook">
        <div class="resp-sharing-button resp-sharing-button--facebook resp-sharing-button--medium"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18.77 7.46H14.5v-1.9c0-.9.6-1.1 1-1.1h3V.5h-4.33C10.24.5 9.5 3.44 9.5 5.32v2.15h-3v4h3v12h5v-12h3.85l.42-4z"/></svg></div>Facebook</div>
      </a>

      <!-- Sharingbutton E-Mail -->
      <a class="resp-sharing-button__link" href="mailto:?subject=The%20Flask%20Mega-Tutorial%20Part%20XVIII%3A%20Deployment%20on%20Heroku%20%282018%29&amp;body=https%3A//blog.miguelgrinberg.com/post/the-flask-mega-tutorial-part-xviii-deployment-on-heroku-2018" target="_self" rel="noopener" aria-label="E-Mail">
        <div class="resp-sharing-button resp-sharing-button--email resp-sharing-button--medium"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M22 4H2C.9 4 0 4.9 0 6v12c0 1.1.9 2 2 2h20c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zM7.25 14.43l-3.5 2c-.08.05-.17.07-.25.07-.17 0-.34-.1-.43-.25-.14-.24-.06-.55.18-.68l3.5-2c.24-.14.55-.06.68.18.14.24.06.55-.18.68zm4.75.07c-.1 0-.2-.03-.27-.08l-8.5-5.5c-.23-.15-.3-.46-.15-.7.15-.22.46-.3.7-.14L12 13.4l8.23-5.32c.23-.15.54-.08.7.15.14.23.07.54-.16.7l-8.5 5.5c-.08.04-.17.07-.27.07zm8.93 1.75c-.1.16-.26.25-.43.25-.08 0-.17-.02-.25-.07l-3.5-2c-.24-.13-.32-.44-.18-.68s.44-.32.68-.18l3.5 2c.24.13.32.44.18.68z"/></svg></div>E-Mail</div>
      </a>

  </div>
</div>

<div id="comments" class="post-comment-count">
  
  <a class="btn btn-outline-secondary" href="../../the-flask-mega-tutorial-part-xviii-deployment-on-heroku-2018.html#comments">230 comments</a>
  
</div>


<div class="comments">
  <ul>
    
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/c930f3f6b84e57d2ca27650df6d318ab?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#201</span> <span class="badge text-bg-warning">Ryan</span> said
    
    <span class="flask-moment" data-timestamp="2021-09-10T10:33:00Z" data-function="fromNow" data-refresh="0" style="display: none">2021-09-10T10:33:00Z</span>
  </p>
  <div>
    <p>Hello Miguel, thank you very much for your advice. This is understood!</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/f6425192c5cc158952accd15e82a9551?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#202</span> <span class="badge text-bg-warning">Greg Herrington</span> said
    
    <span class="flask-moment" data-timestamp="2021-09-23T20:40:58Z" data-function="fromNow" data-refresh="0" style="display: none">2021-09-23T20:40:58Z</span>
  </p>
  <div>
    <p>Cross posting here because this solved my issue on ElasticSearch in Heroku:</p>
<p>For who is facing this error:</p>
<p>elasticsearch.exceptions.NotFoundError: NotFoundError(404, 'index_not_found_exception', 'no such index [posts]', posts, index_expression)</p>
<p>You need to create the index because it looks like the automatic creation of indices is disabled (by setting action.auto_create_index to false the SearchBox configuration).</p>
<p>...<br>
def add_to_index(index, model):<br>
    ...<br>
    current_app.elasticsearch.indices.create(index=index, ignore=400)<br>
    current_app.elasticsearch.index(index=index, id=<a href="http://model.id/" rel="nofollow">model.id</a>, body=payload)</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/1c02e8ac4ab9a87fbb52c6ffa524c00a?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#203</span> <span class="badge text-bg-warning">Kabaki Kiarie</span> said
    
    <span class="flask-moment" data-timestamp="2021-11-04T09:01:15Z" data-function="fromNow" data-refresh="0" style="display: none">2021-11-04T09:01:15Z</span>
  </p>
  <div>
    <p>Hey Miguel I have a quick question I am using this string for the database url <br>
SQLALCHEMY_DATABASE_URI = os.environ.get('DATABASE_URL', '').replace( 'postgres://', 'postgresql://')<br>
 and I am getting the following error on Travis AttributeError: 'NoneType' object has no attribute 'replace'<br>
I have tried working around and changing the configuration and nothing seems to work what could the problem<br>
but running the tests locally works fine but when I run them on Travis I get that error.</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/729e26a2a2c7ff24a71958d4aa4e5f35?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#204</span> <span class="badge text-bg-danger">Miguel Grinberg</span> said
    
    <span class="flask-moment" data-timestamp="2021-11-04T10:26:51Z" data-function="fromNow" data-refresh="0" style="display: none">2021-11-04T10:26:51Z</span>
  </p>
  <div>
    <p>@Kabaki: the error indicates that the <code>DATABASE_URL</code> environment variable isn't set.</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/6a994d437dee29c079317b406f345c1b?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#205</span> <span class="badge text-bg-warning">Asif Iqbal</span> said
    
    <span class="flask-moment" data-timestamp="2021-12-01T06:03:48Z" data-function="fromNow" data-refresh="0" style="display: none">2021-12-01T06:03:48Z</span>
  </p>
  <div>
    <p>Hi, I had some database model error while deploying the app on Heroku. I traced the error back to my git setup, where I put 'migrations' folder in git/exclude. Now that I removed 'migrations' from exclude, still I am facing the same issue, even after pushing updated project to git and restarting all dynos.</p>
<p>Following is the traceback from web log of Heroku:<br>
<a href="https://gist.github.com/asif256000/55be6178e6526f83767aec7cd0734726" rel="nofollow">https://gist.github.com/asif256000/55be6178e6526f83767aec7cd0734726</a></p>
<p>While trying to register a user, following is the error:<br>
<a href="https://gist.github.com/asif256000/dd1760b339d70fd1ea076ac35aae51a5" rel="nofollow">https://gist.github.com/asif256000/dd1760b339d70fd1ea076ac35aae51a5</a></p>
<p>I think the issue might be resolved if Heroku takes the updated Git repo and deploy it. Kindly tell me the process to do so.</p>
<p>If you think the issue is something else, please tell me that too.</p>
<p>My repo is: <a href="https://github.com/asif256000/flask_test_webapp" rel="nofollow">https://github.com/asif256000/flask_test_webapp</a></p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/729e26a2a2c7ff24a71958d4aa4e5f35?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#206</span> <span class="badge text-bg-danger">Miguel Grinberg</span> said
    
    <span class="flask-moment" data-timestamp="2021-12-01T11:15:06Z" data-function="fromNow" data-refresh="0" style="display: none">2021-12-01T11:15:06Z</span>
  </p>
  <div>
    <p>@Asif: you appear to have a problem with the translations in addition to any issues you may have had with the database. The error complains that a directory called "app_pkgtranslations" does not exist. Does this mean anything to you? I don't know what this directory is.</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/6a994d437dee29c079317b406f345c1b?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#207</span> <span class="badge text-bg-warning">Asif Iqbal</span> said
    
    <span class="flask-moment" data-timestamp="2021-12-02T05:20:04Z" data-function="fromNow" data-refresh="0" style="display: none">2021-12-02T05:20:04Z</span>
  </p>
  <div>
    <p>@Miguel, I think I need to redeploy the project to Heroku after rechecking my files. 'app_pkg' is the name of the package in the application. I did not want to confuse between flask's app and my app's app that's why I renamed it. I also could not find any 'app_pkgtranslations' in my codebase, but I will definitely try again.</p>
<p>Thank you for taking your time to check everyone's issues. You really go above and beyond. Really appreciate your effort. I will definitely buy your book once I get a good job :)</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/2eceafdc4085490837ed87a6be11565e?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#208</span> <span class="badge text-bg-warning">David Duehren</span> said
    
    <span class="flask-moment" data-timestamp="2021-12-31T08:13:28Z" data-function="fromNow" data-refresh="0" style="display: none">2021-12-31T08:13:28Z</span>
  </p>
  <div>
    <p>HI Miguel,</p>
<p>I like this tutorial very much, and have used bits and pieces of it in a couple of projects.  I'm about to deploy to Heroku and I'm wondering if one can run a Flask shell to setup a few entries in a database, or if there is another way in this instance.</p>
<p>Thanks,</p>
<p>David Duehren</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/729e26a2a2c7ff24a71958d4aa4e5f35?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#209</span> <span class="badge text-bg-danger">Miguel Grinberg</span> said
    
    <span class="flask-moment" data-timestamp="2022-01-01T15:34:26Z" data-function="fromNow" data-refresh="0" style="display: none">2022-01-01T15:34:26Z</span>
  </p>
  <div>
    <p>@David: Doing manual set up of your database is not really something you should do. You should incorporate these changes in a database migration or in a CLI script, so that you can make the updates in a scripted way that is repeatable and testable.</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/06b7b39e582c094be216c382dc039576?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#210</span> <span class="badge text-bg-warning">Yuming</span> said
    
    <span class="flask-moment" data-timestamp="2022-01-14T00:04:14Z" data-function="fromNow" data-refresh="0" style="display: none">2022-01-14T00:04:14Z</span>
  </p>
  <div>
    <p>If you use a gmail account for users to reset their passwords, you may have to visit <a href="https://accounts.google.com/b/0/DisplayUnlockCaptcha" rel="nofollow">https://accounts.google.com/b/0/DisplayUnlockCaptcha</a> .  You will see the following message and a "Continue" button,<br>
    Allow access to your Google account<br>
    As a security precaution, Google may require you to complete this additional step when signing into a new <br>
    device or application.<br>
Just press the button to enable access.</p>
<p>To allow access, click the Continue button below.</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/ef6f1b6772e0b685dc506d209f2e0b2e?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#211</span> <span class="badge text-bg-warning">Kevin Bowen</span> said
    
    <span class="flask-moment" data-timestamp="2022-02-19T04:42:40Z" data-function="fromNow" data-refresh="0" style="display: none">2022-02-19T04:42:40Z</span>
  </p>
  <div>
    <p>Perhaps it's just me; but, here is another FYI I figured out:</p>
<p>I was getting the following error on startup:</p>
<pre><code>2022-02-19T04:09:08.835002+00:00 app[web.1]: File &quot;/app/.heroku/python/lib/python3.9/site-packages/elastic_transport/<a href="http://client_utils.py/" rel="nofollow">client_utils.py</a>&quot;, line 198, in url_to_node_config
2022-02-19T04:09:08.835002+00:00 app[web.1]: raise ValueError(
2022-02-19T04:09:08.835002+00:00 app[web.1]: ValueError: URL must include a 'scheme', 'host', and 'port' component (ie 'https://localhost:9200')
</code></pre>
<p>My ELASTICSEARCH_URL matched both the SEARCHBOX_URL &amp; SEARCHBOX_SSL_URL (all three were identical. My python elasticsearch package==8.0.0. To fix it, I issued the command:</p>
<pre><code>heroku config:set ELASTICSEARCH_URL=&lt;your-elasticsearch-url&gt;:9200
</code></pre>
<p>Note that I append a port designation to the command. After that the application came up successfully.</p>
<p>Thanks for all the hard work that you have, obviously, put in maintaining this tutorial. As well as all of the patience you demonstrate providing user support. Fantastic work!</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/1d6894940b3ec622a11d3a03261d279f?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#212</span> <span class="badge text-bg-warning">Sasha</span> said
    
    <span class="flask-moment" data-timestamp="2022-09-30T13:33:47Z" data-function="fromNow" data-refresh="0" style="display: none">2022-09-30T13:33:47Z</span>
  </p>
  <div>
    <p>Hello Miguel, I used Roles models from you  'flasky' repository  . When I deploying my app  at heroku , I am using command  " heroku run python <a href="http://flask_proj.py/" rel="nofollow">flask_proj.py</a> deploy " .   <a href="http://flask_proj.py/" rel="nofollow">flask_proj.py</a>- include function 'deploy'  with decorator cli command ,  Role.insert_roles() and upgrade() . But table Roles steel empty. How solve this problem? In your microblog you don`t used  Roles and I  connected code from flasky and microblog:)</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/729e26a2a2c7ff24a71958d4aa4e5f35?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#213</span> <span class="badge text-bg-danger">Miguel Grinberg</span> said
    
    <span class="flask-moment" data-timestamp="2022-09-30T22:46:23Z" data-function="fromNow" data-refresh="0" style="display: none">2022-09-30T22:46:23Z</span>
  </p>
  <div>
    <p>@Sasha: I can't really answer this. You likely have a bug in your code that prevents the roles from being saved. Are you committing the database session?</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/755a14a323ca79bff7b798d4b9bdfd0e?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#214</span> <span class="badge text-bg-warning">Yasmin Amran</span> said
    
    <span class="flask-moment" data-timestamp="2022-10-13T12:34:21Z" data-function="fromNow" data-refresh="0" style="display: none">2022-10-13T12:34:21Z</span>
  </p>
  <div>
    <p>will you show hoe to deploy on railway ( science Heroku is not free anymore ) ?</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/729e26a2a2c7ff24a71958d4aa4e5f35?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#215</span> <span class="badge text-bg-danger">Miguel Grinberg</span> said
    
    <span class="flask-moment" data-timestamp="2022-10-14T08:40:53Z" data-function="fromNow" data-refresh="0" style="display: none">2022-10-14T08:40:53Z</span>
  </p>
  <div>
    <p>@Yasmin: No. Please use their documentation if you want to use their service. Or use any of the other two deployment options I have included in this tutorial.</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/e7ba16a34a51a21185337455352f719e?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#216</span> <span class="badge text-bg-warning">Seb</span> said
    
    <span class="flask-moment" data-timestamp="2022-11-14T00:42:00Z" data-function="fromNow" data-refresh="0" style="display: none">2022-11-14T00:42:00Z</span>
  </p>
  <div>
    <p>Hi Miguel, <br>
Thank you for your tutorials. They've helped me advance my career tremendously. </p>
<p>I have problems with flask-login when deploying to Heroku. Locally, the app works as intended, and multiple users can log in simultaneously. In Heroku, however, I am randomly logged out, and if two or more users log in, data from one user is displayed to the other users. There are some StackOverflow threads on the topic(<a href="https://stackoverflow.com/questions/39684364/heroku-gunicorn-flask-login-is-not-working-properly" rel="nofollow">https://stackoverflow.com/questions/39684364/heroku-gunicorn-flask-login-is-not-working-properly</a>), so I followed their recommendation and added the --preload statement to the Procfile like this:<br>
web: flask db upgrade; gunicorn main:app --preload</p>
<p>Unfortunately, this did not solve the problem for me. I was wondering if you know of this problem and what I should be on the lookout for to solve it. Thank you!</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/729e26a2a2c7ff24a71958d4aa4e5f35?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#217</span> <span class="badge text-bg-danger">Miguel Grinberg</span> said
    
    <span class="flask-moment" data-timestamp="2022-11-14T11:39:09Z" data-function="fromNow" data-refresh="0" style="display: none">2022-11-14T11:39:09Z</span>
  </p>
  <div>
    <p>@Seb: Is this with the application from this tutorial, or with your own project? Users seeing data from other users is a severe error, and nobody ever reported such a problem for this tutorial, so I have to think you are using your own application, in which case, I cannot really tell you what's wrong, but I would be very surprised if this is a problem with Flask-Login. The most likely cause is a bug in your own logic.</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/785f7ce91fa620eaa495c25bd677e1f1?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#218</span> <span class="badge text-bg-warning">Huy Quang Dong</span> said
    
    <span class="flask-moment" data-timestamp="2022-11-19T00:01:09Z" data-function="fromNow" data-refresh="0" style="display: none">2022-11-19T00:01:09Z</span>
  </p>
  <div>
    <p>Hi Miguel,<br>
Thank you for this tutorial. I've tried with your github's repo. The app work fine except the search box.<br>
When i want to submit a new post, i get this error from elasticsearch : elasticsearch.exceptions.NotFoundError: TransportError(404, index[post],....)</p>
<p>Show an index named post is need for run the search? How can i creat it on herroku. I run your app well localy on my desktop with elasticsearch but the deploy on heroku give me error. I've followed all the steps.</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/729e26a2a2c7ff24a71958d4aa4e5f35?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#219</span> <span class="badge text-bg-danger">Miguel Grinberg</span> said
    
    <span class="flask-moment" data-timestamp="2022-11-19T00:07:45Z" data-function="fromNow" data-refresh="0" style="display: none">2022-11-19T00:07:45Z</span>
  </p>
  <div>
    <p>@Huy: the index should be automatically created when you add the first article. Until you do that, search are probably going to return 404, because the index does not exist yet.</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/a970510529157f5cf4e474006daa718d?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#220</span> <span class="badge text-bg-warning">Lucy</span> said
    
    <span class="flask-moment" data-timestamp="2022-11-23T23:32:11Z" data-function="fromNow" data-refresh="0" style="display: none">2022-11-23T23:32:11Z</span>
  </p>
  <div>
    <p>Hello Miguel!! I've got a problem with the buildpack. This is what I get when I run the git push heroku main command:<br>
Enumerating objects: 52, done.<br>
Counting objects: 100% (52/52), done.<br>
Delta compression using up to 4 threads<br>
Compressing objects: 100% (49/49), done.<br>
Writing objects: 100% (52/52), 27.29 KiB | 3.90 MiB/s, done.<br>
Total 52 (delta 6), reused 13 (delta 0), pack-reused 0<br>
remote: Compressing source files... done.<br>
remote: Building source:<br>
remote: <br>
remote: -----&gt; Building on the Heroku-22 stack<br>
remote: -----&gt; Using buildpack: heroku/python<br>
remote: -----&gt; App not compatible with buildpack: <a href="https://buildpack-registry.s3.amazonaws.com/buildpacks/heroku/python.tgz" rel="nofollow">https://buildpack-registry.s3.amazonaws.com/buildpacks/heroku/python.tgz</a><br>
remote:        More info: <a href="https://devcenter.heroku.com/articles/buildpacks#detection-failure" rel="nofollow">https://devcenter.heroku.com/articles/buildpacks#detection-failure</a><br>
remote: <br>
remote:  !     Push failed<br>
remote:  !<br>
remote:  ! ## Warning - The same version of this code has already been built: 24629b663bf42afc492e62d19041704264962a13<br>
remote:  !<br>
remote:  ! We have detected that you have triggered a build from source code with version 24629b663bf42afc492e62d19041704264962a13<br>
remote:  ! at least twice. One common cause of this behavior is attempting to deploy code from a different branch.<br>
remote:  !<br>
remote:  ! If you are developing on a branch and deploying via git you must run<br>
remote:  !<br>
remote:  !     git push heroku &lt;branchname&gt;:main<br>
remote:  !<br>
remote:  ! This article goes into details on the behavior:<br>
remote:  !   <a href="https://devcenter.heroku.com/articles/duplicate-build-version" rel="nofollow">https://devcenter.heroku.com/articles/duplicate-build-version</a><br>
remote: <br>
remote: Verifying deploy...<br>
remote: <br>
remote: !   Push rejected to flask-microbloglmb.<br>
remote: <br>
To <a href="https://git.heroku.com/flask-microbloglmb.git" rel="nofollow">https://git.heroku.com/flask-microbloglmb.git</a><br>
 ! [remote rejected] main -&gt; main (pre-receive hook declined)<br>
error: failed to push some refs to '<a href="https://git.heroku.com/flask-microbloglmb.git'" rel="nofollow">https://git.heroku.com/flask-microbloglmb.git'</a></p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/729e26a2a2c7ff24a71958d4aa4e5f35?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#221</span> <span class="badge text-bg-danger">Miguel Grinberg</span> said
    
    <span class="flask-moment" data-timestamp="2022-11-23T23:51:12Z" data-function="fromNow" data-refresh="0" style="display: none">2022-11-23T23:51:12Z</span>
  </p>
  <div>
    <p>@Lucy: I"m not sure, but maybe you are pushing the same code you already pushed before? Heroku requires changes between releases, you cannot push the same code twice.</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/229d3f6e18836668386dbb301601bd63?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#222</span> <span class="badge text-bg-warning">Wen</span> said
    
    <span class="flask-moment" data-timestamp="2023-05-09T12:23:39Z" data-function="fromNow" data-refresh="0" style="display: none">2023-05-09T12:23:39Z</span>
  </p>
  <div>
    <p>Hello Miguel! I'm trying to use your code to deploy in Heroku. First note - heroku postgresql db seems not free now. Second one related with error during deployment:</p>
<p>=========================================================<br>
Building wheel for greenlet (<a href="http://setup.py/" rel="nofollow">setup.py</a>): started<br>
remote:          Building wheel for greenlet (<a href="http://setup.py/" rel="nofollow">setup.py</a>): finished with status 'error'<br>
remote:          error: subprocess-exited-with-error<br>
remote:        <br>
remote:          × python <a href="http://setup.py/" rel="nofollow">setup.py</a> bdist_wheel did not run successfully.</p>
&lt;h4&gt;&lt;/h4&gt;
<p>then many-many lines with like </p>
&lt;h4&gt;&lt;/h4&gt;
<p>creating build/temp.linux-x86_64-cpython-311<br>
remote:              creating build/temp.linux-x86_64-cpython-311/src<br>
remote:              creating build/temp.linux-x86_64-cpython-311/src/greenlet<br>
remote:              gcc -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -fPIC -I/app/.heroku/python/include/python3.11 -c src/greenlet/greenlet.c -o build/temp.linux-x86_64-cpython-311/src/greenlet/greenlet.o<br>
remote:              In file included from src/greenlet/greenlet.c:11:<br>
remote:              src/greenlet/greenlet.h:42:5: error: unknown type name ‘CFrame’<br>
remote:                 42 |     CFrame* cframe;<br>
remote:                    |     ^~~~~~</p>
&lt;h4&gt;&lt;/h4&gt;
<p>end with :</p>
&lt;h3&gt;&lt;/h3&gt;
<p>Building wheel for greenlet (<a href="http://setup.py/" rel="nofollow">setup.py</a>): started<br>
remote:          Building wheel for greenlet (<a href="http://setup.py/" rel="nofollow">setup.py</a>): finished with status 'error'<br>
remote:          error: subprocess-exited-with-error<br>
remote:        <br>
remote:          × python <a href="http://setup.py/" rel="nofollow">setup.py</a> bdist_wheel did not run successfully.<br>
=========================================================</p>
<p>Might it be that Python3.11 do not support greenlet==1.1.0?<br>
Assume Lucy (#220) may had same problem.</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/729e26a2a2c7ff24a71958d4aa4e5f35?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#223</span> <span class="badge text-bg-danger">Miguel Grinberg</span> said
    
    <span class="flask-moment" data-timestamp="2023-05-09T13:31:43Z" data-function="fromNow" data-refresh="0" style="display: none">2023-05-09T13:31:43Z</span>
  </p>
  <div>
    <p>@Wen: Why are you using such a new version of Python with such an old version of greenlet? If you want to use the latest Python, it would make more sense to try a version of greenlet that is also recent. I suggest you review the greenlet change log and find a version that is compatible with Python 3.11.</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/fbafb1f4569eef49343fc228c6e1d953?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#224</span> <span class="badge text-bg-warning">Adam </span> said
    
    <span class="flask-moment" data-timestamp="2023-07-04T21:50:32Z" data-function="fromNow" data-refresh="0" style="display: none">2023-07-04T21:50:32Z</span>
  </p>
  <div>
    <p>Hey @miguel,</p>
<p>My project works fine on Heroku locally when upgrading the migration running 'flask db upgrade' but it does not work on production. It returns this:</p>
<p><code>psycopg2.errors.InsufficientPrivilege: permission denied for schema heroku_ext CREATE TABLE alembic_version (
   ....
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.InsufficientPrivilege) permission denied for schema heroku_ext</code></p>
<p>I tried googling the error and I saw some recommendations to grant the user, but it does not solve the problem. Any suggestions? </p>
<p>Looking forward to your reply!</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/729e26a2a2c7ff24a71958d4aa4e5f35?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#225</span> <span class="badge text-bg-danger">Miguel Grinberg</span> said
    
    <span class="flask-moment" data-timestamp="2023-07-04T22:58:08Z" data-function="fromNow" data-refresh="0" style="display: none">2023-07-04T22:58:08Z</span>
  </p>
  <div>
    <p>@Adam: You must have deviated from this tutorial, because if you had followed these instructions I think you wouldn't be using the <code>heroku_ext</code> schema. I really don't have much details regarding this schema, as I have not used any Postgres extensions with Heroku since they started using it.</p>
  </div>
</div>
    </li>
    
  </ul>
</div>

<nav aria-label="Page navigation">
  <ul class="pagination justify-content-center">
    <li class="page-item"><a class="page-link" href="1.html#comments">&laquo;&laquo;</a></li>
    <li class="page-item"><a class="page-link" href="8.html#comments">&laquo;</a></li>
    <li class="page-item"><a class="page-link" href="10.html#comments">&raquo;</a></li>
    <li class="page-item"><a class="page-link" href="0.html#comments">&raquo;&raquo;</a></li>
  </ul>
</nav>



<div id="comment-form">
  <h3>Leave a Comment</h3>

  
  
  

  
<form action="#comment-form" method="post">
  <input id="url" name="url" type="hidden" value="">
<input id="csrf_token" name="csrf_token" type="hidden" value="IjQyYjY5YzZlNTcyYjFkMTVlZGRkOWJjYjA3ZmFlYWFiNTg3YmU5ODki.Zxdmgw.9it8H87q0mHhJQQWBeQFSJPrhiw">
    
  <div class="mb-3">
    <label class="form-label" for="name">Name</label>
    <div class="input-group has-validation">
      <input class="form-control" id="name" name="name" required type="text" value="">
    </div>
  </div>

    
    
  <div class="mb-3">
    <label class="form-label" for="email">Email</label>
    <div class="input-group has-validation">
      <input class="form-control" id="email" name="email" required type="text" value="">
    </div>
  </div>

    
  <div class="mb-3">
    <label class="form-label" for="comment">Comment</label>
    <div class="input-group has-validation">
      <textarea class="form-control" id="comment" name="comment" required>
</textarea>
    </div>
  </div>

    
  <div class="mb-3">
    <label class="form-label" for="captcha">Captcha</label>
    <div class="input-group has-validation">
      
<script src='https://www.google.com/recaptcha/api.js' async defer></script>
<div class="g-recaptcha" data-sitekey="6Ld5Zs4SAAAAAOY0DOi4r18bgHlEaz41qAoRf__S"></div>

    </div>
  </div>

    
  <input class="btn btn-primary mb-3" id="submit" name="submit" type="submit" value="Submit">

      
</form>

</div>


</div>

      </div>
    </div>
    
    <div class="col-md-4">
      <div id="sidebar">
        
          
  



<div class="card">
  
  
  <div class="card-header">Flask Web Development, 2nd Edition</div>
  <a class="card-book-cover" href="https://amzn.to/3lE2mok">
    <img src="../../../static/flask2e-book-cover-small.png" alt="Flask Web Development, 2nd Edition">
  </a>
  <div class="card-body">
    <p class="card-text">If you want to learn modern web development techniques with Python and Flask, you may find the second edition of my <a href="https://amzn.to/3lE2mok">O'Reilly book</a> useful.</p>
  </div>
  <div class="card-body">
    <a class="card-link" href="https://amzn.to/3lE2mok">Click here to get this Book!</a><br />
  </div>

  
</div>
        
        <div class="card">
  <div class="card-header">About Miguel</div>
  <div class="card-body">
    <img style="float: right; margin: 0px 8px 8px 0px; padding: 4px; border: 1px solid #ccc;" src="../../../static/miguel.jpg" />
    <p class="card-text">Welcome to my blog!</p>
    <p class="card-text">I'm a software engineer and technical writer, currently living in Drogheda, Ireland.</p>
    <p class="card-text">You can also find me on <a href="https://twitter.com/miguelgrinberg">Twitter</a>, <a href="https://mstdn.social/@miguelgrinberg">Mastodon</a>, <a href="https://github.com/miguelgrinberg">Github</a>, <a href="http://www.linkedin.com/in/miguelgrinberg">LinkedIn</a>, <a href="https://youtube.com/miguelgrinberg">YouTube</a>, <a href="https://www.facebook.com/miguelgrinbergblog">Facebook</a> and <a href="https://patreon.com/miguelgrinberg">Patreon</a>.</p>
    <p class="card-text">Thank you for visiting!</p>
  </div>
</div>
        
        <div class="card" id="categories">
  <div class="card-header">Categories</div>
  <div class="card-body">
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/AI/feed"><img src="../../../static/rss-small.png" title="AI RSS Feed" label="AI RSS Feed" alt="AI RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/AI" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="AI" /> <small><em>2</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/AWS/feed"><img src="../../../static/rss-small.png" title="AWS RSS Feed" label="AWS RSS Feed" alt="AWS RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/AWS" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="AWS" /> <small><em>1</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Arduino/feed"><img src="../../../static/rss-small.png" title="Arduino RSS Feed" label="Arduino RSS Feed" alt="Arduino RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Arduino" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Arduino" /> <small><em>7</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Authentication/feed"><img src="../../../static/rss-small.png" title="Authentication RSS Feed" label="Authentication RSS Feed" alt="Authentication RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Authentication" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Authentication" /> <small><em>10</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Blog/feed"><img src="../../../static/rss-small.png" title="Blog RSS Feed" label="Blog RSS Feed" alt="Blog RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Blog" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Blog" /> <small><em>1</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/C++/feed"><img src="../../../static/rss-small.png" title="C++ RSS Feed" label="C++ RSS Feed" alt="C++ RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/C++" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="C++" /> <small><em>5</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/CSS/feed"><img src="../../../static/rss-small.png" title="CSS RSS Feed" label="CSS RSS Feed" alt="CSS RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/CSS" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="CSS" /> <small><em>1</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Cloud/feed"><img src="../../../static/rss-small.png" title="Cloud RSS Feed" label="Cloud RSS Feed" alt="Cloud RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Cloud" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Cloud" /> <small><em>10</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Database/feed"><img src="../../../static/rss-small.png" title="Database RSS Feed" label="Database RSS Feed" alt="Database RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Database" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Database" /> <small><em>22</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Docker/feed"><img src="../../../static/rss-small.png" title="Docker RSS Feed" label="Docker RSS Feed" alt="Docker RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Docker" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Docker" /> <small><em>5</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Filmmaking/feed"><img src="../../../static/rss-small.png" title="Filmmaking RSS Feed" label="Filmmaking RSS Feed" alt="Filmmaking RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Filmmaking" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Filmmaking" /> <small><em>6</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Flask/feed"><img src="../../../static/rss-small.png" title="Flask RSS Feed" label="Flask RSS Feed" alt="Flask RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Flask" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Flask" /> <small><em>126</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Games/feed"><img src="../../../static/rss-small.png" title="Games RSS Feed" label="Games RSS Feed" alt="Games RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Games" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Games" /> <small><em>1</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Heroku/feed"><img src="../../../static/rss-small.png" title="Heroku RSS Feed" label="Heroku RSS Feed" alt="Heroku RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Heroku" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Heroku" /> <small><em>1</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/IoT/feed"><img src="../../../static/rss-small.png" title="IoT RSS Feed" label="IoT RSS Feed" alt="IoT RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/IoT" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="IoT" /> <small><em>8</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/JavaScript/feed"><img src="../../../static/rss-small.png" title="JavaScript RSS Feed" label="JavaScript RSS Feed" alt="JavaScript RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/JavaScript" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="JavaScript" /> <small><em>35</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/MicroPython/feed"><img src="../../../static/rss-small.png" title="MicroPython RSS Feed" label="MicroPython RSS Feed" alt="MicroPython RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/MicroPython" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="MicroPython" /> <small><em>9</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Microdot/feed"><img src="../../../static/rss-small.png" title="Microdot RSS Feed" label="Microdot RSS Feed" alt="Microdot RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Microdot" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Microdot" /> <small><em>1</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Microservices/feed"><img src="../../../static/rss-small.png" title="Microservices RSS Feed" label="Microservices RSS Feed" alt="Microservices RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Microservices" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Microservices" /> <small><em>2</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Movie Reviews/feed"><img src="../../../static/rss-small.png" title="Movie Reviews RSS Feed" label="Movie Reviews RSS Feed" alt="Movie Reviews RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Movie Reviews" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Movie Reviews" /> <small><em>5</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/OpenStack/feed"><img src="../../../static/rss-small.png" title="OpenStack RSS Feed" label="OpenStack RSS Feed" alt="OpenStack RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/OpenStack" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="OpenStack" /> <small><em>1</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Personal/feed"><img src="../../../static/rss-small.png" title="Personal RSS Feed" label="Personal RSS Feed" alt="Personal RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Personal" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Personal" /> <small><em>3</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Photography/feed"><img src="../../../static/rss-small.png" title="Photography RSS Feed" label="Photography RSS Feed" alt="Photography RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Photography" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Photography" /> <small><em>7</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Product Reviews/feed"><img src="../../../static/rss-small.png" title="Product Reviews RSS Feed" label="Product Reviews RSS Feed" alt="Product Reviews RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Product Reviews" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Product Reviews" /> <small><em>2</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Programming/feed"><img src="../../../static/rss-small.png" title="Programming RSS Feed" label="Programming RSS Feed" alt="Programming RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Programming" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Programming" /> <small><em>187</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Project Management/feed"><img src="../../../static/rss-small.png" title="Project Management RSS Feed" label="Project Management RSS Feed" alt="Project Management RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Project Management" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Project Management" /> <small><em>1</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Python/feed"><img src="../../../static/rss-small.png" title="Python RSS Feed" label="Python RSS Feed" alt="Python RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Python" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Python" /> <small><em>169</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/REST/feed"><img src="../../../static/rss-small.png" title="REST RSS Feed" label="REST RSS Feed" alt="REST RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/REST" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="REST" /> <small><em>7</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Rackspace/feed"><img src="../../../static/rss-small.png" title="Rackspace RSS Feed" label="Rackspace RSS Feed" alt="Rackspace RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Rackspace" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Rackspace" /> <small><em>1</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Raspberry Pi/feed"><img src="../../../static/rss-small.png" title="Raspberry Pi RSS Feed" label="Raspberry Pi RSS Feed" alt="Raspberry Pi RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Raspberry Pi" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Raspberry Pi" /> <small><em>8</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/React/feed"><img src="../../../static/rss-small.png" title="React RSS Feed" label="React RSS Feed" alt="React RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/React" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="React" /> <small><em>18</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Robotics/feed"><img src="../../../static/rss-small.png" title="Robotics RSS Feed" label="Robotics RSS Feed" alt="Robotics RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Robotics" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Robotics" /> <small><em>6</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Security/feed"><img src="../../../static/rss-small.png" title="Security RSS Feed" label="Security RSS Feed" alt="Security RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Security" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Security" /> <small><em>12</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Video/feed"><img src="../../../static/rss-small.png" title="Video RSS Feed" label="Video RSS Feed" alt="Video RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Video" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Video" /> <small><em>22</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/WebSocket/feed"><img src="../../../static/rss-small.png" title="WebSocket RSS Feed" label="WebSocket RSS Feed" alt="WebSocket RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/WebSocket" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="WebSocket" /> <small><em>2</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Webcast/feed"><img src="../../../static/rss-small.png" title="Webcast RSS Feed" label="Webcast RSS Feed" alt="Webcast RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Webcast" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Webcast" /> <small><em>3</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Windows/feed"><img src="../../../static/rss-small.png" title="Windows RSS Feed" label="Windows RSS Feed" alt="Windows RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Windows" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Windows" /> <small><em>1</em></small>
      </form>
    </div>
    
  </div>
</div>
        
      </div>
    </div>
    
  </div>
  <div id="footer">
    
    <p>&copy; 2012-<script type="text/javascript">document.write(new Date().getFullYear());</script> by Miguel Grinberg. All rights reserved. <a href="mailto:webmaster _at_ miguelgrinberg _dot_ com">Questions?</a></p>
  </div>
</div>

  
    <script src="../../../../cdn.jsdelivr.net/npm/bootstrap%405.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
  <script type="text/javascript" src="../../../static/prettify.js"></script>
  <script src="../../../../cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.4/moment-with-locales.min.js" integrity="sha512-42PE0rd+wZ2hNXftlM78BSehIGzezNeQuzihiBCvUEB3CVxHvsShF86wBWwQORNxNINlBPuq7rG4WWhNiTVHFg==" crossorigin="anonymous"></script>

<script>
moment.locale("en");
function flask_moment_render(elem) {{
    const timestamp = moment(elem.dataset.timestamp);
    const func = elem.dataset.function;
    const format = elem.dataset.format;
    const timestamp2 = elem.dataset.timestamp2;
    const no_suffix = elem.dataset.nosuffix;
    const units = elem.dataset.units;
    let args = [];
    if (format)
        args.push(format);
    if (timestamp2)
        args.push(moment(timestamp2));
    if (no_suffix)
        args.push(no_suffix);
    if (units)
        args.push(units);
    elem.textContent = timestamp[func].apply(timestamp, args);
    elem.classList.remove('flask-moment');
    elem.style.display = "";
}}
function flask_moment_render_all() {{
    const moments = document.querySelectorAll('.flask-moment');
    moments.forEach(function(moment) {{
        flask_moment_render(moment);
        const refresh = moment.dataset.refresh;
        if (refresh && refresh > 0) {{
            (function(elem, interval) {{
                setInterval(function() {{
                    flask_moment_render(elem);
                }}, interval);
            }})(moment, refresh);
        }}
    }})
}}
document.addEventListener("DOMContentLoaded", flask_moment_render_all);
</script>

  
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-20EHZP9GRZ"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-20EHZP9GRZ');
  </script>
  
  <script type="text/javascript">
    function setThemeUI() {
      document.getElementById('select-theme-auto').classList.remove('active');
      document.getElementById('select-theme-light').classList.remove('active');
      document.getElementById('select-theme-dark').classList.remove('active');
      const theme = getPreferredTheme();
      const actualTheme = document.documentElement.getAttribute('data-bs-theme', 'light');
      document.getElementById('select-theme-' + theme).classList.add('active');
      document.getElementById('current-theme').href.baseVal = `#icon-theme-${actualTheme}`;
    };

    function updateTheme(theme) {
      if (theme === 'auto') {
        localStorage.removeItem('theme')
      }
      else {
        localStorage.setItem('theme', theme)
      }
      setTheme(getPreferredTheme());
    }

    setThemeUI();

    const darkModePreference = window.matchMedia("(prefers-color-scheme: dark)");
    darkModePreference.addEventListener("change", e => {
      if (getPreferredTheme() === 'auto') {
        setTheme('auto');
      }
    });

    document.addEventListener("DOMContentLoaded", () => {
      // add prettyprint class to all <pre><code></code></pre> blocks
      let prettify = false;
      document.querySelectorAll('div.post-body pre code').forEach((code) => {
        code.parentNode.classList.add('prettyprint');
        prettify = true;
      });
      prettyPrint();
    });
  </script>

  </body>

<!-- Mirrored from blog.miguelgrinberg.com/post/the-flask-mega-tutorial-part-xviii-deployment-on-heroku-2018/page/9 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 22 Oct 2024 08:48:35 GMT -->
</html>