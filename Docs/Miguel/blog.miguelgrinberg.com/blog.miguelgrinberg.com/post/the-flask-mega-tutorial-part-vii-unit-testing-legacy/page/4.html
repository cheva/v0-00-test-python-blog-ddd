<!doctype html>
<html lang="en">
  
<!-- Mirrored from blog.miguelgrinberg.com/post/the-flask-mega-tutorial-part-vii-unit-testing-legacy/page/4 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 22 Oct 2024 08:50:34 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    
  <script type="text/javascript">
    function getPreferredTheme() {
      const storedTheme = localStorage.getItem('theme')
      if (storedTheme) {
        return storedTheme
      }
      return 'auto';
    }

    function setTheme(theme) {
      if (theme === 'auto') {
        theme = window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light'
      }
      document.documentElement.setAttribute('data-bs-theme', theme);
    };

    setTheme(getPreferredTheme());
  </script>
  
    <title>
  
    The Flask Mega-Tutorial, Part VII: Unit Testing (2012) - miguelgrinberg.com
  
</title>
  
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="description" content="miguelgrinberg.com">
  <meta name="copyright" content="Copyright (c) 2012-2024 Miguel Grinberg">
  <meta name="author" content="Miguel Grinberg">
  
  <meta name="keywords" content="python, programming, flask, web, tutorial, unit, test, testing, unit testing">
  
  
  <link rel="canonical" href="../../the-flask-mega-tutorial-part-vii-unit-testing-legacy.html">
  

  
    <link href="../../../../cdn.jsdelivr.net/npm/bootstrap%405.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
  <link rel="preconnect" href="https://fonts.googleapis.com/">
  <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400&amp;display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@700&amp;display=swap" rel="stylesheet">

  <link href="../../../static/tomorrow.min.css" type="text/css" rel="stylesheet" />
  <link href="../../../static/tomorrow-night.min.css" type="text/css" rel="stylesheet" />
  <link href="../../../static/social.css" rel="stylesheet" type="text/css" />
  <link href="../../../static/style_20231230.css" rel="stylesheet" type="text/css" />

  <link rel="shortcut icon" href="https://blog.miguelgrinberg.com/static/favicon.ico">
  <link rel="alternate" type="application/rss+xml" href="https://blog.miguelgrinberg.com/feed" title="miguelgrinberg.com RSS feed">

    <meta property="og:title" content="The Flask Mega-Tutorial, Part VII: Unit Testing (2012)">
    <meta property="og:description" content="(Great news! There is a new version of this tutorial!)This is the seventh article in the series in which I document my experience writing web applications in Python using the Flask microframework.The…">
    <meta property="og:image" content="https://blog.miguelgrinberg.com/static/cards/the-flask-mega-tutorial-part-vii-unit-testing-legacy.jpg">
    <meta property="og:url" content="https://blog.miguelgrinberg.com/post/the-flask-mega-tutorial-part-vii-unit-testing-legacy">
    <meta name="twitter:title" content="The Flask Mega-Tutorial, Part VII: Unit Testing (2012)">
    <meta name="twitter:description" content="(Great news! There is a new version of this tutorial!)This is the seventh article in the series in which I document my experience writing web applications in Python using the Flask microframework.The…">
    <meta name="twitter:image" content="https://blog.miguelgrinberg.com/static/cards/the-flask-mega-tutorial-part-vii-unit-testing-legacy.jpg">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@miguelgrinberg">

  </head>
  <body>
    <svg style="display: none" version="2.0">
      <defs>
        <symbol id="icon-theme-auto" xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="bi bi-circle-half" viewBox="0 0 16 16">
          <path d="M8 15A7 7 0 1 0 8 1zm0 1A8 8 0 1 1 8 0a8 8 0 0 1 0 16"/>
        </symbol>
        <symbol id="icon-theme-light" xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="bi bi-brightness-high-fill" viewBox="0 0 16 16">
          <path d="M8 11a3 3 0 1 1 0-6 3 3 0 0 1 0 6m0 1a4 4 0 1 0 0-8 4 4 0 0 0 0 8M8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0m0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13m8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5M3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8m10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0m-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707M4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"/>
        </symbol>
        <symbol id="icon-theme-dark" xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="bi bi-moon-stars-fill" viewBox="0 0 16 16">
          <path d="M6 .278a.768.768 0 0 1 .08.858 7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278"/>
          <path d="M10.794 3.148a.217.217 0 0 1 .412 0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217 0 0 1 0 .412l-1.162.387a1.734 1.734 0 0 0-1.097 1.097l-.387 1.162a.217.217 0 0 1-.412 0l-.387-1.162A1.734 1.734 0 0 0 9.31 6.593l-1.162-.387a.217.217 0 0 1 0-.412l1.162-.387a1.734 1.734 0 0 0 1.097-1.097l.387-1.162zM13.863.099a.145.145 0 0 1 .274 0l.258.774c.115.346.386.617.732.732l.774.258a.145.145 0 0 1 0 .274l-.774.258a1.156 1.156 0 0 0-.732.732l-.258.774a.145.145 0 0 1-.274 0l-.258-.774a1.156 1.156 0 0 0-.732-.732l-.774-.258a.145.145 0 0 1 0-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z"/>
        </symbol>
      </defs>
    </svg>
<nav class="navbar navbar-expand-lg">
  <div class="container">
    <a class="navbar-brand" href="https://blog.miguelgrinberg.com/index">miguelgrinberg.com</a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarCollapse">
      <ul class="navbar-nav me-auto">
        <li class="nav-item"><a class="nav-link" aria-current="page" href="https://blog.miguelgrinberg.com/index">Home</a></li>
        <li class="nav-item"><a class="nav-link" aria-current="page" href="../../my-courses-and-books.html">My Courses and Books</a></li>
        <li class="nav-item"><a class="nav-link" aria-current="page" href="../../hire-me.html">Consulting</a></li>
        <li class="nav-item"><a class="nav-link" aria-current="page" href="../../about-me.html">About Me</a></li>
        
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
            <svg width="20" height="20" version="2.0"><use id="current-theme" href="#icon-theme-light"></svg>
          </a>
          <ul class="dropdown-menu">
            <li>
              <a id="select-theme-light" class="dropdown-item" href="javascript:updateTheme('light')">
                <svg width="16" height="16" version="2.0"><use href="#icon-theme-light"></svg>&nbsp; Light Mode
              </a>
            </li>
            <li>
              <a id="select-theme-dark" class="dropdown-item" href="javascript:updateTheme('dark')">
                <svg width="16" height="16" version="2.0"><use href="#icon-theme-dark"></svg>&nbsp; Dark Mode
              </a>
            </li>
            <li><hr class="dropdown-divider"></li>
            <li>
              <a id="select-theme-auto" class="dropdown-item" href="javascript:updateTheme('auto')">
                <svg width="16" height="16" version="2.0"><use href="#icon-theme-auto"></svg>&nbsp; System Default
              </a>
            </li>
          </ul>
        </li>
        
      </ul>
      <ul class="navbar-nav">
        <li class="nav-item social-icons">
          <a type="application/rss+xml" href="https://blog.miguelgrinberg.com/feed"><img src="../../../static/social/rss.png" alt="RSS Feed" title="RSS Feed" /></a>
          <a href="https://twitter.com/miguelgrinberg"><img src="../../../static/social/twitter.png" alt="Twitter" title="Twitter" /></a>
          <a rel="me" href="https://mstdn.social/@miguelgrinberg"><img src="../../../static/social/mastodon.png" alt="Mastodon" title="Mastodon" /></a>
          <a href="http://github.com/miguelgrinberg"><img src="../../../static/social/github.png" alt="GitHub" title="GitHub" /></a>
          <a href="https://youtube.com/miguelgrinberg"><img src="../../../static/social/youtube.png" alt="YouTube" title="YouTube" /></a>
          <a href="http://www.linkedin.com/in/miguelgrinberg"><img src="../../../static/social/linkedin.png" alt="LinkedIn" title="LinkedIn" /></a>
          <a href="https://patreon.com/miguelgrinberg"><img src="../../../static/social/patreon.png" alt="Patreon" title="Patreon" /></a>
          <!--<a href="https://www.facebook.com/miguelgrinbergblog"><img src="/static/social/facebook.png" alt="Facebook" title="Facebook" /></a>-->
        </li>
      </ul>
    </div>
  </div>
</nav>

<div class="container">
  <div class="row">
    <div class="col-md-8">
      <div id="main">
        
        
        
        
        

<div class="post">

<div class="post-header">
  <h1><a href="../../the-flask-mega-tutorial-part-vii-unit-testing-legacy.html">The Flask Mega-Tutorial, Part VII: Unit Testing (2012)</a></h1>
  <h2>
    Posted by
    <form action="https://blog.miguelgrinberg.com/author/Miguel Grinberg" method="POST">
      <input type="submit" class="btn btn-danger btn-sm" value="Miguel Grinberg" />
    </form>
    on
    <button class="btn btn-secondary btn-sm" disabled><span class="flask-moment" data-timestamp="2012-08-01T06:50:31Z" data-function="format" data-format="LL" data-refresh="0" style="display: none">2012-08-01T06:50:31Z</span></button>
    under
    
      <form action="https://blog.miguelgrinberg.com/category/Programming" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Programming" />
      </form>
    
      <form action="https://blog.miguelgrinberg.com/category/Python" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Python" />
      </form>
    
      <form action="https://blog.miguelgrinberg.com/category/Flask" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Flask" />
      </form>
    
    
  </h2>
</div>
<div class="post-body"><p><em>(Great news! There is a <a href="../../the-flask-mega-tutorial-part-i-hello-world.html">new version of this tutorial</a>!)</em></p>
<p>This is the seventh article in the series in which I document my experience writing web applications in <a href="http://python.org/">Python</a> using the <a href="http://flask.pocoo.org/">Flask</a> microframework.</p>
<p>The goal of the tutorial series is to develop a decently featured microblogging application that demonstrating total lack of originality I have decided to call <code>microblog</code>.</p>
<p><strong>NOTE</strong>: This article was revised in September 2014 to be in sync with current versions of Python and Flask.</p>
<p>Here is an index of all the articles in the series that have been published to date:</p>
<ul>
<li><a href="../../the-flask-mega-tutorial-part-i-hello-world-legacy.html">Part I: Hello, World!</a></li>
<li><a href="../../the-flask-mega-tutorial-part-ii-templates-legacy.html">Part II: Templates</a></li>
<li><a href="../../the-flask-mega-tutorial-part-iii-web-forms-legacy.html">Part III: Web Forms</a></li>
<li><a href="../../the-flask-mega-tutorial-part-iv-database-legacy.html">Part IV: Database</a></li>
<li><a href="../../the-flask-mega-tutorial-part-v-user-logins-legacy.html">Part V: User Logins</a></li>
<li><a href="../../the-flask-mega-tutorial-part-vi-profile-page-and-avatars-legacy.html">Part VI: Profile Page And Avatars</a></li>
<li><a href="../../the-flask-mega-tutorial-part-vii-unit-testing-legacy.html">Part VII: Unit Testing</a> (this article)</li>
<li><a href="../../the-flask-mega-tutorial-part-viii-followers-contacts-and-friends-legacy.html">Part VIII: Followers, Contacts And Friends</a></li>
<li><a href="../../the-flask-mega-tutorial-part-ix-pagination-legacy.html">Part IX: Pagination</a></li>
<li><a href="../../the-flask-mega-tutorial-part-x-full-text-search-legacy.html">Part X: Full Text Search</a></li>
<li><a href="../../the-flask-mega-tutorial-part-xi-email-support-legacy.html">Part XI: Email Support</a></li>
<li><a href="../../the-flask-mega-tutorial-part-xii-facelift-legacy.html">Part XII: Facelift</a></li>
<li><a href="../../the-flask-mega-tutorial-part-xiii-dates-and-times-legacy.html">Part XIII: Dates and Times</a></li>
<li><a href="../../the-flask-mega-tutorial-part-xiv-i18n-and-l10n-legacy.html">Part XIV: I18n and L10n</a></li>
<li><a href="../../the-flask-mega-tutorial-part-xv-ajax-legacy.html">Part XV: Ajax</a></li>
<li><a href="../../the-flask-mega-tutorial-part-xvi-debugging-testing-and-profiling-legacy.html">Part XVI: Debugging, Testing and Profiling</a></li>
<li><a href="../../the-flask-mega-tutorial-part-xvii-deployment-on-linux-even-on-the-raspberry-pi-legacy.html">Part XVII: Deployment on Linux (even on the Raspberry Pi!)</a></li>
<li><a href="../../the-flask-mega-tutorial-part-xviii-deployment-on-the-heroku-cloud-legacy.html">Part XVIII: Deployment on the Heroku Cloud</a></li>
</ul>
<h2>Recap</h2>
<p>In the previous chapters of this tutorial we were concentrating in adding functionality to our little application, a step at a time. By now we have a database enabled application that can register users, log them in and out and let them view and edit their profiles.</p>
<p>In this session we are not going to add any new features to our application. Instead, we are going to find ways to add robustness to the code that we have already written, and we will also create a testing framework that will help us prevent failures and regressions in the future.</p>
<h2>Let's find a bug</h2>
<p>I mentioned at the end of the last chapter that I have intentionally introduced a bug in the application. Let me describe what the bug is, then we will use it to see what happens to our application when it does not work as expected.</p>
<p>The problem in the application is that there is no effort to keep the nicknames of our users unique. The initial nickname of a user is chosen automatically by the application. If the OpenID provider provides a nickname for the user then we will just use it. If not we will use the username part of the email address as nickname. If we get two users with the same nickname then the second one will not be able to register. To make matters worse, in the profile edit form we let users change their nicknames to whatever they want, and again there is no effort to avoid name collisions.</p>
<p>We will address these problems later, after we analyze how the application behaves when an error occurs.</p>
<h2>Flask debugging support</h2>
<p>So let's see what happens when we trigger our bug.</p>
<p>Let's start by creating a brand new database. On Linux:</p>
<pre><code>rm app.db
./db_create.py
</code></pre>
<p>or on Windows:</p>
<pre><code>del app.db
flask/Scripts/python db_create.py
</code></pre>
<p>You need two OpenID accounts to reproduce this bug, ideally from different providers, so that their cookies don't make this more complicated. Follow these steps to create a nickname collision:</p>
<ul>
<li>login with your first account</li>
<li>go to the edit profile page and change the nickname to 'dup'</li>
<li>logout</li>
<li>login with your second account</li>
<li>go to the edit profile page and change the nickname to 'dup'</li>
</ul>
<p>Oops! We've got an exception from sqlalchemy. The text of the error reads:</p>
<pre><code>sqlalchemy.exc.IntegrityError
IntegrityError: (IntegrityError) column nickname is not unique u'UPDATE user SET nickname=?, about_me=? WHERE user.id = ?' (u'dup', u'', 2)
</code></pre>
<p>What follows after the error is a <a href="http://en.wikipedia.org/wiki/Stack_trace">stack trace</a> of the error, and actually it is a pretty nice one, where you can go to any frame and inspect source code or even evaluate expressions right in the browser.</p>
<p>The error is pretty clear, we tried to insert a duplicated nickname in the database. The database model had a <code>unique</code> constrain on the <code>nickname</code> field, so this is an invalid operation.</p>
<p>In addition to the actual error, we have a secondary problem in our hands. If a user inadvertently causes an error in our application (this one or any other that causes an exception) it will be him or her that gets the error with the revealing error message and the stack trace, not us. While this is a fantastic feature while we are developing, it is something we definitely do not want our users to ever see.</p>
<p>All this time we have been running our application in <em>debug mode</em>. The debug mode is enabled when the application starts, by passing a <code>debug=True</code> argument to the <code>run</code> method. This is how we coded our <code>run.py</code> start-up script. </p>
<p>When we are developing the application this is convenient, but we need to make sure it is turned off when we run our application in <em>production mode</em>. Let's just create another starter script that runs with debugging disabled (file <code>runp.py</code>):</p>
<pre><code>#!flask/bin/python
from app import app
app.run(debug=False)
</code></pre>
<p>Now restart the application with:</p>
<pre><code>./runp.py
</code></pre>
<p>And now try again to rename the nickname on the second account to 'dup'.</p>
<p>This time we do not get an error. Instead, we get an HTTP error code 500, which is Internal Server Error. Not a great looking error, but at least we are not exposing any details of our application to strangers. The error 500 page is generated by Flask when debugging is off and an unhandled exception occurs.</p>
<p>While this is better, we are now having two new issues. First a cosmetic one: the default error 500 page is ugly. The second problem is much more important. With things as they are we would never know when and if a user experiences a failure in our application because when debugging is turned off application failures are silently dismissed. Luckily there are easy ways to address both problems.</p>
<h2>Custom HTTP error handlers</h2>
<p>Flask provides a mechanism for an application to install its own error pages. As an example, let's define custom error pages for the HTTP errors 404 and 500, the two most common ones. Defining pages for other errors works in the same way.</p>
<p>To declare a custom error handler the <code>errorhandler</code> decorator is used (file <code>app/views.py</code>):</p>
<pre><code>@app.errorhandler(404)
def not_found_error(error):
    return render_template('404.html'), 404

@app.errorhandler(500)
def internal_error(error):
    db.session.rollback()
    return render_template('500.html'), 500
</code></pre>
<p>Not much to talk about for these, as they are almost self-explanatory. The only interesting bit is the <code>rollback</code> statement in the error 500 handler. This is necessary because this function will be called as a result of an exception. If the exception was triggered by a database error then the database session is going to arrive in an invalid state, so we have to roll it back in case a working session is needed for the rendering of the template for the 500 error.</p>
<p>Here is the template for the 404 error:</p>
<pre><code>&lt;!-- extend base layout --&gt;
{% extends "base.html" %}

{% block content %}
  &lt;h1&gt;File Not Found&lt;/h1&gt;
  &lt;p&gt;&lt;a href="{{ url_for('index') }}"&gt;Back&lt;/a&gt;&lt;/p&gt;
{% endblock %}
</code></pre>
<p>And here is the one for the 500 error:</p>
<pre><code>&lt;!-- extend base layout --&gt;
{% extends "base.html" %}

{% block content %}
  &lt;h1&gt;An unexpected error has occurred&lt;/h1&gt;
  &lt;p&gt;The administrator has been notified. Sorry for the inconvenience!&lt;/p&gt;
  &lt;p&gt;&lt;a href="{{ url_for('index') }}"&gt;Back&lt;/a&gt;&lt;/p&gt;
{% endblock %}
</code></pre>
<p>Note that in both cases we continue to use our <code>base.html</code> layout, so that the error page has the look and feel of the application.</p>
<h2>Sending errors via email</h2>
<p>To address our second problem we are going to configure two reporting mechanisms for application errors. The first of them is to have the application send us an email each time an error occurs. </p>
<p>Before we get into this let's configure an email server and an administrator list in our application (file <code>config.py</code>):</p>
<pre><code># mail server settings
MAIL_SERVER = 'localhost'
MAIL_PORT = 25
MAIL_USERNAME = None
MAIL_PASSWORD = None

# administrator list
ADMINS = ['you@example.com']
</code></pre>
<p>Of course it will be up to you to change these to what makes sense.</p>
<p>Flask uses the regular Python <code>logging</code> module, so setting up an email when there is an exception is pretty easy (file <code>app/__init__.py</code>):</p>
<pre><code>from config import basedir, ADMINS, MAIL_SERVER, MAIL_PORT, MAIL_USERNAME, MAIL_PASSWORD

if not app.debug:
    import logging
    from logging.handlers import SMTPHandler
    credentials = None
    if MAIL_USERNAME or MAIL_PASSWORD:
        credentials = (MAIL_USERNAME, MAIL_PASSWORD)
    mail_handler = SMTPHandler((MAIL_SERVER, MAIL_PORT), 'no-reply@' + MAIL_SERVER, ADMINS, 'microblog failure', credentials)
    mail_handler.setLevel(logging.ERROR)
    app.logger.addHandler(mail_handler)
</code></pre>
<p>Note that we are only enabling the emails when we run without debugging.</p>
<p>Testing this on a development PC that does not have an email server is easy, thanks to Python's SMTP debugging server. Just open a new console window (command prompt for Windows users) and run the following to start a fake email server:</p>
<pre><code>python -m smtpd -n -c DebuggingServer localhost:25
</code></pre>
<p>When this is running, the emails sent by the application will be received and displayed in the console window.</p>
<h2>Logging to a file</h2>
<p>Receiving errors via email is nice, but sometimes this isn't enough. There are some failure conditions that do not end in an exception and aren't a major problem, yet we may want to keep track of them in a log in case we need to do some debugging.</p>
<p>For this reason, we are also going to maintain a log file for the application.</p>
<p>Enabling file logging is similar to the email logging (file <code>app/__init__.py</code>):</p>
<pre><code>if not app.debug:
    import logging
    from logging.handlers import RotatingFileHandler
    file_handler = RotatingFileHandler('tmp/microblog.log', 'a', 1 * 1024 * 1024, 10)
    file_handler.setFormatter(logging.Formatter('%(asctime)s %(levelname)s: %(message)s [in %(pathname)s:%(lineno)d]'))
    app.logger.setLevel(logging.INFO)
    file_handler.setLevel(logging.INFO)
    app.logger.addHandler(file_handler)
    app.logger.info('microblog startup')
</code></pre>
<p>The log file will go to our <code>tmp</code> directory, with name <code>microblog.log</code>. We are using the <code>RotatingFileHandler</code> so that there is a limit to the amount of logs that are generated. In this case we are limiting the size of a log file to one megabyte, and we will keep the last ten log files as backups.</p>
<p>The <code>logging.Formatter</code> class provides custom formatting for the log messages. Since these messages are going to a file, we want them to have as much information as possible, so we write a timestamp, the logging level and the file and line number where the message originated in addition to the log message and the stack trace.</p>
<p>To make the logging more useful, we are lowering the logging level, both in the app logger and the file logger handler, as this will give us the opportunity to write useful messages to the log without having to call them errors. As an example, we start by logging the application start up as an informational level. From now on, each time you start the application without debugging the log will record the event.</p>
<p>While we don't have a lot of need for a logger at this time, debugging a web server that is online and in use is very difficult. Logging messages to a file is an extremely useful tool in diagnosing and locating issues, so we are now all ready to go should we need to use this feature.</p>
<h2>The bug fix</h2>
<p>Let's fix our <code>nickname</code> duplication bug.</p>
<p>As discussed earlier, there are two places that are currently not handling duplicates. The first is in the <code>after_login</code> handler for Flask-Login. This is called when a user successfully logs in to the system and we need to create a new User instance. Here is the affected snippet of code, with the fix in it (file <code>app/views.py</code>):</p>
<pre><code>    if user is None:
        nickname = resp.nickname
        if nickname is None or nickname == "":
            nickname = resp.email.split('@')[0]
        nickname = User.make_unique_nickname(nickname)
        user = User(nickname = nickname, email = resp.email)
        db.session.add(user)
        db.session.commit()
</code></pre>
<p>The way we solve the problem is by letting the User class pick a unique name for us. This is what the new <code>make_unique_nickname</code> method does (file <code>app/models.py</code>):</p>
<pre><code>    class User(db.Model):
    # ...
    @staticmethod
    def make_unique_nickname(nickname):
        if User.query.filter_by(nickname=nickname).first() is None:
            return nickname
        version = 2
        while True:
            new_nickname = nickname + str(version)
            if User.query.filter_by(nickname=new_nickname).first() is None:
                break
            version += 1
        return new_nickname
    # ...
</code></pre>
<p>This method simply adds a counter to the requested nickname until a unique name is found. For example, if the username "miguel" exists, the method will suggest "miguel2", but if that also exists it will go to "miguel3" and so on. Note that we coded the method as a <a href="http://docs.python.org/library/functions.html#staticmethod">static method</a>, since it this operation does not apply to any particular instance of the class.</p>
<p>The second place where we have problems with duplicate nicknames is the view function for the edit profile page. This one is a little tricker to handle, because it is the user choosing the nickname. The correct thing to do here is to not accept a duplicated nickname and let the user enter another one. We will address this by adding custom validation to the nickname form field. If the user enters an invalid nickname we'll just fail the validation for the field, and that will send the user back to the edit profile page. To add our validation we just override the form's <code>validate</code> method (file <code>app/forms.py</code>):</p>
<pre><code>from app.models import User

class EditForm(Form):
    nickname = StringField('nickname', validators=[DataRequired()])
    about_me = TextAreaField('about_me', validators=[Length(min=0, max=140)])

    def __init__(self, original_nickname, *args, **kwargs):
        Form.__init__(self, *args, **kwargs)
        self.original_nickname = original_nickname

    def validate(self):
        if not Form.validate(self):
            return False
        if self.nickname.data == self.original_nickname:
            return True
        user = User.query.filter_by(nickname=self.nickname.data).first()
        if user != None:
            self.nickname.errors.append('This nickname is already in use. Please choose another one.')
            return False
        return True
</code></pre>
<p>The form constructor now takes a new argument <code>original_nickname</code>. The <code>validate</code> method uses it to determine if the nickname has changed or not. If it hasn't changed then it accepts it. If it has changed, then it makes sure the new nickname does not exist in the database.</p>
<p>Next we add the new constructor argument to the view function:</p>
<pre><code>@app.route('/edit', methods=['GET', 'POST'])
@login_required
def edit():
    form = EditForm(g.user.nickname)
    # ...
</code></pre>
<p>To complete this change we have to enable field errors to show in our template for the form (file <code>app/templates/edit.html</code>):</p>
<pre><code>        &lt;td&gt;Your nickname:&lt;/td&gt;
        &lt;td&gt;
            {{ form.nickname(size=24) }}
            {% for error in form.errors.nickname %}
            &lt;br&gt;&lt;span style="color: red;"&gt;[{{ error }}]&lt;/span&gt;
            {% endfor %}
        &lt;/td&gt;
</code></pre>
<p>Now the bug is fixed and duplicates will be prevented... except when they are not. We still have a potential problem with concurrent access to the database by two or more threads or processes, but this will be the topic of a future article.</p>
<p>At this point you can try again to select a duplicated name to see how the form nicely handles the error.</p>
<h2>Unit testing framework</h2>
<p>To close this session on testing, let's talk about automated testing a bit.</p>
<p>As the application grows in size it gets more and more difficult to ensure that code changes don't break existing functionality.</p>
<p>The traditional approach to prevent regressions is a very good one. You write tests that exercise all the different features of the application. Each test runs a focused part and verifies that the result obtained is the expected one. The tests are executed periodically to make sure that the application works as expected. When the test <em>coverage</em> is large you can have confidence that modifications and additions do not affect the application in a bad way just by running the tests.</p>
<p>We will now build a very simple testing framework using Python's <code>unittest</code> module (file <code>tests.py</code>):</p>
<pre><code>#!flask/bin/python
import os
import unittest

from config import basedir
from app import app, db
from app.models import User

class TestCase(unittest.TestCase):
    def setUp(self):
        app.config['TESTING'] = True
        app.config['WTF_CSRF_ENABLED'] = False
        app.config['SQLALCHEMY_DATABASE_URI'] = 'sqlite:///' + os.path.join(basedir, 'test.db')
        self.app = app.test_client()
        db.create_all()

    def tearDown(self):
        db.session.remove()
        db.drop_all()

    def test_avatar(self):
        u = User(nickname='john', email='john@example.com')
        avatar = u.avatar(128)
        expected = 'http://www.gravatar.com/avatar/d4c74594d841139328695756648b6bd6'
        assert avatar[0:len(expected)] == expected

    def test_make_unique_nickname(self):
        u = User(nickname='john', email='john@example.com')
        db.session.add(u)
        db.session.commit()
        nickname = User.make_unique_nickname('john')
        assert nickname != 'john'
        u = User(nickname=nickname, email='susan@example.com')
        db.session.add(u)
        db.session.commit()
        nickname2 = User.make_unique_nickname('john')
        assert nickname2 != 'john'
        assert nickname2 != nickname

if __name__ == '__main__':
    unittest.main()
</code></pre>
<p>Discussing the <code>unittest</code> module is outside the scope of this article. Let's just say that class <code>TestCase</code> holds our tests. The <code>setUp</code> and <code>tearDown</code> methods are special, these are run before and after each test respectively. A more complex setup could include several groups of tests each represented by a <code>unittest.TestCase</code> subclass, and each group then would have independent <code>setUp</code> and <code>tearDown</code> methods. </p>
<p>These particular <code>setUp</code> and <code>tearDown</code> methods are pretty generic. In <code>setUp</code> the configuration is edited a bit. For instance, we want the testing database to be different that the main database. In <code>tearDown</code> we just reset the database contents.</p>
<p>Tests are implemented as methods. A test is supposed to run some function of the application that has a known outcome, and should assert if the result is different than the expected one.</p>
<p>So far we have two tests in the testing framework. The first one verifies that the Gravatar avatar URLs from the previous article are generated correctly. Note how the expected avatar is hardcoded in the test and checked against the one returned by the <code>User</code> class.</p>
<p>The second test verifies the <code>make_unique_nickname</code> method we just wrote, also in the <code>User</code> class. This test is a bit more elaborate, it creates a new user and writes it to the database, then ensures the same name is not allowed as a unique name. It then creates a second user with the suggested unique name and tries one more time to request the first nickname. The expected result for this second part is to get a suggested nickname that is different from the previous two.</p>
<p>To run the test suite you just run the <code>tests.py</code> script. On Linux or Mac:</p>
<pre><code>./tests.py
</code></pre>
<p>And on Windows:</p>
<pre><code>flask/Scripts/python tests.py
</code></pre>
<p>If there are any errors, you will get a report in the console.</p>
<h2>Final words</h2>
<p>This ends today's discussion of debugging, errors and testing. I hope you found this article useful.</p>
<p>As always, if you have any comments please write below.</p>
<p>The code of the microblog application update with today's changes is available below for download:</p>
<p>Download <a href="https://github.com/miguelgrinberg/microblog-2012/archive/version-0.7.zip">microblog-0.7.zip</a>.</p>
<p>As always, the flask virtual environment and the database are not included. See previous articles for instructions on how to generate them.</p>
<p>I hope to see you again in the next installment of this series.</p>
<p>Thank you for reading!</p>
<p>Miguel</p></div>

<div class="card patreon-bar">
  <div class="card-body">
    <h5>Become a Patron!</h5>
    <p class="card-text">Hello, and thank you for visiting my blog! If you enjoyed this article, please consider supporting my work on this blog on <a href="https://patreon.com/miguelgrinberg">Patreon</a>!</p>
    <a href="https://patreon.com/miguelgrinberg" alt="Become a Patron!" title="Become a Patron!"><img src="../../../static/patreon-button.png"></a>
  </div>
</div>


<div class="card social-bar">
  <div class="card-body">
    <h5>Share this post:</h5>
      <!-- Sharingbutton Hacker News -->
      <a class="resp-sharing-button__link" href="https://news.ycombinator.com/submitlink?u=https%3A//blog.miguelgrinberg.com/post/the-flask-mega-tutorial-part-vii-unit-testing-legacy&amp;t=The%20Flask%20Mega-Tutorial%2C%20Part%20VII%3A%20Unit%20Testing%20%282012%29" target="_blank" rel="noopener" aria-label="Hacker News">
        <div class="resp-sharing-button resp-sharing-button--hackernews resp-sharing-button--medium"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 140 140"><path fill-rule="evenodd" d="M60.94 82.314L17 0h20.08l25.85 52.093c.397.927.86 1.888 1.39 2.883.53.994.995 2.02 1.393 3.08.265.4.463.764.596 1.095.13.334.262.63.395.898.662 1.325 1.26 2.618 1.79 3.877.53 1.26.993 2.42 1.39 3.48 1.06-2.254 2.22-4.673 3.48-7.258 1.26-2.585 2.552-5.27 3.877-8.052L103.49 0h18.69L77.84 83.308v53.087h-16.9v-54.08z"></path></svg></div>Hacker News</div>
      </a>

      <!-- Sharingbutton Reddit -->
      <a class="resp-sharing-button__link" href="https://reddit.com/submit/?url=https%3A//blog.miguelgrinberg.com/post/the-flask-mega-tutorial-part-vii-unit-testing-legacy&amp;resubmit=true&amp;title=The%20Flask%20Mega-Tutorial,%20Part%20VII:%20Unit%20Testing%20(2012)" target="_blank" rel="noopener" aria-label="Reddit">
        <div class="resp-sharing-button resp-sharing-button--reddit resp-sharing-button--medium"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M24 11.5c0-1.65-1.35-3-3-3-.96 0-1.86.48-2.42 1.24-1.64-1-3.75-1.64-6.07-1.72.08-1.1.4-3.05 1.52-3.7.72-.4 1.73-.24 3 .5C17.2 6.3 18.46 7.5 20 7.5c1.65 0 3-1.35 3-3s-1.35-3-3-3c-1.38 0-2.54.94-2.88 2.22-1.43-.72-2.64-.8-3.6-.25-1.64.94-1.95 3.47-2 4.55-2.33.08-4.45.7-6.1 1.72C4.86 8.98 3.96 8.5 3 8.5c-1.65 0-3 1.35-3 3 0 1.32.84 2.44 2.05 2.84-.03.22-.05.44-.05.66 0 3.86 4.5 7 10 7s10-3.14 10-7c0-.22-.02-.44-.05-.66 1.2-.4 2.05-1.54 2.05-2.84zM2.3 13.37C1.5 13.07 1 12.35 1 11.5c0-1.1.9-2 2-2 .64 0 1.22.32 1.6.82-1.1.85-1.92 1.9-2.3 3.05zm3.7.13c0-1.1.9-2 2-2s2 .9 2 2-.9 2-2 2-2-.9-2-2zm9.8 4.8c-1.08.63-2.42.96-3.8.96-1.4 0-2.74-.34-3.8-.95-.24-.13-.32-.44-.2-.68.15-.24.46-.32.7-.18 1.83 1.06 4.76 1.06 6.6 0 .23-.13.53-.05.67.2.14.23.06.54-.18.67zm.2-2.8c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm5.7-2.13c-.38-1.16-1.2-2.2-2.3-3.05.38-.5.97-.82 1.6-.82 1.1 0 2 .9 2 2 0 .84-.53 1.57-1.3 1.87z"/></svg></div>Reddit</div>
      </a>

      <!-- Sharingbutton Twitter -->
      <a class="resp-sharing-button__link" href="https://twitter.com/intent/tweet/?text=The%20Flask%20Mega-Tutorial%2C%20Part%20VII%3A%20Unit%20Testing%20%282012%29&amp;url=https%3A//blog.miguelgrinberg.com/post/the-flask-mega-tutorial-part-vii-unit-testing-legacy" target="_blank" rel="noopener" aria-label="Twitter">
        <div class="resp-sharing-button resp-sharing-button--twitter resp-sharing-button--medium"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M23.44 4.83c-.8.37-1.5.38-2.22.02.93-.56.98-.96 1.32-2.02-.88.52-1.86.9-2.9 1.1-.82-.88-2-1.43-3.3-1.43-2.5 0-4.55 2.04-4.55 4.54 0 .36.03.7.1 1.04-3.77-.2-7.12-2-9.36-4.75-.4.67-.6 1.45-.6 2.3 0 1.56.8 2.95 2 3.77-.74-.03-1.44-.23-2.05-.57v.06c0 2.2 1.56 4.03 3.64 4.44-.67.2-1.37.2-2.06.08.58 1.8 2.26 3.12 4.25 3.16C5.78 18.1 3.37 18.74 1 18.46c2 1.3 4.4 2.04 6.97 2.04 8.35 0 12.92-6.92 12.92-12.93 0-.2 0-.4-.02-.6.9-.63 1.96-1.22 2.56-2.14z"/></svg></div>Twitter</div>
      </a>

      <!-- Sharingbutton LinkedIn -->
      <a class="resp-sharing-button__link" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3A//blog.miguelgrinberg.com/post/the-flask-mega-tutorial-part-vii-unit-testing-legacy&amp;title=The%20Flask%20Mega-Tutorial%2C%20Part%20VII%3A%20Unit%20Testing%20%282012%29&amp;summary=The%20Flask%20Mega-Tutorial%2C%20Part%20VII%3A%20Unit%20Testing%20%282012%29&amp;source=https%3A//blog.miguelgrinberg.com/post/the-flask-mega-tutorial-part-vii-unit-testing-legacy" target="_blank" rel="noopener" aria-label="LinkedIn">
        <div class="resp-sharing-button resp-sharing-button--linkedin resp-sharing-button--medium"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M6.5 21.5h-5v-13h5v13zM4 6.5C2.5 6.5 1.5 5.3 1.5 4s1-2.4 2.5-2.4c1.6 0 2.5 1 2.6 2.5 0 1.4-1 2.5-2.6 2.5zm11.5 6c-1 0-2 1-2 2v7h-5v-13h5V10s1.6-1.5 4-1.5c3 0 5 2.2 5 6.3v6.7h-5v-7c0-1-1-2-2-2z"/></svg></div>LinkedIn</div>
      </a>

      <!-- Sharingbutton Facebook -->
      <a class="resp-sharing-button__link" href="https://facebook.com/sharer/sharer.php?u=https%3A//blog.miguelgrinberg.com/post/the-flask-mega-tutorial-part-vii-unit-testing-legacy" target="_blank" rel="noopener" aria-label="Facebook">
        <div class="resp-sharing-button resp-sharing-button--facebook resp-sharing-button--medium"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18.77 7.46H14.5v-1.9c0-.9.6-1.1 1-1.1h3V.5h-4.33C10.24.5 9.5 3.44 9.5 5.32v2.15h-3v4h3v12h5v-12h3.85l.42-4z"/></svg></div>Facebook</div>
      </a>

      <!-- Sharingbutton E-Mail -->
      <a class="resp-sharing-button__link" href="mailto:?subject=The%20Flask%20Mega-Tutorial%2C%20Part%20VII%3A%20Unit%20Testing%20%282012%29&amp;body=https%3A//blog.miguelgrinberg.com/post/the-flask-mega-tutorial-part-vii-unit-testing-legacy" target="_self" rel="noopener" aria-label="E-Mail">
        <div class="resp-sharing-button resp-sharing-button--email resp-sharing-button--medium"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M22 4H2C.9 4 0 4.9 0 6v12c0 1.1.9 2 2 2h20c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zM7.25 14.43l-3.5 2c-.08.05-.17.07-.25.07-.17 0-.34-.1-.43-.25-.14-.24-.06-.55.18-.68l3.5-2c.24-.14.55-.06.68.18.14.24.06.55-.18.68zm4.75.07c-.1 0-.2-.03-.27-.08l-8.5-5.5c-.23-.15-.3-.46-.15-.7.15-.22.46-.3.7-.14L12 13.4l8.23-5.32c.23-.15.54-.08.7.15.14.23.07.54-.16.7l-8.5 5.5c-.08.04-.17.07-.27.07zm8.93 1.75c-.1.16-.26.25-.43.25-.08 0-.17-.02-.25-.07l-3.5-2c-.24-.13-.32-.44-.18-.68s.44-.32.68-.18l3.5 2c.24.13.32.44.18.68z"/></svg></div>E-Mail</div>
      </a>

  </div>
</div>

<div id="comments" class="post-comment-count">
  
  <a class="btn btn-outline-secondary" href="../../the-flask-mega-tutorial-part-vii-unit-testing-legacy.html#comments">113 comments</a>
  
</div>


<div class="comments">
  <ul>
    
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/729e26a2a2c7ff24a71958d4aa4e5f35?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#76</span> <span class="badge text-bg-danger">Miguel Grinberg</span> said
    
    <span class="flask-moment" data-timestamp="2015-02-27T15:42:02Z" data-function="fromNow" data-refresh="0" style="display: none">2015-02-27T15:42:02Z</span>
  </p>
  <div>
    <p>@Nadav: sorry, I updated the article to say that you should run with "python <a href="http://tests.py/" rel="nofollow">tests.py</a>". You can also set this file as executable by running "chmod +x <a href="http://tests.py/" rel="nofollow">tests.py</a>", and then you can run it as I indicated originally: "./<a href="http://tests.py/" rel="nofollow">tests.py</a>".</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/0d7a5df8ae6c7d197721b263657528d6?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#77</span> <span class="badge text-bg-warning">Yang</span> said
    
    <span class="flask-moment" data-timestamp="2015-03-18T20:46:24Z" data-function="fromNow" data-refresh="0" style="display: none">2015-03-18T20:46:24Z</span>
  </p>
  <div>
    <p>Miguel, a minor error is that TextField in the EditForm should be StringField. I got undefined error when using TextField, your zip file is using StringField, but webpage uses TextField.</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/729e26a2a2c7ff24a71958d4aa4e5f35?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#78</span> <span class="badge text-bg-danger">Miguel Grinberg</span> said
    
    <span class="flask-moment" data-timestamp="2015-03-19T04:53:13Z" data-function="fromNow" data-refresh="0" style="display: none">2015-03-19T04:53:13Z</span>
  </p>
  <div>
    <p>@Yang: ah yes, the TextField name was deprecated and now has been removed. I updated the article, thanks for letting me know.</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/7cfd2cf88c97f59049263faaad61b8af?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#79</span> <span class="badge text-bg-warning">John</span> said
    
    <span class="flask-moment" data-timestamp="2015-04-26T13:40:34Z" data-function="fromNow" data-refresh="0" style="display: none">2015-04-26T13:40:34Z</span>
  </p>
  <div>
    <p>Hello Miguel, sorry to bother you again, it is a so great tutorial that I can't quit :)<br>
I don't understand some code in this chapter about validating:<br>
 def validate(self):<br>
        if not Form.validate(self):<br>
            return False<br>
        if self.nickname.data == self.original_nickname:<br>
            return True<br>
        user = User.query.filter_by(nickname=self.nickname.data).first()<br>
        if user != None:<br>
            self.nickname.errors.append('This nickname is already in use. Please choose another one.')<br>
            return False<br>
        return True<br>
So what is the first two lines of this function means?  &lt;if not Form.validate(self):   return False&gt;<br>
It seems that they don't do anything directly to the validating.</p>
<p>And also, there is another thing confusing me.<br>
We can validate data in the xForm classes, and in the <a href="http://views.py/" rel="nofollow">views.py</a>.<br>
But what is the better choice?</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/729e26a2a2c7ff24a71958d4aa4e5f35?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#80</span> <span class="badge text-bg-danger">Miguel Grinberg</span> said
    
    <span class="flask-moment" data-timestamp="2015-04-26T16:22:28Z" data-function="fromNow" data-refresh="0" style="display: none">2015-04-26T16:22:28Z</span>
  </p>
  <div>
    <p>@John: Those first two lines invoke the validate() method in the super class, which is class Form. I should have done this in a more Pythonic way, which would be:</p>
<pre><code>if not super(EditForm, self).validate():
    return False
</code></pre>
<p>This is necessary because the Form.validate() method is the one that invokes all the form validators attached to form fields.</p>
<blockquote>
<p>We can validate data in the xForm classes, and in the <a href="http://views.py/" rel="nofollow">views.py</a></p>
</blockquote>
<p>The more you move away from the view functions the better, in my opinion. Validation code is confusing to look at, you don't want it mixed with the high level code that you work with most frequently.</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/7cfd2cf88c97f59049263faaad61b8af?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#81</span> <span class="badge text-bg-warning">John</span> said
    
    <span class="flask-moment" data-timestamp="2015-04-27T04:00:02Z" data-function="fromNow" data-refresh="0" style="display: none">2015-04-27T04:00:02Z</span>
  </p>
  <div>
    <p>@Miguel Grinberg Ok, I think I understand that now. Since there are already validations in Form, the better choice is to keep them together.</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/a5669d153bab6217e6800e256a14536a?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#82</span> <span class="badge text-bg-warning">Max Whitney</span> said
    
    <span class="flask-moment" data-timestamp="2015-06-13T21:26:24Z" data-function="fromNow" data-refresh="0" style="display: none">2015-06-13T21:26:24Z</span>
  </p>
  <div>
    <p>Thanks so much for this awesome tutorial. </p>
<p>Having worked through the chapters one at a time, I ended up migrating my database multiple times before reaching this step. When I removed app.db, but not the db_repository, calling <a href="http://db_create.py/" rel="nofollow">db_create.py</a> generated an error:</p>
<p>mine:microblog me$ ./<a href="http://db_create.py/" rel="nofollow">db_create.py</a> <br>
Traceback (most recent call last):<br>
  File "./<a href="http://db_create.py/" rel="nofollow">db_create.py</a>", line 12, in &lt;module&gt;<br>
    api.version_control(SQLALCHEMY_MIGRATE_REPO, SQLALCHEMY_DATABASE_URI, api.version(SQLALCHEMY_MIGRATE_REPO))<br>
  File "&lt;string&gt;", line 2, in version_control<br>
  File "/Users/me/microblog/flask/lib/python3.4/site-packages/migrate/versioning/util/<strong>init</strong>.py", line 156, in with_engine<br>
    engine = construct_engine(url, <strong>kw)<br>
  File "/Users/me/microblog/flask/lib/python3.4/site-packages/migrate/versioning/util/<strong>init</strong>.py", line 141, in construct_engine<br>
    return create_engine(engine, </strong>kwargs)<br>
  File "/Users/me/microblog/flask/lib/python3.4/site-packages/sqlalchemy/engine/<strong>init</strong>.py", line 386, in create_engine<br>
    return strategy.create(<em>args, </em>*kwargs)<br>
  File "/Users/me/microblog/flask/lib/python3.4/site-packages/sqlalchemy/engine/<a href="http://strategies.py/" rel="nofollow">strategies.py</a>", line 49, in create<br>
    u = url.make_url(name_or_url)<br>
  File "/Users/me/microblog/flask/lib/python3.4/site-packages/sqlalchemy/engine/<a href="http://url.py/" rel="nofollow">url.py</a>", line 176, in make_url<br>
    return _parse_rfc1738_args(name_or_url)<br>
  File "/Users/me/microblog/flask/lib/python3.4/site-packages/sqlalchemy/engine/<a href="http://url.py/" rel="nofollow">url.py</a>", line 225, in _parse_rfc1738_args<br>
    "Could not parse rfc1738 URL from string '%s'" % name)<br>
sqlalchemy.exc.ArgumentError: Could not parse rfc1738 URL from string '/Users/me/microblog/db_repository'<br>
 </p>
<p>Deleting the db_repository directory was sufficient to correct the error and allow me to recreate the database from scratch.</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/7a2336a2e10c2e3e145a3c3892969054?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#83</span> <span class="badge text-bg-warning">Selim</span> said
    
    <span class="flask-moment" data-timestamp="2015-08-21T04:10:14Z" data-function="fromNow" data-refresh="0" style="display: none">2015-08-21T04:10:14Z</span>
  </p>
  <div>
    <p>Hello, thanks a lot for the tutorials. </p>
<p>You say to run the tests with the command: python <a href="http://tests.py/" rel="nofollow">tests.py</a></p>
<p>However, you explicitly mention at the beginning of the tutorial that you don't activate the virtualenv, which is why you put that shebang at the top of <a href="http://tests.py/" rel="nofollow">tests.py</a></p>
<p>Consequently, the command should be: ./<a href="http://tests.py/" rel="nofollow">tests.py</a></p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/89fbe3bf3a71de6c32c34adb65059e5e?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#84</span> <span class="badge text-bg-danger">Miguel Grinberg</span> said
    
    <span class="flask-moment" data-timestamp="2015-08-21T04:37:28Z" data-function="fromNow" data-refresh="0" style="display: none">2015-08-21T04:37:28Z</span>
  </p>
  <div>
    <p>@Selim: Thanks, updated the article.</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/e91cfc6a51a51e7a26c25329567b2409?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#85</span> <span class="badge text-bg-warning">Divyansh</span> said
    
    <span class="flask-moment" data-timestamp="2015-10-27T20:18:28Z" data-function="fromNow" data-refresh="0" style="display: none">2015-10-27T20:18:28Z</span>
  </p>
  <div>
    <p>Thank You for this brilliant tutrorial. <br>
I am trying to run the system testing framework, but <a href="http://tests.py/" rel="nofollow">tests.py</a> seems to be executing perfectly even when I remove the code for checking duplicacy of usernames from <a href="http://forms.py/" rel="nofollow">forms.py</a> and <a href="http://views.py/" rel="nofollow">views.py</a>.<br>
Shouldn't <a href="http://tests.py/" rel="nofollow">tests.py</a> raise an assertion error in this case?</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/3bfc1d23dd6bc56c5b6d06d262735aa2?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#86</span> <span class="badge text-bg-warning">Rafeh Qazi</span> said
    
    <span class="flask-moment" data-timestamp="2015-10-30T15:30:25Z" data-function="fromNow" data-refresh="0" style="display: none">2015-10-30T15:30:25Z</span>
  </p>
  <div>
    <p>I just wanted to drop by and say thank you!</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/89fbe3bf3a71de6c32c34adb65059e5e?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#87</span> <span class="badge text-bg-danger">Miguel Grinberg</span> said
    
    <span class="flask-moment" data-timestamp="2015-11-01T06:04:22Z" data-function="fromNow" data-refresh="0" style="display: none">2015-11-01T06:04:22Z</span>
  </p>
  <div>
    <p>@Divyansh: you would need to add a test that specifically tries to create duplicated users to see a failure. None of the tests do that.</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/9a43ee094beb42a37ba16e67a1f48224?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#88</span> <span class="badge text-bg-warning">sai chandu</span> said
    
    <span class="flask-moment" data-timestamp="2015-12-08T06:57:19Z" data-function="fromNow" data-refresh="0" style="display: none">2015-12-08T06:57:19Z</span>
  </p>
  <div>
    <p>while db.session.commit() im getting dis error can u please rectify it, where i was exactly wrong..</p>
<blockquote>
<blockquote>
<blockquote>
<p>from app import db, models<br>
u=models.User(nickname="sai", email="sauc34@gmail.com")<br>
db.session.add(u)<br>
db.session.commit()<br>
Traceback (most recent call last):<br>
  File "D:\microblog\flask\lib\site-packages\sqlalchemy\engine\<a href="http://base.py/" rel="nofollow">base.py</a>", line 1139, in _execute_context<br>
    context)<br>
  File "D:\microblog\flask\lib\site-packages\sqlalchemy\engine\<a href="http://default.py/" rel="nofollow">default.py</a>", line 450, in do_execute<br>
    cursor.execute(statement, parameters)<br>
sqlite3.IntegrityError: UNIQUE constraint failed: user.nickname</p>
</blockquote>
</blockquote>
</blockquote>
<p>The above exception was the direct cause of the following exception:</p>
<p>Traceback (most recent call last):<br>
  File "&lt;stdin&gt;", line 1, in &lt;module&gt;<br>
  File "D:\microblog\flask\lib\site-packages\sqlalchemy\orm\<a href="http://scoping.py/" rel="nofollow">scoping.py</a>", line 150, in do<br>
    return getattr(self.registry(), name)(<em>args, </em>*kwargs)<br>
  File "D:\microblog\flask\lib\site-packages\sqlalchemy\orm\<a href="http://session.py/" rel="nofollow">session.py</a>", line 801, in commit<br>
    self.transaction.commit()<br>
  File "D:\microblog\flask\lib\site-packages\sqlalchemy\orm\<a href="http://session.py/" rel="nofollow">session.py</a>", line 392, in commit<br>
    self._prepare_impl()<br>
  File "D:\microblog\flask\lib\site-packages\sqlalchemy\orm\<a href="http://session.py/" rel="nofollow">session.py</a>", line 372, in _prepare_impl<br>
    self.session.flush()<br>
  File "D:\microblog\flask\lib\site-packages\sqlalchemy\orm\<a href="http://session.py/" rel="nofollow">session.py</a>", line 2015, in flush<br>
    self._flush(objects)<br>
  File "D:\microblog\flask\lib\site-packages\sqlalchemy\orm\<a href="http://session.py/" rel="nofollow">session.py</a>", line 2133, in _flush<br>
    transaction.rollback(_capture_exception=True)<br>
  File "D:\microblog\flask\lib\site-packages\sqlalchemy\util\<a href="http://langhelpers.py/" rel="nofollow">langhelpers.py</a>", line 60, in <strong>exit</strong><br>
    compat.reraise(exc_type, exc_value, exc_tb)<br>
  File "D:\microblog\flask\lib\site-packages\sqlalchemy\util\<a href="http://compat.py/" rel="nofollow">compat.py</a>", line 182, in reraise<br>
    raise value<br>
  File "D:\microblog\flask\lib\site-packages\sqlalchemy\orm\<a href="http://session.py/" rel="nofollow">session.py</a>", line 2097, in _flush<br>
    flush_context.execute()<br>
  File "D:\microblog\flask\lib\site-packages\sqlalchemy\orm\<a href="http://unitofwork.py/" rel="nofollow">unitofwork.py</a>", line 373, in execute<br>
    rec.execute(self)<br>
  File "D:\microblog\flask\lib\site-packages\sqlalchemy\orm\<a href="http://unitofwork.py/" rel="nofollow">unitofwork.py</a>", line 532, in execute<br>
    uow<br>
  File "D:\microblog\flask\lib\site-packages\sqlalchemy\orm\<a href="http://persistence.py/" rel="nofollow">persistence.py</a>", line 174, in save_obj<br>
    mapper, table, insert)<br>
  File "D:\microblog\flask\lib\site-packages\sqlalchemy\orm\<a href="http://persistence.py/" rel="nofollow">persistence.py</a>", line 785, in _emit_insert_statements<br>
    execute(statement, params)<br>
  File "D:\microblog\flask\lib\site-packages\sqlalchemy\engine\<a href="http://base.py/" rel="nofollow">base.py</a>", line 914, in execute<br>
    return meth(self, multiparams, params)<br>
  File "D:\microblog\flask\lib\site-packages\sqlalchemy\sql\<a href="http://elements.py/" rel="nofollow">elements.py</a>", line 323, in _execute_on_connection<br>
    return connection._execute_clauseelement(self, multiparams, params)<br>
  File "D:\microblog\flask\lib\site-packages\sqlalchemy\engine\<a href="http://base.py/" rel="nofollow">base.py</a>", line 1010, in _execute_clauseelement<br>
    compiled_sql, distilled_params<br>
  File "D:\microblog\flask\lib\site-packages\sqlalchemy\engine\<a href="http://base.py/" rel="nofollow">base.py</a>", line 1146, in _execute_context<br>
    context)<br>
  File "D:\microblog\flask\lib\site-packages\sqlalchemy\engine\<a href="http://base.py/" rel="nofollow">base.py</a>", line 1341, in _handle_dbapi_exception<br>
    exc_info<br>
  File "D:\microblog\flask\lib\site-packages\sqlalchemy\util\<a href="http://compat.py/" rel="nofollow">compat.py</a>", line 188, in raise_from_cause<br>
    reraise(type(exception), exception, tb=exc_tb, cause=exc_value)<br>
  File "D:\microblog\flask\lib\site-packages\sqlalchemy\util\<a href="http://compat.py/" rel="nofollow">compat.py</a>", line 181, in reraise<br>
    raise value.with_traceback(tb)<br>
  File "D:\microblog\flask\lib\site-packages\sqlalchemy\engine\<a href="http://base.py/" rel="nofollow">base.py</a>", line 1139, in _execute_context<br>
    context)<br>
  File "D:\microblog\flask\lib\site-packages\sqlalchemy\engine\<a href="http://default.py/" rel="nofollow">default.py</a>", line 450, in do_execute<br>
    cursor.execute(statement, parameters)<br>
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: user.nickname [SQL: 'INSERT INTO user<br>
(nickname, email) VALUES (?, ?)'] [parameters: ('sai', 'sauc34@gmail.com')]</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/89fbe3bf3a71de6c32c34adb65059e5e?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#89</span> <span class="badge text-bg-danger">Miguel Grinberg</span> said
    
    <span class="flask-moment" data-timestamp="2015-12-10T18:00:06Z" data-function="fromNow" data-refresh="0" style="display: none">2015-12-10T18:00:06Z</span>
  </p>
  <div>
    <p>@sai: the error is pretty clear. You are trying to add a row to your user table using a nickname that already exists. The table is set up to not allow duplicated nicknames.</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/6bbb9b3baf8440bc7a00e3147378bcf2?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#90</span> <span class="badge text-bg-warning">cescocesco</span> said
    
    <span class="flask-moment" data-timestamp="2016-01-15T23:04:53Z" data-function="fromNow" data-refresh="0" style="display: none">2016-01-15T23:04:53Z</span>
  </p>
  <div>
    <p>Is there a way to call a function if all test have passed? I was thinking about using Jenkins but it looks overkill to my use case. I just want to call an Ansible role if all my tests have passed.</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/89fbe3bf3a71de6c32c34adb65059e5e?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#91</span> <span class="badge text-bg-danger">Miguel Grinberg</span> said
    
    <span class="flask-moment" data-timestamp="2016-01-16T22:59:45Z" data-function="fromNow" data-refresh="0" style="display: none">2016-01-16T22:59:45Z</span>
  </p>
  <div>
    <p>@cescocesco: the unit test application will return an exit code of 0 if all tests passed, or non-zero if there were failures. You can use that to integrate with other tools.</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/1b5b1585b6a5c9bad7a1d843cbb8505c?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#92</span> <span class="badge text-bg-warning">windery</span> said
    
    <span class="flask-moment" data-timestamp="2016-02-21T11:40:35Z" data-function="fromNow" data-refresh="0" style="display: none">2016-02-21T11:40:35Z</span>
  </p>
  <div>
    <p>Nice tutorial of flask.<br>
I'm new in python and follow your microblog a few days.<br>
I'm a Chinese student and amazed about your blog is blocked by the GFW in China, luckily I have shadowsocks.<br>
There are many tutorials translated from your blog in Chinese websites, but the quality is quite low.<br>
I feel good to follow your posts here. The clue is clear and words are easy to understand. I will finish this your tutorial and maybe more posts of your blog!<br>
Thanks for your good work.</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/51fdca2e3b0905a4b2c47a0f1c108bcd?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#93</span> <span class="badge text-bg-warning">Justus Niemzok</span> said
    
    <span class="flask-moment" data-timestamp="2016-08-19T17:45:16Z" data-function="fromNow" data-refresh="0" style="display: none">2016-08-19T17:45:16Z</span>
  </p>
  <div>
    <p>Hi Miguel,</p>
<p>great Tutorial! Thanks a lot. I just went through this section and could not make the custom validation work. It would simply not go into the validate() method of the EditForm class. Found this solution which made it work now.<br>
<a href="http://stackoverflow.com/questions/10722968/flask-wtf-validate-on-submit-is-never-executed" rel="nofollow">http://stackoverflow.com/questions/10722968/flask-wtf-validate-on-submit-is-never-executed</a><br>
Needed to add the  form.csrf_token in the HTML form.<br>
Could it be that you missed this in your script? Any other clue why validate() would not execute?</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/89fbe3bf3a71de6c32c34adb65059e5e?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#94</span> <span class="badge text-bg-danger">Miguel Grinberg</span> said
    
    <span class="flask-moment" data-timestamp="2016-08-25T05:12:01Z" data-function="fromNow" data-refresh="0" style="display: none">2016-08-25T05:12:01Z</span>
  </p>
  <div>
    <p>@Justus: This form was introduced in part 6 of this tutorial. You can see in that part that the form's HTML includes the hidden_tag field, which is the hidden text field that defines the csrf token.</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/d65af5e9bced430a7607e1af53c27943?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#95</span> <span class="badge text-bg-warning">Chris Wilson</span> said
    
    <span class="flask-moment" data-timestamp="2016-09-24T16:02:30Z" data-function="fromNow" data-refresh="0" style="display: none">2016-09-24T16:02:30Z</span>
  </p>
  <div>
    <p>Hi Miguel,<br>
Thanks for the great tutorial. Everything works for me, but I get the messages below when I run it. Are they related to newer versions of Flask being available? I'm using the most recent Flask and Python 3.5. Everything works fine, but should I change these modules as suggested if making my own apps?</p>
<p>Thanks!</p>
<p>/Users/Chris/Code/Flask/microblog/flask/lib/python3.5/site-packages/flask/<a href="http://exthook.py:71/" rel="nofollow">exthook.py:71</a>: ExtDeprecationWarning: Importing flask.ext.sqlalchemy is deprecated, use flask_sqlalchemy instead.<br>
  .format(x=modname), ExtDeprecationWarning<br>
/Users/Chris/Code/Flask/microblog/flask/lib/python3.5/site-packages/flask/<a href="http://exthook.py:71/" rel="nofollow">exthook.py:71</a>: ExtDeprecationWarning: Importing flask.ext.login is deprecated, use flask_login instead.<br>
  .format(x=modname), ExtDeprecationWarning<br>
/Users/Chris/Code/Flask/microblog/flask/lib/python3.5/site-packages/flask/<a href="http://exthook.py:71/" rel="nofollow">exthook.py:71</a>: ExtDeprecationWarning: Importing flask.ext.openid is deprecated, use flask_openid instead.<br>
  .format(x=modname), ExtDeprecationWarning<br>
/Users/Chris/Code/Flask/microblog/flask/lib/python3.5/site-packages/flask_sqlalchemy/<strong>init</strong>.py:800: UserWarning: SQLALCHEMY_TRACK_MODIFICATIONS adds significant overhead and will be disabled by default in the future.  Set it to True to suppress this warning.<br>
  warnings.warn('SQLALCHEMY_TRACK_MODIFICATIONS adds significant overhead and will be disabled by default in the future.  Set it to True to suppress this warning.')<br>
/Users/Chris/Code/Flask/microblog/flask/lib/python3.5/site-packages/flask/<a href="http://exthook.py:71/" rel="nofollow">exthook.py:71</a>: ExtDeprecationWarning: Importing flask.ext.wtf is deprecated, use flask_wtf instead.<br>
  .format(x=modname), ExtDeprecationWarning<br>
 * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)<br>
 * Restarting with stat<br>
/Users/Chris/Code/Flask/microblog/flask/lib/python3.5/site-packages/flask/<a href="http://exthook.py:71/" rel="nofollow">exthook.py:71</a>: ExtDeprecationWarning: Importing flask.ext.sqlalchemy is deprecated, use flask_sqlalchemy instead.<br>
  .format(x=modname), ExtDeprecationWarning<br>
/Users/Chris/Code/Flask/microblog/flask/lib/python3.5/site-packages/flask/<a href="http://exthook.py:71/" rel="nofollow">exthook.py:71</a>: ExtDeprecationWarning: Importing flask.ext.login is deprecated, use flask_login instead.<br>
  .format(x=modname), ExtDeprecationWarning<br>
/Users/Chris/Code/Flask/microblog/flask/lib/python3.5/site-packages/flask/<a href="http://exthook.py:71/" rel="nofollow">exthook.py:71</a>: ExtDeprecationWarning: Importing flask.ext.openid is deprecated, use flask_openid instead.<br>
  .format(x=modname), ExtDeprecationWarning<br>
/Users/Chris/Code/Flask/microblog/flask/lib/python3.5/site-packages/flask_sqlalchemy/<strong>init</strong>.py:800: UserWarning: SQLALCHEMY_TRACK_MODIFICATIONS adds significant overhead and will be disabled by default in the future.  Set it to True to suppress this warning.<br>
  warnings.warn('SQLALCHEMY_TRACK_MODIFICATIONS adds significant overhead and will be disabled by default in the future.  Set it to True to suppress this warning.')<br>
/Users/Chris/Code/Flask/microblog/flask/lib/python3.5/site-packages/flask/<a href="http://exthook.py:71/" rel="nofollow">exthook.py:71</a>: ExtDeprecationWarning: Importing flask.ext.wtf is deprecated, use flask_wtf instead.<br>
  .format(x=modname), ExtDeprecationWarning<br>
 * Debugger is active!<br>
 * Debugger pin code: 271-468-755</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/89fbe3bf3a71de6c32c34adb65059e5e?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#96</span> <span class="badge text-bg-danger">Miguel Grinberg</span> said
    
    <span class="flask-moment" data-timestamp="2016-09-24T17:44:48Z" data-function="fromNow" data-refresh="0" style="display: none">2016-09-24T17:44:48Z</span>
  </p>
  <div>
    <p>@Chris: yes, you should change the imports as indicated in the warnings. I will update the tutorials soon.</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/8c5e0c49b501fc7022165a6afca2ed69?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#97</span> <span class="badge text-bg-warning">mary</span> said
    
    <span class="flask-moment" data-timestamp="2017-02-04T02:09:29Z" data-function="fromNow" data-refresh="0" style="display: none">2017-02-04T02:09:29Z</span>
  </p>
  <div>
    <p>Hi, i got an error message"BuildError: Could not build url for endpoint 'user'. Did you forget to specify values ['nickname']?"<br>
do you know what caused this? i got this error message after i finished the "Edit" part of Part6, i thought maybe after Part7 this will be fixed but no....<br>
i downoaded your code and tried, but the error message is the same. <br>
is this a database error？<br>
Thank you in advance for helping!</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/89fbe3bf3a71de6c32c34adb65059e5e?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#98</span> <span class="badge text-bg-danger">Miguel Grinberg</span> said
    
    <span class="flask-moment" data-timestamp="2017-02-04T08:00:12Z" data-function="fromNow" data-refresh="0" style="display: none">2017-02-04T08:00:12Z</span>
  </p>
  <div>
    <p>@mary: This is a url_for call that does not have all the required arguments to build the url. You need to look in the stack trace of the error to find out what line of your code has this problem. It seems you need to specify a nickname for this particular url.</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/863ddb6689c49941cdc7992b4af8c0ad?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#99</span> <span class="badge text-bg-warning">Serge Chumachenko</span> said
    
    <span class="flask-moment" data-timestamp="2017-03-05T14:35:06Z" data-function="fromNow" data-refresh="0" style="display: none">2017-03-05T14:35:06Z</span>
  </p>
  <div>
    <p>Hello!<br>
Thanks for this tutorial. It's very helpful. <br>
I have a problem with my <a href="http://tests.py/" rel="nofollow">tests.py</a>.<br>
./<a href="http://tests.py/" rel="nofollow">tests.py</a><br>
F.<br>
======================================================================<br>
FAIL: test_avatar (<strong>main</strong>.TestCase)</p>
&lt;hr /&gt;
<p>Traceback (most recent call last):<br>
  File "./<a href="http://tests.py/" rel="nofollow">tests.py</a>", line 24, in test_avatar<br>
    assert avatar[0:len(expected)] == expected<br>
AssertionError</p>
&lt;hr /&gt;
<p>Ran 2 tests in 0.528s</p>
<p>FAILED (failures=1)<br>
I checked all. I can't understand what's the problem with avatar.</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/89fbe3bf3a71de6c32c34adb65059e5e?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#100</span> <span class="badge text-bg-danger">Miguel Grinberg</span> said
    
    <span class="flask-moment" data-timestamp="2017-03-05T16:40:39Z" data-function="fromNow" data-refresh="0" style="display: none">2017-03-05T16:40:39Z</span>
  </p>
  <div>
    <p>@Serge: Add a print statement for avatar and expected, that will help you determine what's wrong with this test.</p>
  </div>
</div>
    </li>
    
  </ul>
</div>

<nav aria-label="Page navigation">
  <ul class="pagination justify-content-center">
    <li class="page-item"><a class="page-link" href="1.html#comments">&laquo;&laquo;</a></li>
    <li class="page-item"><a class="page-link" href="3.html#comments">&laquo;</a></li>
    <li class="page-item"><a class="page-link" href="5.html#comments">&raquo;</a></li>
    <li class="page-item"><a class="page-link" href="0.html#comments">&raquo;&raquo;</a></li>
  </ul>
</nav>



<div id="comment-form">
  <h3>Leave a Comment</h3>

  
  
  

  
<form action="#comment-form" method="post">
  <input id="url" name="url" type="hidden" value="">
<input id="csrf_token" name="csrf_token" type="hidden" value="IjQyYjY5YzZlNTcyYjFkMTVlZGRkOWJjYjA3ZmFlYWFiNTg3YmU5ODki.ZxdnEA.LDnHHXOgdzYCNhCgtf2tzMIilgU">
    
  <div class="mb-3">
    <label class="form-label" for="name">Name</label>
    <div class="input-group has-validation">
      <input class="form-control" id="name" name="name" required type="text" value="">
    </div>
  </div>

    
    
  <div class="mb-3">
    <label class="form-label" for="email">Email</label>
    <div class="input-group has-validation">
      <input class="form-control" id="email" name="email" required type="text" value="">
    </div>
  </div>

    
  <div class="mb-3">
    <label class="form-label" for="comment">Comment</label>
    <div class="input-group has-validation">
      <textarea class="form-control" id="comment" name="comment" required>
</textarea>
    </div>
  </div>

    
  <div class="mb-3">
    <label class="form-label" for="captcha">Captcha</label>
    <div class="input-group has-validation">
      
<script src='https://www.google.com/recaptcha/api.js' async defer></script>
<div class="g-recaptcha" data-sitekey="6Ld5Zs4SAAAAAOY0DOi4r18bgHlEaz41qAoRf__S"></div>

    </div>
  </div>

    
  <input class="btn btn-primary mb-3" id="submit" name="submit" type="submit" value="Submit">

      
</form>

</div>


</div>

      </div>
    </div>
    
    <div class="col-md-4">
      <div id="sidebar">
        
          
  



<div class="card">
  
  
  <div class="card-header">Flask Web Development, 2nd Edition</div>
  <a class="card-book-cover" href="https://amzn.to/3lE2mok">
    <img src="../../../static/flask2e-book-cover-small.png" alt="Flask Web Development, 2nd Edition">
  </a>
  <div class="card-body">
    <p class="card-text">If you want to learn modern web development techniques with Python and Flask, you may find the second edition of my <a href="https://amzn.to/3lE2mok">O'Reilly book</a> useful.</p>
  </div>
  <div class="card-body">
    <a class="card-link" href="https://amzn.to/3lE2mok">Click here to get this Book!</a><br />
  </div>

  
</div>
        
        <div class="card">
  <div class="card-header">About Miguel</div>
  <div class="card-body">
    <img style="float: right; margin: 0px 8px 8px 0px; padding: 4px; border: 1px solid #ccc;" src="../../../static/miguel.jpg" />
    <p class="card-text">Welcome to my blog!</p>
    <p class="card-text">I'm a software engineer and technical writer, currently living in Drogheda, Ireland.</p>
    <p class="card-text">You can also find me on <a href="https://twitter.com/miguelgrinberg">Twitter</a>, <a href="https://mstdn.social/@miguelgrinberg">Mastodon</a>, <a href="https://github.com/miguelgrinberg">Github</a>, <a href="http://www.linkedin.com/in/miguelgrinberg">LinkedIn</a>, <a href="https://youtube.com/miguelgrinberg">YouTube</a>, <a href="https://www.facebook.com/miguelgrinbergblog">Facebook</a> and <a href="https://patreon.com/miguelgrinberg">Patreon</a>.</p>
    <p class="card-text">Thank you for visiting!</p>
  </div>
</div>
        
        <div class="card" id="categories">
  <div class="card-header">Categories</div>
  <div class="card-body">
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/AI/feed"><img src="../../../static/rss-small.png" title="AI RSS Feed" label="AI RSS Feed" alt="AI RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/AI" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="AI" /> <small><em>2</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/AWS/feed"><img src="../../../static/rss-small.png" title="AWS RSS Feed" label="AWS RSS Feed" alt="AWS RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/AWS" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="AWS" /> <small><em>1</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Arduino/feed"><img src="../../../static/rss-small.png" title="Arduino RSS Feed" label="Arduino RSS Feed" alt="Arduino RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Arduino" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Arduino" /> <small><em>7</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Authentication/feed"><img src="../../../static/rss-small.png" title="Authentication RSS Feed" label="Authentication RSS Feed" alt="Authentication RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Authentication" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Authentication" /> <small><em>10</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Blog/feed"><img src="../../../static/rss-small.png" title="Blog RSS Feed" label="Blog RSS Feed" alt="Blog RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Blog" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Blog" /> <small><em>1</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/C++/feed"><img src="../../../static/rss-small.png" title="C++ RSS Feed" label="C++ RSS Feed" alt="C++ RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/C++" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="C++" /> <small><em>5</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/CSS/feed"><img src="../../../static/rss-small.png" title="CSS RSS Feed" label="CSS RSS Feed" alt="CSS RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/CSS" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="CSS" /> <small><em>1</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Cloud/feed"><img src="../../../static/rss-small.png" title="Cloud RSS Feed" label="Cloud RSS Feed" alt="Cloud RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Cloud" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Cloud" /> <small><em>10</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Database/feed"><img src="../../../static/rss-small.png" title="Database RSS Feed" label="Database RSS Feed" alt="Database RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Database" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Database" /> <small><em>22</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Docker/feed"><img src="../../../static/rss-small.png" title="Docker RSS Feed" label="Docker RSS Feed" alt="Docker RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Docker" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Docker" /> <small><em>5</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Filmmaking/feed"><img src="../../../static/rss-small.png" title="Filmmaking RSS Feed" label="Filmmaking RSS Feed" alt="Filmmaking RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Filmmaking" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Filmmaking" /> <small><em>6</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Flask/feed"><img src="../../../static/rss-small.png" title="Flask RSS Feed" label="Flask RSS Feed" alt="Flask RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Flask" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Flask" /> <small><em>126</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Games/feed"><img src="../../../static/rss-small.png" title="Games RSS Feed" label="Games RSS Feed" alt="Games RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Games" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Games" /> <small><em>1</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Heroku/feed"><img src="../../../static/rss-small.png" title="Heroku RSS Feed" label="Heroku RSS Feed" alt="Heroku RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Heroku" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Heroku" /> <small><em>1</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/IoT/feed"><img src="../../../static/rss-small.png" title="IoT RSS Feed" label="IoT RSS Feed" alt="IoT RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/IoT" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="IoT" /> <small><em>8</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/JavaScript/feed"><img src="../../../static/rss-small.png" title="JavaScript RSS Feed" label="JavaScript RSS Feed" alt="JavaScript RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/JavaScript" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="JavaScript" /> <small><em>35</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/MicroPython/feed"><img src="../../../static/rss-small.png" title="MicroPython RSS Feed" label="MicroPython RSS Feed" alt="MicroPython RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/MicroPython" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="MicroPython" /> <small><em>9</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Microdot/feed"><img src="../../../static/rss-small.png" title="Microdot RSS Feed" label="Microdot RSS Feed" alt="Microdot RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Microdot" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Microdot" /> <small><em>1</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Microservices/feed"><img src="../../../static/rss-small.png" title="Microservices RSS Feed" label="Microservices RSS Feed" alt="Microservices RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Microservices" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Microservices" /> <small><em>2</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Movie Reviews/feed"><img src="../../../static/rss-small.png" title="Movie Reviews RSS Feed" label="Movie Reviews RSS Feed" alt="Movie Reviews RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Movie Reviews" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Movie Reviews" /> <small><em>5</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/OpenStack/feed"><img src="../../../static/rss-small.png" title="OpenStack RSS Feed" label="OpenStack RSS Feed" alt="OpenStack RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/OpenStack" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="OpenStack" /> <small><em>1</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Personal/feed"><img src="../../../static/rss-small.png" title="Personal RSS Feed" label="Personal RSS Feed" alt="Personal RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Personal" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Personal" /> <small><em>3</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Photography/feed"><img src="../../../static/rss-small.png" title="Photography RSS Feed" label="Photography RSS Feed" alt="Photography RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Photography" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Photography" /> <small><em>7</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Product Reviews/feed"><img src="../../../static/rss-small.png" title="Product Reviews RSS Feed" label="Product Reviews RSS Feed" alt="Product Reviews RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Product Reviews" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Product Reviews" /> <small><em>2</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Programming/feed"><img src="../../../static/rss-small.png" title="Programming RSS Feed" label="Programming RSS Feed" alt="Programming RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Programming" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Programming" /> <small><em>187</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Project Management/feed"><img src="../../../static/rss-small.png" title="Project Management RSS Feed" label="Project Management RSS Feed" alt="Project Management RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Project Management" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Project Management" /> <small><em>1</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Python/feed"><img src="../../../static/rss-small.png" title="Python RSS Feed" label="Python RSS Feed" alt="Python RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Python" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Python" /> <small><em>169</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/REST/feed"><img src="../../../static/rss-small.png" title="REST RSS Feed" label="REST RSS Feed" alt="REST RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/REST" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="REST" /> <small><em>7</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Rackspace/feed"><img src="../../../static/rss-small.png" title="Rackspace RSS Feed" label="Rackspace RSS Feed" alt="Rackspace RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Rackspace" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Rackspace" /> <small><em>1</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Raspberry Pi/feed"><img src="../../../static/rss-small.png" title="Raspberry Pi RSS Feed" label="Raspberry Pi RSS Feed" alt="Raspberry Pi RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Raspberry Pi" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Raspberry Pi" /> <small><em>8</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/React/feed"><img src="../../../static/rss-small.png" title="React RSS Feed" label="React RSS Feed" alt="React RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/React" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="React" /> <small><em>18</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Robotics/feed"><img src="../../../static/rss-small.png" title="Robotics RSS Feed" label="Robotics RSS Feed" alt="Robotics RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Robotics" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Robotics" /> <small><em>6</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Security/feed"><img src="../../../static/rss-small.png" title="Security RSS Feed" label="Security RSS Feed" alt="Security RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Security" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Security" /> <small><em>12</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Video/feed"><img src="../../../static/rss-small.png" title="Video RSS Feed" label="Video RSS Feed" alt="Video RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Video" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Video" /> <small><em>22</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/WebSocket/feed"><img src="../../../static/rss-small.png" title="WebSocket RSS Feed" label="WebSocket RSS Feed" alt="WebSocket RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/WebSocket" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="WebSocket" /> <small><em>2</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Webcast/feed"><img src="../../../static/rss-small.png" title="Webcast RSS Feed" label="Webcast RSS Feed" alt="Webcast RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Webcast" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Webcast" /> <small><em>3</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Windows/feed"><img src="../../../static/rss-small.png" title="Windows RSS Feed" label="Windows RSS Feed" alt="Windows RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Windows" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Windows" /> <small><em>1</em></small>
      </form>
    </div>
    
  </div>
</div>
        
      </div>
    </div>
    
  </div>
  <div id="footer">
    
    <p>&copy; 2012-<script type="text/javascript">document.write(new Date().getFullYear());</script> by Miguel Grinberg. All rights reserved. <a href="mailto:webmaster _at_ miguelgrinberg _dot_ com">Questions?</a></p>
  </div>
</div>

  
    <script src="../../../../cdn.jsdelivr.net/npm/bootstrap%405.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
  <script type="text/javascript" src="../../../static/prettify.js"></script>
  <script src="../../../../cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.4/moment-with-locales.min.js" integrity="sha512-42PE0rd+wZ2hNXftlM78BSehIGzezNeQuzihiBCvUEB3CVxHvsShF86wBWwQORNxNINlBPuq7rG4WWhNiTVHFg==" crossorigin="anonymous"></script>

<script>
moment.locale("en");
function flask_moment_render(elem) {{
    const timestamp = moment(elem.dataset.timestamp);
    const func = elem.dataset.function;
    const format = elem.dataset.format;
    const timestamp2 = elem.dataset.timestamp2;
    const no_suffix = elem.dataset.nosuffix;
    const units = elem.dataset.units;
    let args = [];
    if (format)
        args.push(format);
    if (timestamp2)
        args.push(moment(timestamp2));
    if (no_suffix)
        args.push(no_suffix);
    if (units)
        args.push(units);
    elem.textContent = timestamp[func].apply(timestamp, args);
    elem.classList.remove('flask-moment');
    elem.style.display = "";
}}
function flask_moment_render_all() {{
    const moments = document.querySelectorAll('.flask-moment');
    moments.forEach(function(moment) {{
        flask_moment_render(moment);
        const refresh = moment.dataset.refresh;
        if (refresh && refresh > 0) {{
            (function(elem, interval) {{
                setInterval(function() {{
                    flask_moment_render(elem);
                }}, interval);
            }})(moment, refresh);
        }}
    }})
}}
document.addEventListener("DOMContentLoaded", flask_moment_render_all);
</script>

  
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-20EHZP9GRZ"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-20EHZP9GRZ');
  </script>
  
  <script type="text/javascript">
    function setThemeUI() {
      document.getElementById('select-theme-auto').classList.remove('active');
      document.getElementById('select-theme-light').classList.remove('active');
      document.getElementById('select-theme-dark').classList.remove('active');
      const theme = getPreferredTheme();
      const actualTheme = document.documentElement.getAttribute('data-bs-theme', 'light');
      document.getElementById('select-theme-' + theme).classList.add('active');
      document.getElementById('current-theme').href.baseVal = `#icon-theme-${actualTheme}`;
    };

    function updateTheme(theme) {
      if (theme === 'auto') {
        localStorage.removeItem('theme')
      }
      else {
        localStorage.setItem('theme', theme)
      }
      setTheme(getPreferredTheme());
    }

    setThemeUI();

    const darkModePreference = window.matchMedia("(prefers-color-scheme: dark)");
    darkModePreference.addEventListener("change", e => {
      if (getPreferredTheme() === 'auto') {
        setTheme('auto');
      }
    });

    document.addEventListener("DOMContentLoaded", () => {
      // add prettyprint class to all <pre><code></code></pre> blocks
      let prettify = false;
      document.querySelectorAll('div.post-body pre code').forEach((code) => {
        code.parentNode.classList.add('prettyprint');
        prettify = true;
      });
      prettyPrint();
    });
  </script>

  </body>

<!-- Mirrored from blog.miguelgrinberg.com/post/the-flask-mega-tutorial-part-vii-unit-testing-legacy/page/4 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 22 Oct 2024 08:50:34 GMT -->
</html>