<!doctype html>
<html lang="en">
  
<!-- Mirrored from blog.miguelgrinberg.com/post/the-flask-mega-tutorial-part-vi-profile-page-and-avatars-2018/page/5 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 22 Oct 2024 08:51:00 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    
  <script type="text/javascript">
    function getPreferredTheme() {
      const storedTheme = localStorage.getItem('theme')
      if (storedTheme) {
        return storedTheme
      }
      return 'auto';
    }

    function setTheme(theme) {
      if (theme === 'auto') {
        theme = window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light'
      }
      document.documentElement.setAttribute('data-bs-theme', theme);
    };

    setTheme(getPreferredTheme());
  </script>
  
    <title>
  
    The Flask Mega-Tutorial Part VI: Profile Page and Avatars (2018) - miguelgrinberg.com
  
</title>
  
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="description" content="miguelgrinberg.com">
  <meta name="copyright" content="Copyright (c) 2012-2024 Miguel Grinberg">
  <meta name="author" content="Miguel Grinberg">
  
  <meta name="keywords" content="python, programming, flask, profile, avatar, gravatar, identicon, users">
  
  
  <link rel="canonical" href="../../the-flask-mega-tutorial-part-vi-profile-page-and-avatars-2018.html">
  

  
    <link href="../../../../cdn.jsdelivr.net/npm/bootstrap%405.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
  <link rel="preconnect" href="https://fonts.googleapis.com/">
  <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400&amp;display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@700&amp;display=swap" rel="stylesheet">

  <link href="../../../static/tomorrow.min.css" type="text/css" rel="stylesheet" />
  <link href="../../../static/tomorrow-night.min.css" type="text/css" rel="stylesheet" />
  <link href="../../../static/social.css" rel="stylesheet" type="text/css" />
  <link href="../../../static/style_20231230.css" rel="stylesheet" type="text/css" />

  <link rel="shortcut icon" href="https://blog.miguelgrinberg.com/static/favicon.ico">
  <link rel="alternate" type="application/rss+xml" href="https://blog.miguelgrinberg.com/feed" title="miguelgrinberg.com RSS feed">

    <meta property="og:title" content="The Flask Mega-Tutorial Part VI: Profile Page and Avatars (2018)">
    <meta property="og:description" content="(Great news! There is a new version of this tutorial!)This is the sixth installment of the Flask Mega-Tutorial series, in which I&#39;m going to tell you how to create the user profile page.For your…">
    <meta property="og:image" content="https://blog.miguelgrinberg.com/static/cards/the-flask-mega-tutorial-part-vi-profile-page-and-avatars-2018.jpg">
    <meta property="og:url" content="https://blog.miguelgrinberg.com/post/the-flask-mega-tutorial-part-vi-profile-page-and-avatars-2018">
    <meta name="twitter:title" content="The Flask Mega-Tutorial Part VI: Profile Page and Avatars (2018)">
    <meta name="twitter:description" content="(Great news! There is a new version of this tutorial!)This is the sixth installment of the Flask Mega-Tutorial series, in which I&#39;m going to tell you how to create the user profile page.For your…">
    <meta name="twitter:image" content="https://blog.miguelgrinberg.com/static/cards/the-flask-mega-tutorial-part-vi-profile-page-and-avatars-2018.jpg">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@miguelgrinberg">

  </head>
  <body>
    <svg style="display: none" version="2.0">
      <defs>
        <symbol id="icon-theme-auto" xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="bi bi-circle-half" viewBox="0 0 16 16">
          <path d="M8 15A7 7 0 1 0 8 1zm0 1A8 8 0 1 1 8 0a8 8 0 0 1 0 16"/>
        </symbol>
        <symbol id="icon-theme-light" xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="bi bi-brightness-high-fill" viewBox="0 0 16 16">
          <path d="M8 11a3 3 0 1 1 0-6 3 3 0 0 1 0 6m0 1a4 4 0 1 0 0-8 4 4 0 0 0 0 8M8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0m0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13m8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5M3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8m10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0m-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707M4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"/>
        </symbol>
        <symbol id="icon-theme-dark" xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="bi bi-moon-stars-fill" viewBox="0 0 16 16">
          <path d="M6 .278a.768.768 0 0 1 .08.858 7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278"/>
          <path d="M10.794 3.148a.217.217 0 0 1 .412 0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217 0 0 1 0 .412l-1.162.387a1.734 1.734 0 0 0-1.097 1.097l-.387 1.162a.217.217 0 0 1-.412 0l-.387-1.162A1.734 1.734 0 0 0 9.31 6.593l-1.162-.387a.217.217 0 0 1 0-.412l1.162-.387a1.734 1.734 0 0 0 1.097-1.097l.387-1.162zM13.863.099a.145.145 0 0 1 .274 0l.258.774c.115.346.386.617.732.732l.774.258a.145.145 0 0 1 0 .274l-.774.258a1.156 1.156 0 0 0-.732.732l-.258.774a.145.145 0 0 1-.274 0l-.258-.774a1.156 1.156 0 0 0-.732-.732l-.774-.258a.145.145 0 0 1 0-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z"/>
        </symbol>
      </defs>
    </svg>
<nav class="navbar navbar-expand-lg">
  <div class="container">
    <a class="navbar-brand" href="https://blog.miguelgrinberg.com/index">miguelgrinberg.com</a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarCollapse">
      <ul class="navbar-nav me-auto">
        <li class="nav-item"><a class="nav-link" aria-current="page" href="https://blog.miguelgrinberg.com/index">Home</a></li>
        <li class="nav-item"><a class="nav-link" aria-current="page" href="../../my-courses-and-books.html">My Courses and Books</a></li>
        <li class="nav-item"><a class="nav-link" aria-current="page" href="../../hire-me.html">Consulting</a></li>
        <li class="nav-item"><a class="nav-link" aria-current="page" href="../../about-me.html">About Me</a></li>
        
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
            <svg width="20" height="20" version="2.0"><use id="current-theme" href="#icon-theme-light"></svg>
          </a>
          <ul class="dropdown-menu">
            <li>
              <a id="select-theme-light" class="dropdown-item" href="javascript:updateTheme('light')">
                <svg width="16" height="16" version="2.0"><use href="#icon-theme-light"></svg>&nbsp; Light Mode
              </a>
            </li>
            <li>
              <a id="select-theme-dark" class="dropdown-item" href="javascript:updateTheme('dark')">
                <svg width="16" height="16" version="2.0"><use href="#icon-theme-dark"></svg>&nbsp; Dark Mode
              </a>
            </li>
            <li><hr class="dropdown-divider"></li>
            <li>
              <a id="select-theme-auto" class="dropdown-item" href="javascript:updateTheme('auto')">
                <svg width="16" height="16" version="2.0"><use href="#icon-theme-auto"></svg>&nbsp; System Default
              </a>
            </li>
          </ul>
        </li>
        
      </ul>
      <ul class="navbar-nav">
        <li class="nav-item social-icons">
          <a type="application/rss+xml" href="https://blog.miguelgrinberg.com/feed"><img src="../../../static/social/rss.png" alt="RSS Feed" title="RSS Feed" /></a>
          <a href="https://twitter.com/miguelgrinberg"><img src="../../../static/social/twitter.png" alt="Twitter" title="Twitter" /></a>
          <a rel="me" href="https://mstdn.social/@miguelgrinberg"><img src="../../../static/social/mastodon.png" alt="Mastodon" title="Mastodon" /></a>
          <a href="http://github.com/miguelgrinberg"><img src="../../../static/social/github.png" alt="GitHub" title="GitHub" /></a>
          <a href="https://youtube.com/miguelgrinberg"><img src="../../../static/social/youtube.png" alt="YouTube" title="YouTube" /></a>
          <a href="http://www.linkedin.com/in/miguelgrinberg"><img src="../../../static/social/linkedin.png" alt="LinkedIn" title="LinkedIn" /></a>
          <a href="https://patreon.com/miguelgrinberg"><img src="../../../static/social/patreon.png" alt="Patreon" title="Patreon" /></a>
          <!--<a href="https://www.facebook.com/miguelgrinbergblog"><img src="/static/social/facebook.png" alt="Facebook" title="Facebook" /></a>-->
        </li>
      </ul>
    </div>
  </div>
</nav>

<div class="container">
  <div class="row">
    <div class="col-md-8">
      <div id="main">
        
        
        
        
        

<div class="post">

<div class="post-header">
  <h1><a href="../../the-flask-mega-tutorial-part-vi-profile-page-and-avatars-2018.html">The Flask Mega-Tutorial Part VI: Profile Page and Avatars (2018)</a></h1>
  <h2>
    Posted by
    <form action="https://blog.miguelgrinberg.com/author/Miguel Grinberg" method="POST">
      <input type="submit" class="btn btn-danger btn-sm" value="Miguel Grinberg" />
    </form>
    on
    <button class="btn btn-secondary btn-sm" disabled><span class="flask-moment" data-timestamp="2018-01-09T17:32:42Z" data-function="format" data-format="LL" data-refresh="0" style="display: none">2018-01-09T17:32:42Z</span></button>
    under
    
      <form action="https://blog.miguelgrinberg.com/category/Python" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Python" />
      </form>
    
      <form action="https://blog.miguelgrinberg.com/category/Flask" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Flask" />
      </form>
    
      <form action="https://blog.miguelgrinberg.com/category/Programming" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Programming" />
      </form>
    
    
  </h2>
</div>
<div class="post-body"><p><em>(Great news! There is a <a href="../../the-flask-mega-tutorial-part-i-hello-world.html">new version of this tutorial</a>!)</em></p>
<p>This is the sixth installment of the Flask Mega-Tutorial series, in which I'm going to tell you how to create the user profile page.</p>
<p>For your reference, below is a list of the articles in this series.</p>
<ul>
<li><a href="../../the-flask-mega-tutorial-part-i-hello-world-2018.html">Chapter 1: Hello, World!</a></li>
<li><a href="../../the-flask-mega-tutorial-part-ii-templates-2018.html">Chapter 2: Templates</a></li>
<li><a href="../../the-flask-mega-tutorial-part-iii-web-forms-2018.html">Chapter 3: Web Forms</a></li>
<li><a href="../../the-flask-mega-tutorial-part-iv-database-2018.html">Chapter 4: Database</a></li>
<li><a href="../../the-flask-mega-tutorial-part-v-user-logins-2018.html">Chapter 5: User Logins</a></li>
<li><a href="../../the-flask-mega-tutorial-part-vi-profile-page-and-avatars-2018.html">Chapter 6: Profile Page and Avatars</a> (this article)</li>
<li><a href="../../the-flask-mega-tutorial-part-vii-error-handling-2018.html">Chapter 7: Error Handling</a></li>
<li><a href="../../the-flask-mega-tutorial-part-viii-followers-2018.html">Chapter 8: Followers</a></li>
<li><a href="../../the-flask-mega-tutorial-part-ix-pagination-2018.html">Chapter 9: Pagination</a></li>
<li><a href="../../the-flask-mega-tutorial-part-x-email-support-2018.html">Chapter 10: Email Support</a></li>
<li><a href="../../the-flask-mega-tutorial-part-xi-facelift-2018.html">Chapter 11: Facelift</a></li>
<li><a href="../../the-flask-mega-tutorial-part-xii-dates-and-times-2018.html">Chapter 12: Dates and Times</a></li>
<li><a href="../../the-flask-mega-tutorial-part-xiii-i18n-and-l10n-2018.html">Chapter 13: I18n and L10n</a></li>
<li><a href="../../the-flask-mega-tutorial-part-xiv-ajax-2018.html">Chapter 14: Ajax</a></li>
<li><a href="../../the-flask-mega-tutorial-part-xv-a-better-application-structure-2018.html">Chapter 15: A Better Application Structure</a></li>
<li><a href="../../the-flask-mega-tutorial-part-xvi-full-text-search-2018.html">Chapter 16: Full-Text Search</a></li>
<li><a href="../../the-flask-mega-tutorial-part-xvii-deployment-on-linux-2018.html">Chapter 17: Deployment on Linux</a></li>
<li><a href="../../the-flask-mega-tutorial-part-xviii-deployment-on-heroku-2018.html">Chapter 18: Deployment on Heroku</a></li>
<li><a href="../../the-flask-mega-tutorial-part-xix-deployment-on-docker-containers-2018.html">Chapter 19: Deployment on Docker Containers</a></li>
<li><a href="../../the-flask-mega-tutorial-part-xx-some-javascript-magic-2018.html">Chapter 20: Some JavaScript Magic</a></li>
<li><a href="../../the-flask-mega-tutorial-part-xxi-user-notifications-2018.html">Chapter 21: User Notifications</a></li>
<li><a href="../../the-flask-mega-tutorial-part-xxii-background-jobs-2018.html">Chapter 22: Background Jobs</a></li>
<li><a href="../../the-flask-mega-tutorial-part-xxiii-application-programming-interfaces-apis-2018.html">Chapter 23: Application Programming Interfaces (APIs)</a></li>
</ul>
<p>This chapter is going to be dedicated to adding user profile pages to the application. A user profile page is a page in which information about a user is presented, often with information entered by the users themselves. I will show you how to generate profile pages for all users dynamically, and then I'll add a small profile editor that users can use to enter their information.</p>
<p><em>The GitHub links for this chapter are: <a href="https://github.com/miguelgrinberg/microblog/tree/v0.6">Browse</a>, <a href="https://github.com/miguelgrinberg/microblog-2018/archive/v0.6.zip">Zip</a>, <a href="https://github.com/miguelgrinberg/microblog/compare/v0.5...v0.6">Diff</a>.</em></p>
<h2>User Profile Page</h2>
<p>To create a user profile page, let's add a <em>/user/&lt;username&gt;</em> route to the application.</p>
<p class="code_title"><i>app/routes.py</i>: User profile view function</p>

<pre><code class="language-python">@app.route('/user/&lt;username&gt;')
@login_required
def user(username):
    user = User.query.filter_by(username=username).first_or_404()
    posts = [
        {'author': user, 'body': 'Test post #1'},
        {'author': user, 'body': 'Test post #2'}
    ]
    return render_template('user.html', user=user, posts=posts)
</code></pre>
<p>The <code>@app.route</code> decorator that I used to declare this view function looks a little bit different than the previous ones. In this case I have a dynamic component in it, which is indicated as the <code>&lt;username&gt;</code> URL component that is surrounded by <code>&lt;</code> and <code>&gt;</code>. When a route has a dynamic component, Flask will accept any text in that portion of the URL, and will invoke the view function with the actual text as an argument. For example, if the client browser requests URL <code>/user/susan</code>, the view function is going to be called with the argument <code>username</code> set to <code>'susan'</code>. This view function is only going to be accessible to logged in users, so I have added the <code>@login_required</code> decorator from Flask-Login.</p>
<p>The implementation of this view function is fairly simple. I first try to load the user from the database using a query by the username. You have seen before that a database query can be executed by calling <code>all()</code> if you want to get all results, or <code>first()</code> if you want to get just the first result or <code>None</code> if there are zero results. In this view function I'm using a variant of <code>first()</code> called <code>first_or_404()</code>, which works exactly like <code>first()</code> when there are results, but in the case that there are no results automatically sends a <a href="https://en.wikipedia.org/wiki/HTTP_404">404 error</a> back to the client. Executing the query in this way I save myself from checking if the query returned a user, because when the username does not exist in the database the function will not return and instead a 404 exception will be raised.</p>
<p>If the database query does not trigger a 404 error, then that means that a user with the given username was found. Next I initialize a fake list of posts for this user, finally render a new <em>user.html</em> template to which I pass the user object and the list of posts.</p>
<p>The <em>user.html</em> template is shown below:</p>
<p class="code_title"><i>app/templates/user.html</i>: User profile template</p>

<pre><code class="language-html">{% extends &quot;base.html&quot; %}

{% block content %}
    &lt;h1&gt;User: {{ user.username }}&lt;/h1&gt;
    &lt;hr&gt;
    {% for post in posts %}
    &lt;p&gt;
    {{ post.author.username }} says: &lt;b&gt;{{ post.body }}&lt;/b&gt;
    &lt;/p&gt;
    {% endfor %}
{% endblock %}
</code></pre>
<p>The profile page is now complete, but a link to it does not exist anywhere in the web site. To make it a bit more easy for users to check their own profile, I'm going to add a link to it in the navigation bar at the top:</p>
<p class="code_title"><i>app/templates/base.html</i>: User profile template</p>

<pre><code class="language-html">    &lt;div&gt;
      Microblog:
      &lt;a href=&quot;{{ url_for('index') }}&quot;&gt;Home&lt;/a&gt;
      {% if current_user.is_anonymous %}
      &lt;a href=&quot;{{ url_for('login') }}&quot;&gt;Login&lt;/a&gt;
      {% else %}
      &lt;a href=&quot;{{ url_for('user', username=current_user.username) }}&quot;&gt;Profile&lt;/a&gt;
      &lt;a href=&quot;{{ url_for('logout') }}&quot;&gt;Logout&lt;/a&gt;
      {% endif %}
    &lt;/div&gt;
</code></pre>
<p>The only interesting change here is the <code>url_for()</code> call that is used to generate the link to the profile page. Since the user profile view function takes a dynamic argument, the <code>url_for()</code> function receives a value for it as a keyword argument. Since this is a link that points to the logged in's user profile, I can use Flask-Login's <code>current_user</code> to generate the correct URL.</p>
<p><img alt="User Profile Page" src="../../../static/images/mega-tutorial/ch06-user-profile.png" /></p>
<p>Give the application a try now. Clicking on the <code>Profile</code> link at the top should take you to your own user page. At this point there are no links that will take to the profile page of other users, but if you want to access those pages you can type the URL by hand in the browser's address bar. For example, if you have a user named "john" registered on your application, you can view the corresponding user profile by typing <em>http://localhost:5000/user/john</em> in the address bar.</p>
<h2>Avatars</h2>
<p>I'm sure you agree that the profile pages that I just built are pretty boring. To make them a bit more interesting, I'm going to add user avatars, but instead of having to deal with a possibly large collection of uploaded images in the server, I'm going to use the <a href="http://gravatar.com/">Gravatar</a> service to provide images for all users.</p>
<p>The Gravatar service is very simple to use. To request an image for a given user, a URL with the format <em>https://www.gravatar.com/avatar/&lt;hash&gt;</em>, where <code>&lt;hash&gt;</code> is the MD5 hash of the user's email address. Below you can see how to obtain the Gravatar URL for a user with email <code>john@example.com</code>:</p>
<pre><code class="language-python">&gt;&gt;&gt; from hashlib import md5
&gt;&gt;&gt; 'https://www.gravatar.com/avatar/' + md5(b'john@example.com').hexdigest()
'https://www.gravatar.com/avatar/d4c74594d841139328695756648b6bd6'
</code></pre>
<p>If you want to see an actual example, my own Gravatar URL is:</p>
<pre><code>https://www.gravatar.com/avatar/729e26a2a2c7ff24a71958d4aa4e5f35
</code></pre>
<p>Here is what Gravatar returns for this URL:</p>
<p><img alt="Miguel's Gravatar" src="../../../static/images/mega-tutorial/ch06-gravatar.jpg" /></p>
<p>By default the image size returned is 80x80 pixels, but a different size can be requested by adding a <code>s</code> argument to the URL's query string. For example, to obtain my own avatar as a 128x128 pixel image, the URL is \linebreak <em>https://www.gravatar.com/avatar/729e26a2a2c7ff24a71958d4aa4e5f35?s=128</em>.</p>
<p>Another interesting argument that can be passed to Gravatar as a query string argument is <code>d</code>, which determines what image Gravatar provides for users that do not have an avatar registered with the service. My favorite is called "identicon", which returns a nice geometric design that is different for every email. For example:</p>
<p><img alt="Identicon Gravatar" src="../../../static/images/mega-tutorial/ch06-gravatar-identicon.png" /></p>
<p>Note that some web browser extensions such as Ghostery block Gravatar images, as they consider that Automattic (the owners of the Gravatar service) can determine what sites you visit based on the requests they get for your avatar. If you don't see avatars in your browser, consider that the problem may be due to an extension that you have installed in your browser.</p>
<p>Since avatars are associated with users, it makes sense to add the logic that generates the avatar URLs to the user model.</p>
<p class="code_title"><i>app/models.py</i>: User avatar URLs</p>

<pre><code class="language-python">from hashlib import md5
# ...

class User(UserMixin, db.Model):
    # ...
    def avatar(self, size):
        digest = md5(self.email.lower().encode('utf-8')).hexdigest()
        return 'https://www.gravatar.com/avatar/{}?d=identicon&amp;s={}'.format(
            digest, size)
</code></pre>
<p>The new <code>avatar()</code> method of the <code>User</code> class returns the URL of the user's avatar image, scaled to the requested size in pixels. For users that don't have an avatar registered, an "identicon" image will be generated. To generate the MD5 hash, I first convert the email to lower case, as this is required by the Gravatar service. Then, because the MD5 support in Python works on bytes and not on strings, I encode the string as bytes before passing it on to the hash function.</p>
<p>If you are interested in learning about other options offered by the Gravatar service, visit their <a href="https://gravatar.com/site/implement/images">documentation website</a>.</p>
<p>The next step is to insert the avatar images in the user profile template:</p>
<p class="code_title"><i>app/templates/user.html</i>: User avatar in template</p>

<pre><code class="language-html">{% extends &quot;base.html&quot; %}

{% block content %}
    &lt;table&gt;
        &lt;tr valign=&quot;top&quot;&gt;
            &lt;td&gt;&lt;img src=&quot;{{ user.avatar(128) }}&quot;&gt;&lt;/td&gt;
            &lt;td&gt;&lt;h1&gt;User: {{ user.username }}&lt;/h1&gt;&lt;/td&gt;
        &lt;/tr&gt;
    &lt;/table&gt;
    &lt;hr&gt;
    {% for post in posts %}
    &lt;p&gt;
    {{ post.author.username }} says: &lt;b&gt;{{ post.body }}&lt;/b&gt;
    &lt;/p&gt;
    {% endfor %}
{% endblock %}
</code></pre>
<p>The nice thing about making the <code>User</code> class responsible for returning avatar URLs is that if some day I decide Gravatar avatars are not what I want, I can just rewrite the <code>avatar()</code> method to return different URLs, and all the templates will start showing the new avatars automatically.</p>
<p>I have a nice big avatar at the top of the user profile page, but really there is no reason to stop there. I have some posts from the user at the bottom that could each have a little avatar as well. For the user profile page of course all posts will have the same avatar, but then I can implement the same functionality on the main page, and then each post will be decorated with the author's avatar, and that will look really nice.</p>
<p>To show avatars for the individual posts I just need to make one more small change in the template:</p>
<p class="code_title"><i>app/templates/user.html</i>: User avatars in posts</p>

<pre><code class="language-html">{% extends &quot;base.html&quot; %}

{% block content %}
    &lt;table&gt;
        &lt;tr valign=&quot;top&quot;&gt;
            &lt;td&gt;&lt;img src=&quot;{{ user.avatar(128) }}&quot;&gt;&lt;/td&gt;
            &lt;td&gt;&lt;h1&gt;User: {{ user.username }}&lt;/h1&gt;&lt;/td&gt;
        &lt;/tr&gt;
    &lt;/table&gt;
    &lt;hr&gt;
    {% for post in posts %}
    &lt;table&gt;
        &lt;tr valign=&quot;top&quot;&gt;
            &lt;td&gt;&lt;img src=&quot;{{ post.author.avatar(36) }}&quot;&gt;&lt;/td&gt;
            &lt;td&gt;{{ post.author.username }} says:&lt;br&gt;{{ post.body }}&lt;/td&gt;
        &lt;/tr&gt;
    &lt;/table&gt;
    {% endfor %}
{% endblock %}
</code></pre>
<p><img alt="Avatars" src="../../../static/images/mega-tutorial/ch06-avatars.png" /></p>
<h2>Using Jinja2 Sub-Templates</h2>
<p>I designed the user profile page so that it displays the posts written by the user, along with their avatars. Now I want the index page to also display posts with a similar layout. I could just copy/paste the portion of the template that deals with the rendering of a post, but that is really not ideal because later if I decide to make changes to this layout I'm going to have to remember to update both templates.</p>
<p>Instead, I'm going to make a sub-template that just renders one post, and then I'm going to reference it from both the <em>user.html</em> and <em>index.html</em> templates. To begin, I can create the sub-template, with just the HTML markup for a single post. I'm going to name this template <em>app/templates/_post.html</em>. The <code>_</code> prefix is just a naming convention to help me recognize which template files are sub-templates.</p>
<p class="code_title"><i>app/templates/_post.html</i>: Post sub-template</p>

<pre><code class="language-html">    &lt;table&gt;
        &lt;tr valign=&quot;top&quot;&gt;
            &lt;td&gt;&lt;img src=&quot;{{ post.author.avatar(36) }}&quot;&gt;&lt;/td&gt;
            &lt;td&gt;{{ post.author.username }} says:&lt;br&gt;{{ post.body }}&lt;/td&gt;
        &lt;/tr&gt;
    &lt;/table&gt;
</code></pre>
<p>To invoke this sub-template from the <em>user.html</em> template I use Jinja2's <code>include</code> statement:</p>
<p class="code_title"><i>app/templates/user.html</i>: User avatars in posts</p>

<pre><code class="language-python">{% extends &quot;base.html&quot; %}

{% block content %}
    &lt;table&gt;
        &lt;tr valign=&quot;top&quot;&gt;
            &lt;td&gt;&lt;img src=&quot;{{ user.avatar(128) }}&quot;&gt;&lt;/td&gt;
            &lt;td&gt;&lt;h1&gt;User: {{ user.username }}&lt;/h1&gt;&lt;/td&gt;
        &lt;/tr&gt;
    &lt;/table&gt;
    &lt;hr&gt;
    {% for post in posts %}
        {% include '_post.html' %}
    {% endfor %}
{% endblock %}
</code></pre>
<p>The index page of the application isn't really fleshed out yet, so I'm not going to add this functionality there yet.</p>
<h2>More Interesting Profiles</h2>
<p>One problem the new user profile pages have is that they don't really show much on them. Users like to tell a bit about them on these pages, so I'm going to let them write something about themselves to show here. I'm also going to keep track of what was the last time each user accessed the site and also show display it on their profile page.</p>
<p>The first I need to do to support all this extra information is to extend the users table in the database with two new fields:</p>
<p class="code_title"><i>app/models.py</i>: New fields in user model</p>

<pre><code class="language-python">class User(UserMixin, db.Model):
    # ...
    about_me = db.Column(db.String(140))
    last_seen = db.Column(db.DateTime, default=datetime.utcnow)
</code></pre>
<p>Every time the database is modified it is necessary to generate a database migration. In <a href="../../the-flask-mega-tutorial-part-iv-database-2018.html">Chapter 4</a> I showed you how to set up the application to track database changes through migration scripts. Now I have two new fields that I want to add to the database, so the first step is to generate the migration script:</p>
<pre><code>(venv) $ flask db migrate -m &quot;new fields in user model&quot;
INFO  [alembic.runtime.migration] Context impl SQLiteImpl.
INFO  [alembic.runtime.migration] Will assume non-transactional DDL.
INFO  [alembic.autogenerate.compare] Detected added column 'user.about_me'
INFO  [alembic.autogenerate.compare] Detected added column 'user.last_seen'
  Generating migrations/versions/37f06a334dbf_new_fields_in_user_model.py ... done
</code></pre>
<p>The output of the <code>migrate</code> command looks good, as it shows that the two new fields in the <code>User</code> class were detected. Now I can apply this change to the database:</p>
<pre><code>(venv) $ flask db upgrade
INFO  [alembic.runtime.migration] Context impl SQLiteImpl.
INFO  [alembic.runtime.migration] Will assume non-transactional DDL.
INFO  [alembic.runtime.migration] Running upgrade 780739b227a7 -&gt; 37f06a334dbf, new fields in user model
</code></pre>
<p>I hope you realize how useful it is to work with a migration framework. Any users that were in the database are still there, the migration framework surgically applies the changes in the migration script without destroying any data.</p>
<p>For the next step, I'm going to add these two new fields to the user profile template:</p>
<p class="code_title"><i>app/templates/user.html</i>: Show user information in user profile template</p>

<pre><code class="language-python">{% extends &quot;base.html&quot; %}

{% block content %}
    &lt;table&gt;
        &lt;tr valign=&quot;top&quot;&gt;
            &lt;td&gt;&lt;img src=&quot;{{ user.avatar(128) }}&quot;&gt;&lt;/td&gt;
            &lt;td&gt;
                &lt;h1&gt;User: {{ user.username }}&lt;/h1&gt;
                {% if user.about_me %}&lt;p&gt;{{ user.about_me }}&lt;/p&gt;{% endif %}
                {% if user.last_seen %}&lt;p&gt;Last seen on: {{ user.last_seen }}&lt;/p&gt;{% endif %}
            &lt;/td&gt;
        &lt;/tr&gt;
    &lt;/table&gt;
    ...
{% endblock %}
</code></pre>
<p>Note that I'm wrapping these two fields in Jinja2's conditionals, because I only want them to be visible if they are set. At this point these two new fields are empty for all users, so you are not going to see these fields if you run the application now.</p>
<h2>Recording The Last Visit Time For a User</h2>
<p>Let's start with the <code>last_seen</code> field, which is the easier of the two. What I want to do is write the current time on this field for a given user whenever that user sends a request to the server.</p>
<p>Adding the login to set this field on every possible view function that can be requested from the browser is obviously impractical, but executing a bit of generic logic ahead of a request being dispatched to a view function is such a common task in web applications that Flask offers it as a native feature. Take a look at the solution:</p>
<p class="code_title"><i>app/routes.py</i>: Record time of last visit</p>

<pre><code class="language-python">from datetime import datetime

@app.before_request
def before_request():
    if current_user.is_authenticated:
        current_user.last_seen = datetime.utcnow()
        db.session.commit()
</code></pre>
<p>The <code>@before_request</code> decorator from Flask register the decorated function to be executed right before the view function. This is extremely useful because now I can insert code that I want to execute before any view function in the application, and I can have it in a single place. The implementation simply checks if the <code>current_user</code> is logged in, and in that case sets the <code>last_seen</code> field to the current time. I mentioned this before, a server application needs to work in consistent time units, and the standard practice is to use the UTC time zone. Using the local time of the system is not a good idea, because then what goes in the database is dependent on your location. The last step is to commit the database session, so that the change made above is written to the database. If you are wondering why there is no <code>db.session.add()</code> before the commit, consider that when you reference <code>current_user</code>, Flask-Login will invoke the user loader callback function, which will run a database query that will put the target user in the database session. So you can add the user again in this function, but it is not necessary because it is already there.</p>
<p>If you view your profile page after you make this change, you will see the "Last seen on" line with a time that is very close to the current time. And if you navigate away from the profile page and then return, you will see that the time is constantly updated.</p>
<p>The fact that I'm storing these timestamps in the UTC timezone makes the time displayed on the profile page also be in UTC. In addition to that, the format of the time is not what you would expect, since it is actually the internal representation of the Python datetime object. For now, I'm not going to worry about these two issues, since I'm going to address the topic of handling dates and times in a web application in a later chapter.</p>
<p><img alt="Last Seen Time" src="../../../static/images/mega-tutorial/ch06-last-seen.png" /></p>
<h2>Profile Editor</h2>
<p>I also need to give users a form in which they can enter some information about themselves. The form is going to let users change their username, and also write something about themselves, to be stored in the new <code>about_me</code> field. Let's start writing a form class for it:</p>
<p class="code_title"><i>app/forms.py</i>: Profile editor form</p>

<pre><code class="language-python">from wtforms import StringField, TextAreaField, SubmitField
from wtforms.validators import DataRequired, Length

# ...

class EditProfileForm(FlaskForm):
    username = StringField('Username', validators=[DataRequired()])
    about_me = TextAreaField('About me', validators=[Length(min=0, max=140)])
    submit = SubmitField('Submit')
</code></pre>
<p>I'm using a new field type and a new validator in this form. For the "About" field I'm using a <code>TextAreaField</code>, which is a multi-line box in which the user can enter text. To validate this field I'm using <code>Length</code>, which will make sure that the text entered is between 0 and 140 characters, which is the space I have allocated for the corresponding field in the database.</p>
<p>The template that renders this form is shown below:</p>
<p class="code_title"><i>app/templates/edit_profile.html</i>: Profile editor form</p>

<pre><code class="language-html">{% extends &quot;base.html&quot; %}

{% block content %}
    &lt;h1&gt;Edit Profile&lt;/h1&gt;
    &lt;form action=&quot;&quot; method=&quot;post&quot;&gt;
        {{ form.hidden_tag() }}
        &lt;p&gt;
            {{ form.username.label }}&lt;br&gt;
            {{ form.username(size=32) }}&lt;br&gt;
            {% for error in form.username.errors %}
            &lt;span style=&quot;color: red;&quot;&gt;[{{ error }}]&lt;/span&gt;
            {% endfor %}
        &lt;/p&gt;
        &lt;p&gt;
            {{ form.about_me.label }}&lt;br&gt;
            {{ form.about_me(cols=50, rows=4) }}&lt;br&gt;
            {% for error in form.about_me.errors %}
            &lt;span style=&quot;color: red;&quot;&gt;[{{ error }}]&lt;/span&gt;
            {% endfor %}
        &lt;/p&gt;
        &lt;p&gt;{{ form.submit() }}&lt;/p&gt;
    &lt;/form&gt;
{% endblock %}
</code></pre>
<p>And finally, here is the view function that ties everything together:</p>
<p class="code_title"><i>app/routes.py</i>: Edit profile view function</p>

<pre><code class="language-python">from app.forms import EditProfileForm

@app.route('/edit_profile', methods=['GET', 'POST'])
@login_required
def edit_profile():
    form = EditProfileForm()
    if form.validate_on_submit():
        current_user.username = form.username.data
        current_user.about_me = form.about_me.data
        db.session.commit()
        flash('Your changes have been saved.')
        return redirect(url_for('edit_profile'))
    elif request.method == 'GET':
        form.username.data = current_user.username
        form.about_me.data = current_user.about_me
    return render_template('edit_profile.html', title='Edit Profile',
                           form=form)
</code></pre>
<p>This view function processes the form in a slightly different way. If <code>validate_on_submit()</code> returns <code>True</code> I copy the data from the form into the user object and then write the object to the database. But when <code>validate_on_submit()</code> returns <code>False</code> it can be due to two different reasons. First, it can be because the browser just sent a <code>GET</code> request, which I need to respond by providing an initial version of the form template. It can also be when the browser sends a <code>POST</code> request with form data, but something in that data is invalid. For this form, I need to treat these two cases separately. When the form is being requested for the first time with a <code>GET</code> request, I want to pre-populate the fields with the data that is stored in the database, so I need to do the reverse of what I did on the submission case and move the data stored in the user fields to the form, as this will ensure that those form fields have the current data stored for the user. But in the case of a validation error I do not want to write anything to the form fields, because those were already populated by WTForms. To distinguish between these two cases, I check <code>request.method</code>, which will be <code>GET</code> for the initial request, and <code>POST</code> for a submission that failed validation.</p>
<p><img alt="User Profile Editor" src="../../../static/images/mega-tutorial/ch06-edit-profile.png" /></p>
<p>To make it easy for users to access the profile editor page, I can add a link in their profile page:</p>
<p class="code_title"><i>app/templates/user.html</i>: Edit profile link</p>

<pre><code class="language-html">                {% if user == current_user %}
                &lt;p&gt;&lt;a href=&quot;{{ url_for('edit_profile') }}&quot;&gt;Edit your profile&lt;/a&gt;&lt;/p&gt;
                {% endif %}
</code></pre>
<p>Pay attention to the clever conditional I'm using to make sure that the Edit link appears when you are viewing your own profile, but not when you are viewing the profile of someone else.</p>
<p><img alt="User Profile Page with Edit Link" src="../../../static/images/mega-tutorial/ch06-user-profile-link.png" /></p></div>

<div class="card patreon-bar">
  <div class="card-body">
    <h5>Become a Patron!</h5>
    <p class="card-text">Hello, and thank you for visiting my blog! If you enjoyed this article, please consider supporting my work on this blog on <a href="https://patreon.com/miguelgrinberg">Patreon</a>!</p>
    <a href="https://patreon.com/miguelgrinberg" alt="Become a Patron!" title="Become a Patron!"><img src="../../../static/patreon-button.png"></a>
  </div>
</div>


<div class="card social-bar">
  <div class="card-body">
    <h5>Share this post:</h5>
      <!-- Sharingbutton Hacker News -->
      <a class="resp-sharing-button__link" href="https://news.ycombinator.com/submitlink?u=https%3A//blog.miguelgrinberg.com/post/the-flask-mega-tutorial-part-vi-profile-page-and-avatars-2018&amp;t=The%20Flask%20Mega-Tutorial%20Part%20VI%3A%20Profile%20Page%20and%20Avatars%20%282018%29" target="_blank" rel="noopener" aria-label="Hacker News">
        <div class="resp-sharing-button resp-sharing-button--hackernews resp-sharing-button--medium"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 140 140"><path fill-rule="evenodd" d="M60.94 82.314L17 0h20.08l25.85 52.093c.397.927.86 1.888 1.39 2.883.53.994.995 2.02 1.393 3.08.265.4.463.764.596 1.095.13.334.262.63.395.898.662 1.325 1.26 2.618 1.79 3.877.53 1.26.993 2.42 1.39 3.48 1.06-2.254 2.22-4.673 3.48-7.258 1.26-2.585 2.552-5.27 3.877-8.052L103.49 0h18.69L77.84 83.308v53.087h-16.9v-54.08z"></path></svg></div>Hacker News</div>
      </a>

      <!-- Sharingbutton Reddit -->
      <a class="resp-sharing-button__link" href="https://reddit.com/submit/?url=https%3A//blog.miguelgrinberg.com/post/the-flask-mega-tutorial-part-vi-profile-page-and-avatars-2018&amp;resubmit=true&amp;title=The%20Flask%20Mega-Tutorial%20Part%20VI:%20Profile%20Page%20and%20Avatars%20(2018)" target="_blank" rel="noopener" aria-label="Reddit">
        <div class="resp-sharing-button resp-sharing-button--reddit resp-sharing-button--medium"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M24 11.5c0-1.65-1.35-3-3-3-.96 0-1.86.48-2.42 1.24-1.64-1-3.75-1.64-6.07-1.72.08-1.1.4-3.05 1.52-3.7.72-.4 1.73-.24 3 .5C17.2 6.3 18.46 7.5 20 7.5c1.65 0 3-1.35 3-3s-1.35-3-3-3c-1.38 0-2.54.94-2.88 2.22-1.43-.72-2.64-.8-3.6-.25-1.64.94-1.95 3.47-2 4.55-2.33.08-4.45.7-6.1 1.72C4.86 8.98 3.96 8.5 3 8.5c-1.65 0-3 1.35-3 3 0 1.32.84 2.44 2.05 2.84-.03.22-.05.44-.05.66 0 3.86 4.5 7 10 7s10-3.14 10-7c0-.22-.02-.44-.05-.66 1.2-.4 2.05-1.54 2.05-2.84zM2.3 13.37C1.5 13.07 1 12.35 1 11.5c0-1.1.9-2 2-2 .64 0 1.22.32 1.6.82-1.1.85-1.92 1.9-2.3 3.05zm3.7.13c0-1.1.9-2 2-2s2 .9 2 2-.9 2-2 2-2-.9-2-2zm9.8 4.8c-1.08.63-2.42.96-3.8.96-1.4 0-2.74-.34-3.8-.95-.24-.13-.32-.44-.2-.68.15-.24.46-.32.7-.18 1.83 1.06 4.76 1.06 6.6 0 .23-.13.53-.05.67.2.14.23.06.54-.18.67zm.2-2.8c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm5.7-2.13c-.38-1.16-1.2-2.2-2.3-3.05.38-.5.97-.82 1.6-.82 1.1 0 2 .9 2 2 0 .84-.53 1.57-1.3 1.87z"/></svg></div>Reddit</div>
      </a>

      <!-- Sharingbutton Twitter -->
      <a class="resp-sharing-button__link" href="https://twitter.com/intent/tweet/?text=The%20Flask%20Mega-Tutorial%20Part%20VI%3A%20Profile%20Page%20and%20Avatars%20%282018%29&amp;url=https%3A//blog.miguelgrinberg.com/post/the-flask-mega-tutorial-part-vi-profile-page-and-avatars-2018" target="_blank" rel="noopener" aria-label="Twitter">
        <div class="resp-sharing-button resp-sharing-button--twitter resp-sharing-button--medium"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M23.44 4.83c-.8.37-1.5.38-2.22.02.93-.56.98-.96 1.32-2.02-.88.52-1.86.9-2.9 1.1-.82-.88-2-1.43-3.3-1.43-2.5 0-4.55 2.04-4.55 4.54 0 .36.03.7.1 1.04-3.77-.2-7.12-2-9.36-4.75-.4.67-.6 1.45-.6 2.3 0 1.56.8 2.95 2 3.77-.74-.03-1.44-.23-2.05-.57v.06c0 2.2 1.56 4.03 3.64 4.44-.67.2-1.37.2-2.06.08.58 1.8 2.26 3.12 4.25 3.16C5.78 18.1 3.37 18.74 1 18.46c2 1.3 4.4 2.04 6.97 2.04 8.35 0 12.92-6.92 12.92-12.93 0-.2 0-.4-.02-.6.9-.63 1.96-1.22 2.56-2.14z"/></svg></div>Twitter</div>
      </a>

      <!-- Sharingbutton LinkedIn -->
      <a class="resp-sharing-button__link" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3A//blog.miguelgrinberg.com/post/the-flask-mega-tutorial-part-vi-profile-page-and-avatars-2018&amp;title=The%20Flask%20Mega-Tutorial%20Part%20VI%3A%20Profile%20Page%20and%20Avatars%20%282018%29&amp;summary=The%20Flask%20Mega-Tutorial%20Part%20VI%3A%20Profile%20Page%20and%20Avatars%20%282018%29&amp;source=https%3A//blog.miguelgrinberg.com/post/the-flask-mega-tutorial-part-vi-profile-page-and-avatars-2018" target="_blank" rel="noopener" aria-label="LinkedIn">
        <div class="resp-sharing-button resp-sharing-button--linkedin resp-sharing-button--medium"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M6.5 21.5h-5v-13h5v13zM4 6.5C2.5 6.5 1.5 5.3 1.5 4s1-2.4 2.5-2.4c1.6 0 2.5 1 2.6 2.5 0 1.4-1 2.5-2.6 2.5zm11.5 6c-1 0-2 1-2 2v7h-5v-13h5V10s1.6-1.5 4-1.5c3 0 5 2.2 5 6.3v6.7h-5v-7c0-1-1-2-2-2z"/></svg></div>LinkedIn</div>
      </a>

      <!-- Sharingbutton Facebook -->
      <a class="resp-sharing-button__link" href="https://facebook.com/sharer/sharer.php?u=https%3A//blog.miguelgrinberg.com/post/the-flask-mega-tutorial-part-vi-profile-page-and-avatars-2018" target="_blank" rel="noopener" aria-label="Facebook">
        <div class="resp-sharing-button resp-sharing-button--facebook resp-sharing-button--medium"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18.77 7.46H14.5v-1.9c0-.9.6-1.1 1-1.1h3V.5h-4.33C10.24.5 9.5 3.44 9.5 5.32v2.15h-3v4h3v12h5v-12h3.85l.42-4z"/></svg></div>Facebook</div>
      </a>

      <!-- Sharingbutton E-Mail -->
      <a class="resp-sharing-button__link" href="mailto:?subject=The%20Flask%20Mega-Tutorial%20Part%20VI%3A%20Profile%20Page%20and%20Avatars%20%282018%29&amp;body=https%3A//blog.miguelgrinberg.com/post/the-flask-mega-tutorial-part-vi-profile-page-and-avatars-2018" target="_self" rel="noopener" aria-label="E-Mail">
        <div class="resp-sharing-button resp-sharing-button--email resp-sharing-button--medium"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M22 4H2C.9 4 0 4.9 0 6v12c0 1.1.9 2 2 2h20c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zM7.25 14.43l-3.5 2c-.08.05-.17.07-.25.07-.17 0-.34-.1-.43-.25-.14-.24-.06-.55.18-.68l3.5-2c.24-.14.55-.06.68.18.14.24.06.55-.18.68zm4.75.07c-.1 0-.2-.03-.27-.08l-8.5-5.5c-.23-.15-.3-.46-.15-.7.15-.22.46-.3.7-.14L12 13.4l8.23-5.32c.23-.15.54-.08.7.15.14.23.07.54-.16.7l-8.5 5.5c-.08.04-.17.07-.27.07zm8.93 1.75c-.1.16-.26.25-.43.25-.08 0-.17-.02-.25-.07l-3.5-2c-.24-.13-.32-.44-.18-.68s.44-.32.68-.18l3.5 2c.24.13.32.44.18.68z"/></svg></div>E-Mail</div>
      </a>

  </div>
</div>

<div id="comments" class="post-comment-count">
  
  <a class="btn btn-outline-secondary" href="../../the-flask-mega-tutorial-part-vi-profile-page-and-avatars-2018.html#comments">220 comments</a>
  
</div>


<div class="comments">
  <ul>
    
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/993b1a08d247e51897a9e9859dd0901d?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#101</span> <span class="badge text-bg-warning">midhat</span> said
    
    <span class="flask-moment" data-timestamp="2019-03-18T07:40:03Z" data-function="fromNow" data-refresh="0" style="display: none">2019-03-18T07:40:03Z</span>
  </p>
  <div>
    <p>Thank you Miguel,You Are Osm And this site is very useful for my project ,Thanks a lot</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/89cf471f312af4808b2eb0eff0935021?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#102</span> <span class="badge text-bg-warning">Steve D.</span> said
    
    <span class="flask-moment" data-timestamp="2019-04-09T14:59:09Z" data-function="fromNow" data-refresh="0" style="display: none">2019-04-09T14:59:09Z</span>
  </p>
  <div>
    <p>When I test out the edit_profile and add some About Me text and click Submit, the value is not persisted. I've compared my code to yours and am not seeing my error. The previous section with the last_seen date works, so the database changes were pushed.</p>
<p>Any idea what could be causing this would be greatly appreciated. Also very clear tutorials to this point.</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/729e26a2a2c7ff24a71958d4aa4e5f35?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#103</span> <span class="badge text-bg-danger">Miguel Grinberg</span> said
    
    <span class="flask-moment" data-timestamp="2019-04-09T18:37:56Z" data-function="fromNow" data-refresh="0" style="display: none">2019-04-09T18:37:56Z</span>
  </p>
  <div>
    <p>@Steve: If you have the db.session.commit() call, then all I can suggest is that you add some print statements in your route handler function to confirm that you are setting the correct values in the attributes of the User object.</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/89cf471f312af4808b2eb0eff0935021?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#104</span> <span class="badge text-bg-warning">Steve D.</span> said
    
    <span class="flask-moment" data-timestamp="2019-04-10T14:48:46Z" data-function="fromNow" data-refresh="0" style="display: none">2019-04-10T14:48:46Z</span>
  </p>
  <div>
    <p>Thank you, not sure why I didn't think to do that... On edit_profile.html, I forgot the o in method="post" so it went to the elif instead.</p>
<p>Back to forward progress!</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/4c8e605f6ec0e6c0afa467ed5fc76db6?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#105</span> <span class="badge text-bg-warning">Labhrás</span> said
    
    <span class="flask-moment" data-timestamp="2019-04-16T21:46:50Z" data-function="fromNow" data-refresh="0" style="display: none">2019-04-16T21:46:50Z</span>
  </p>
  <div>
    <p>Hello Miguel,</p>
<p>Thanks for the tutorial.</p>
<p>I've a python coding question. <br>
In the edit_profile method, the username is set as follows:<br>
form.username.data = current_user.username<br>
The username is a Class variable set in the EditProfileForm class. Does .data correspond to the DataRequired() used when setting the username? i.e.<br>
username = StringField('Username', validators=[DataRequired()])</p>
<p>I also see it used here to validate the email:<br>
user = User.query.filter_by(email=email.data).first()</p>
<p>So when validating data fields, the DataRequired class needs to be invoked through .data, is that right?</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/729e26a2a2c7ff24a71958d4aa4e5f35?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#106</span> <span class="badge text-bg-danger">Miguel Grinberg</span> said
    
    <span class="flask-moment" data-timestamp="2019-04-17T07:11:29Z" data-function="fromNow" data-refresh="0" style="display: none">2019-04-17T07:11:29Z</span>
  </p>
  <div>
    <p>@Labhrás: WTForms does some advanced techniques. You are correct that the username attribute is a class variable, but when a form object is instantiated those class attributes are overriden, so form.username does not really refer to the class variable but to an instance variable of that particular form object. Think of the class variables as sort of a "template" that helps WTForms know what attributes to define in your form objects. This technique is also used by SQLAlchemy, by the way.</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/37928e7522dbe341e9d92e7ba8ee0e7b?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#107</span> <span class="badge text-bg-warning">John Ingles</span> said
    
    <span class="flask-moment" data-timestamp="2019-04-24T21:20:19Z" data-function="fromNow" data-refresh="0" style="display: none">2019-04-24T21:20:19Z</span>
  </p>
  <div>
    <p>Any advice for performing migrations when using Mongodb?  I've found your tutorial very helpful, but I'm using mongoengine instead of SQLAlchemy.</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/729e26a2a2c7ff24a71958d4aa4e5f35?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#108</span> <span class="badge text-bg-danger">Miguel Grinberg</span> said
    
    <span class="flask-moment" data-timestamp="2019-04-24T21:53:02Z" data-function="fromNow" data-refresh="0" style="display: none">2019-04-24T21:53:02Z</span>
  </p>
  <div>
    <p>@John: Unfortunately I do not have experience with any migration tool for MongoDB, but searching on PyPI there are a couple, so you may want to give those a try.</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/fceee9ebd5baeacd2f26d6dfcb5d62d4?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#109</span> <span class="badge text-bg-warning">Wolfgang Kittenberger</span> said
    
    <span class="flask-moment" data-timestamp="2019-05-21T14:17:00Z" data-function="fromNow" data-refresh="0" style="display: none">2019-05-21T14:17:00Z</span>
  </p>
  <div>
    <p>Hello Miguel,</p>
<p>The structure of the code in this tutorial is great! I really like it!!! Anyway, I have two proposals: In many years of programming I have learned to use named constants for values which are distributed over different files, e.g. in this tutorial the size of the username field in modules, templates,... So I created a file in the base directory:</p>
<pre><code>/<a href="http://consts.py/" rel="nofollow">consts.py</a>:
class CONSTS(object):
    USERNAME          = 64
    EMAIL             = 120
    PASSWORD          = 64
    PASSWORD_HASH     = 12
....
</code></pre>
<p>This file gets imported in app/<strong>init</strong>.py with</p>
<pre><code>from consts import CONSTS
</code></pre>
<p>Now I can set the size of the db.Column's with named constants, e.g.:</p>
<pre><code>app/<a href="http://models.py/" rel="nofollow">models.py</a>
from app import CONSTS
....
class User(UserMixin, db.Model):
    __tablename__ = 'users'
    id = db.Column(db.Integer, primary_key=True)
    username = db.Column(db.String(CONSTS.USERNAME), index=True, unique=True)
    email = db.Column(db.String(CONSTS.EMAIL), index=True, unique=True)
    password_hash = db.Column(db.String(CONSTS.PASSWORD_HASH))
....
</code></pre>
<p>And I can also forward the size constants to the templates.  For this I have to adapt the routes code and use an additional keyword parameter CONSTS in the call to the render_template function:</p>
<pre><code>app/<a href="http://routes.py/" rel="nofollow">routes.py</a>:
....
from app import CONSTS
....
@app.route('/login', methods=['GET', 'POST'])
def login():
if current_user.is_authenticated:
    return redirect(url_for('index'))
form = LoginForm()
....
return render_template('login.html', title='Sign In', form=form, CONSTS=CONSTS)
</code></pre>
<p>And here comes the second proposal: modify the rendering of the form fields to use DRY. I defined a jinja macro:</p>
<pre><code>app/templates/_render_with_size.html:
{% macro render_with_size(field, field_size) %}
  &lt;p&gt;
    {{ field.label }} &lt;br&gt;
    {{ field(size=field_size) }} &lt;br&gt;
    {% for error in field.errors %}
      &lt;span style="color:red;"&gt;{{ error }}&lt;/span&gt;
    {% endfor %}
  &lt;/p&gt;
{% endmacro %}
</code></pre>
<p>Finally, I can simplify the templates with this macro and use the field size constants, e.g.:</p>
<pre><code>app/templates/login.html:
{% from "_render_with_size.html" import render_with_size %}

{% extends "base.html" %}

{% block content %}
  &lt;h1&gt;Sign In&lt;/h1&gt;
  &lt;form action="" method="post" novalidate&gt;
    {{ form.hidden_tag() }}
    &lt;form action="" method="post" novalidate&gt;
      {{ form.hidden_tag() }}
      {{ render_with_size(form.username, CONSTS.USERNAME) }}
      {{ render_with_size(form.password, CONSTS.PASSWORD) }}
    &lt;p&gt;{{ form.remember_me() }} {{ form.remember_me.label }}&lt;/p&gt;
    &lt;p&gt;{{ form.submit() }}&lt;/p&gt;
  &lt;/form&gt;
  &lt;p&gt;New User? &lt;a href="{{ url_for('register') }}"&gt;Click to Register!&lt;/a&gt;&lt;/p&gt;
{% endblock %}
</code></pre>
<p>Sorry for the lengthy message and best regards</p>
<p>Wolfgang</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/12450a7aa794d06550d344e2f7963b0d?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#110</span> <span class="badge text-bg-warning">Anthony</span> said
    
    <span class="flask-moment" data-timestamp="2019-06-14T22:29:41Z" data-function="fromNow" data-refresh="0" style="display: none">2019-06-14T22:29:41Z</span>
  </p>
  <div>
    <p>Question:</p>
<p>Why don't we have to import before_request from flask_login ? </p>
<p>Seems the same as using login_required and for that we had to import it?</p>
<p>thanks!</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/729e26a2a2c7ff24a71958d4aa4e5f35?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#111</span> <span class="badge text-bg-danger">Miguel Grinberg</span> said
    
    <span class="flask-moment" data-timestamp="2019-06-15T10:21:37Z" data-function="fromNow" data-refresh="0" style="display: none">2019-06-15T10:21:37Z</span>
  </p>
  <div>
    <p>@Anthony: before_request comes from Flask, not Flask-Login. It is an attribute of the Flask object.</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/f9cc59b3ab2d759573a0feee435ec383?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#112</span> <span class="badge text-bg-warning">Cem</span> said
    
    <span class="flask-moment" data-timestamp="2019-07-12T20:35:25Z" data-function="fromNow" data-refresh="0" style="display: none">2019-07-12T20:35:25Z</span>
  </p>
  <div>
    <p>Hello Miguel. You have a great tutorial here. <br>
I have a question about the part you use the user.avatar(128)<br>
instead of calling a function of the user object wouldn't it be better practice to call the avatar as an attribute of user object it would be better to save the result of avatar object to database as avatar attribute and call so we would not have to execute and wait for the result of the avatar function and that would be faster ( in ideal case).<br>
I used .net MVC for a long time and have never seen the usage of function in the HTML part. <br>
Thank you.</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/729e26a2a2c7ff24a71958d4aa4e5f35?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#113</span> <span class="badge text-bg-danger">Miguel Grinberg</span> said
    
    <span class="flask-moment" data-timestamp="2019-07-13T15:36:03Z" data-function="fromNow" data-refresh="0" style="display: none">2019-07-13T15:36:03Z</span>
  </p>
  <div>
    <p>@Cem: I wouldn't call it a better practice. Generating an md5 hash is a relatively cheap operation, but if you prefer to store it in the database that's fine, I don't see a problem with it. You'll just need to remember to update the hash when/if the email changes.</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/f56a2e49c321b2361e43824889e01ca3?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#114</span> <span class="badge text-bg-warning">rafcio</span> said
    
    <span class="flask-moment" data-timestamp="2019-07-23T14:59:04Z" data-function="fromNow" data-refresh="0" style="display: none">2019-07-23T14:59:04Z</span>
  </p>
  <div>
    <p>Very great tutorial. Great explanation, and you explained each themat in  details what very often is ignorring in tutorials.</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/da56f787ef0ce42e3ad8d2a0e81c1054?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#115</span> <span class="badge text-bg-warning">Faris</span> said
    
    <span class="flask-moment" data-timestamp="2019-07-23T23:53:26Z" data-function="fromNow" data-refresh="0" style="display: none">2019-07-23T23:53:26Z</span>
  </p>
  <div>
    <p>Hi Miguel, I've been following this tutorial from the beginning and I have to say you do a very, very good job! Everything is making sense so far and I'm not feeling overwhelmed! Great work!</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/7905d373cfab2e0fda04b9e7acc8c879?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#116</span> <span class="badge text-bg-warning">Squirrel</span> said
    
    <span class="flask-moment" data-timestamp="2019-07-29T08:39:07Z" data-function="fromNow" data-refresh="0" style="display: none">2019-07-29T08:39:07Z</span>
  </p>
  <div>
    <p>Great tutorial!<br>
Just a question. Updating the date and time last seen also works implemented in the load_user function in <a href="http://models.py/" rel="nofollow">models.py</a>.<br>
Is this a worse way to do it than using before_request?</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/729e26a2a2c7ff24a71958d4aa4e5f35?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#117</span> <span class="badge text-bg-danger">Miguel Grinberg</span> said
    
    <span class="flask-moment" data-timestamp="2019-07-29T18:16:37Z" data-function="fromNow" data-refresh="0" style="display: none">2019-07-29T18:16:37Z</span>
  </p>
  <div>
    <p>@Squirrel: In terms of correctness, I think I prefer doing it in before_request. The user_loader function is called the first time current_user is referenced, so if you have a route that does not need current_user at all then the update will not happen.</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/6f6a8ff267efe1de98456f8c95b9b39e?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#118</span> <span class="badge text-bg-warning">Julian</span> said
    
    <span class="flask-moment" data-timestamp="2019-08-02T18:38:07Z" data-function="fromNow" data-refresh="0" style="display: none">2019-08-02T18:38:07Z</span>
  </p>
  <div>
    <p>Hi,</p>
<p>when changing the profiles username it does not check if the username already exists, which causes a duplicate in the database, which causes an error if the db is configured in a way that doesn't permit duplicate entries.</p>
<p>Also another thing: In user.html we are checking if user == current_user, which seems redundant given that the pages requirees login and therefore user == current_user, or am I wrong?</p>
<p>The tutorial is perfect. Code is very clean.</p>
<p>Another question: In <a href="http://forms.py/" rel="nofollow">forms.py</a>, we have two functions, validate_username and validate_email, which are not called from <a href="http://routes.py/" rel="nofollow">routes.py</a>, but they are checked nevertheless. I was wondering if flask_wtf calls those methods?<br>
Could I for example just implement validate_old_password(..)? <br>
I can try it just out.</p>
<p>Thanks again for the tut.</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/729e26a2a2c7ff24a71958d4aa4e5f35?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#119</span> <span class="badge text-bg-danger">Miguel Grinberg</span> said
    
    <span class="flask-moment" data-timestamp="2019-08-02T21:46:00Z" data-function="fromNow" data-refresh="0" style="display: none">2019-08-02T21:46:00Z</span>
  </p>
  <div>
    <p>@Julian: the username duplicates is done on purpose to set the stage for the next chapter which is about error handling.</p>
<p>The "user == current_user" check is to determine if you are viewing your own profile page, or that of some other user. The Edit link only appears when you view your own profile, for example.</p>
<p>The validate_ methods are a way to define custom validation procedures in WTForms and Flask-WTF. You can add validations for any fields in this way. These methods are called by WTForms during form validation, they are not called by the application.</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/5de618642508d383f5e838a812aba287?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#120</span> <span class="badge text-bg-warning">Emmanuel</span> said
    
    <span class="flask-moment" data-timestamp="2019-09-20T05:41:54Z" data-function="fromNow" data-refresh="0" style="display: none">2019-09-20T05:41:54Z</span>
  </p>
  <div>
    <p>Hello Miguel, I am struggling to understand why 'form' object in  "form = EditProfileForm()" on the 4th line in the code below does not get reassigned when request.method == POST so that validate_on_submit would ALWAYS return false.</p>
<p>from app.forms import EditProfileForm     </p>
<p>@app.route('/edit_profile', methods=['GET', 'POST'])<br>
@login_required<br>
def edit_profile():<br>
    form = EditProfileForm()<br>
    if form.validate_on_submit():<br>
        current_user.username = form.username.data<br>
        current_user.about_me = form.about_me.data<br>
        db.session.commit()<br>
        flash('Your changes have been saved.')<br>
        return redirect(url_for('edit_profile'))<br>
    elif request.method == 'GET':<br>
        form.username.data = current_user.username<br>
        form.about_me.data = current_user.about_me<br>
    return render_template('edit_profile.html', title='Edit Profile',<br>
                           form=form)</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/729e26a2a2c7ff24a71958d4aa4e5f35?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#121</span> <span class="badge text-bg-danger">Miguel Grinberg</span> said
    
    <span class="flask-moment" data-timestamp="2019-09-21T07:15:31Z" data-function="fromNow" data-refresh="0" style="display: none">2019-09-21T07:15:31Z</span>
  </p>
  <div>
    <p>@Emmanuel: validate on submit checks two things, that the format was submitted, and that the fields all validate. Are you sure the False return is due to the form not being submitted? I bet you have a form validation problem instead. Are you using your own code or mine? Maybe download and test with my exact version of the application to see if that works better. Then you can compare it against your version to find the mistake.</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/9c87286c7bf9bc17775fe966bcd66f0e?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#122</span> <span class="badge text-bg-warning">Aniket Parkar</span> said
    
    <span class="flask-moment" data-timestamp="2019-10-10T18:17:35Z" data-function="fromNow" data-refresh="0" style="display: none">2019-10-10T18:17:35Z</span>
  </p>
  <div>
    <p>Hi Miguel,<br>
I have a question regarding post.body in template, what if I have an html text written i want it to be displayed as html not a text? Eg: One post body contains <strong> This is what is written </strong> but rest is normal. &lt;h4&gt; Again something &lt;/h4&gt;<br>
so in loop when i tried it was displayed as plane text wit bold as <b> was used prior to {{post.body}}</b></p><b>
<p>How to get entire HTML text within body displayed as HTML?</p></b>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/729e26a2a2c7ff24a71958d4aa4e5f35?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#123</span> <span class="badge text-bg-danger">Miguel Grinberg</span> said
    
    <span class="flask-moment" data-timestamp="2019-10-10T20:56:05Z" data-function="fromNow" data-refresh="0" style="display: none">2019-10-10T20:56:05Z</span>
  </p>
  <div>
    <p>@Aniket: as a security measure, Jinja2 always escapes all texts by default. If this variable that you have with HTML is safe to print as HTML, you can do so with the "safe" filter: {{ variable | safe }}. Your variable can be considered safe if the HTML in it is generated internally by your application. If the contents of the variable come from a user, then it is unsafe, so you need to sanitize it before you can consider it safe. For example, you may want to remove all &lt;script&gt; tags, etc.</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/55722269426aa4a5339b264d2e7ee970?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#124</span> <span class="badge text-bg-warning">Gabriel Podolan</span> said
    
    <span class="flask-moment" data-timestamp="2019-11-10T19:41:33Z" data-function="fromNow" data-refresh="0" style="display: none">2019-11-10T19:41:33Z</span>
  </p>
  <div>
    <p>Hi,</p>
<p>First of all, great tutorial. I'm learning a lot with it.</p>
<p>While going through this chapter I ran into an issue I'm not able to solve and I was hoping you could give me a hint on how to deal with it.</p>
<p>When I included the line <code>&lt;a href="{{ url_for('user', username=current_user.username) }}"&gt;Profile&lt;/a&gt;</code> in base.html I started getting the following traceback dump:</p>
<p><code>[2019-11-09 21:47:14,332] ERROR in app: Exception on / [GET]
Traceback (most recent call last):
  File "/Library/Python/3.7/site-packages/flask/<a href="http://app.py/" rel="nofollow">app.py</a>", line 2446, in wsgi_app
    response = self.full_dispatch_request()
  File "/Library/Python/3.7/site-packages/flask/<a href="http://app.py/" rel="nofollow">app.py</a>", line 1951, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/Library/Python/3.7/site-packages/flask/<a href="http://app.py/" rel="nofollow">app.py</a>", line 1820, in handle_user_exception
    reraise(exc_type, exc_value, tb)
  File "/Library/Python/3.7/site-packages/flask/<a href="http://_compat.py/" rel="nofollow">_compat.py</a>", line 39, in reraise
    raise value
  File "/Library/Python/3.7/site-packages/flask/<a href="http://app.py/" rel="nofollow">app.py</a>", line 1949, in full_dispatch_request
    rv = self.dispatch_request()
  File "/Library/Python/3.7/site-packages/flask/<a href="http://app.py/" rel="nofollow">app.py</a>", line 1935, in dispatch_request
    return self.view_functions[rule.endpoint](**req.view_args)
  File "/Library/Python/3.7/site-packages/flask_login/<a href="http://utils.py/" rel="nofollow">utils.py</a>", line 261, in decorated_view
    return func(*args, **kwargs)
  File "/Users/gpodolan/microblog/app/<a href="http://routes.py/" rel="nofollow">routes.py</a>", line 22, in index
    return render_template('index.html', title="Home", posts=posts)
  File "/Library/Python/3.7/site-packages/flask/<a href="http://templating.py/" rel="nofollow">templating.py</a>", line 140, in render_template
    ctx.app,
  File "/Library/Python/3.7/site-packages/flask/<a href="http://templating.py/" rel="nofollow">templating.py</a>", line 120, in _render
    rv = template.render(context)
  File "/Library/Python/3.7/site-packages/jinja2/<a href="http://asyncsupport.py/" rel="nofollow">asyncsupport.py</a>", line 76, in render
    return original_render(self, *args, **kwargs)
  File "/Library/Python/3.7/site-packages/jinja2/<a href="http://environment.py/" rel="nofollow">environment.py</a>", line 1008, in render
    return self.environment.handle_exception(exc_info, True)
  File "/Library/Python/3.7/site-packages/jinja2/<a href="http://environment.py/" rel="nofollow">environment.py</a>", line 780, in handle_exception
    reraise(exc_type, exc_value, tb)
  File "/Library/Python/3.7/site-packages/jinja2/<a href="http://_compat.py/" rel="nofollow">_compat.py</a>", line 37, in reraise
    raise value.with_traceback(tb)
  File "/Users/gpodolan/microblog/app/templates/index.html", line 1, in top-level template code
    {% extends "base.html" %}
  File "/Library/Python/3.7/site-packages/jinja2/<a href="http://environment.py/" rel="nofollow">environment.py</a>", line 1005, in render
    return concat(self.root_render_func(self.new_context(vars)))
  File "/Users/gpodolan/microblog/app/templates/index.html", line 14, in root
  File "/Users/gpodolan/microblog/app/templates/base.html", line 34, in root
  File "/Library/Python/3.7/site-packages/jinja2/<a href="http://runtime.py/" rel="nofollow">runtime.py</a>", line 262, in call
    return __obj(*args, **kwargs)
  File "/Library/Python/3.7/site-packages/flask/<a href="http://helpers.py/" rel="nofollow">helpers.py</a>", line 370, in url_for
    return appctx.app.handle_url_build_error(error, endpoint, values)
  File "/Library/Python/3.7/site-packages/flask/<a href="http://app.py/" rel="nofollow">app.py</a>", line 2215, in handle_url_build_error
    reraise(exc_type, exc_value, tb)
  File "/Library/Python/3.7/site-packages/flask/<a href="http://_compat.py/" rel="nofollow">_compat.py</a>", line 39, in reraise
    raise value
  File "/Library/Python/3.7/site-packages/flask/<a href="http://helpers.py/" rel="nofollow">helpers.py</a>", line 358, in url_for
    endpoint, values, method=method, force_external=external
  File "/Library/Python/3.7/site-packages/werkzeug/<a href="http://routing.py/" rel="nofollow">routing.py</a>", line 2020, in build
    raise BuildError(endpoint, values, method, self)
werkzeug.routing.BuildError: Could not build url for endpoint 'user' with values ['username']. Did you mean 'username' instead?</code></p>
<p>I tried googling it but could not find a solution that would work. Can you please help? I am using Python 3.7.3 and Flask 1.1.1</p>
<p>Thanks</p>
  </div>
</div>
    </li>
    
    <li>
      <div class="comment-thumbnail"><img class="rounded" src="https://gravatar.com/avatar/729e26a2a2c7ff24a71958d4aa4e5f35?s=60&amp;d=identicon"></div>
<div class="comment-body">
  
  <p>
    
    <span class="badge bg-secondary">#125</span> <span class="badge text-bg-danger">Miguel Grinberg</span> said
    
    <span class="flask-moment" data-timestamp="2019-11-10T23:21:14Z" data-function="fromNow" data-refresh="0" style="display: none">2019-11-10T23:21:14Z</span>
  </p>
  <div>
    <p>@Gabriel: Yes, the error means that the user() function is not known to Flask. This is the route function that handles the /user/&lt;username&gt; URL. If you used a different name than user() for this function, then the first argument to url_for() needs to be the name that you used.</p>
  </div>
</div>
    </li>
    
  </ul>
</div>

<nav aria-label="Page navigation">
  <ul class="pagination justify-content-center">
    <li class="page-item"><a class="page-link" href="1.html#comments">&laquo;&laquo;</a></li>
    <li class="page-item"><a class="page-link" href="4.html#comments">&laquo;</a></li>
    <li class="page-item"><a class="page-link" href="6.html#comments">&raquo;</a></li>
    <li class="page-item"><a class="page-link" href="0.html#comments">&raquo;&raquo;</a></li>
  </ul>
</nav>



<div id="comment-form">
  <h3>Leave a Comment</h3>

  
  
  

  
<form action="#comment-form" method="post">
  <input id="url" name="url" type="hidden" value="">
<input id="csrf_token" name="csrf_token" type="hidden" value="IjQyYjY5YzZlNTcyYjFkMTVlZGRkOWJjYjA3ZmFlYWFiNTg3YmU5ODki.ZxdnTg.rCF7XqIWkzscnL66t2Miwi_lnSk">
    
  <div class="mb-3">
    <label class="form-label" for="name">Name</label>
    <div class="input-group has-validation">
      <input class="form-control" id="name" name="name" required type="text" value="">
    </div>
  </div>

    
    
  <div class="mb-3">
    <label class="form-label" for="email">Email</label>
    <div class="input-group has-validation">
      <input class="form-control" id="email" name="email" required type="text" value="">
    </div>
  </div>

    
  <div class="mb-3">
    <label class="form-label" for="comment">Comment</label>
    <div class="input-group has-validation">
      <textarea class="form-control" id="comment" name="comment" required>
</textarea>
    </div>
  </div>

    
  <div class="mb-3">
    <label class="form-label" for="captcha">Captcha</label>
    <div class="input-group has-validation">
      
<script src='https://www.google.com/recaptcha/api.js' async defer></script>
<div class="g-recaptcha" data-sitekey="6Ld5Zs4SAAAAAOY0DOi4r18bgHlEaz41qAoRf__S"></div>

    </div>
  </div>

    
  <input class="btn btn-primary mb-3" id="submit" name="submit" type="submit" value="Submit">

      
</form>

</div>


</div>

      </div>
    </div>
    
    <div class="col-md-4">
      <div id="sidebar">
        
          
  



<div class="card">
  
  
  
  
  <div class="card-header">
    <div class="row">
      <div class="col">The Flask Mega-Tutorial</div>
      <div class="col text-end">
        <a href="../../announcing-the-flask-mega-tutorial-2024-edition.html">
          <h5 style="margin-bottom: 0px"><span class="badge text-bg-warning">New 2024 Edition!</span></h5>
        </a>
      </div>
    </div>
  </div>
  <a class="card-book-cover" href="https://courses.miguelgrinberg.com/p/flask-mega-tutorial">
    <img src="../../../static/mega-tutorial-2024-small.png" alt="The New Flask Mega-Tutorial">
  </a>
  <div class="card-body">
    <p class="card-text">If you would you like to support my work on my <a href="../../the-flask-mega-tutorial-part-i-hello-world.html">Flask Mega-Tutorial series</a> on this blog and as a reward have access to the complete tutorial nicely structured as a book and/or a set of videos, you can now order it from my <a href="https://courses.miguelgrinberg.com/p/flask-mega-tutorial">Courses</a> site or from <a href="https://amzn.to/3MQffrm">Amazon</a>.</p>
  </div>
  <div class="card-body">
    <a class="card-link" href="https://amzn.to/3MQffrm">Click here to get the Book!</a><br />
    <a class="card-link" href="https://courses.miguelgrinberg.com/p/flask-mega-tutorial">Click here to get the Video Course!</a>
  </div>

  
</div>
        
        <div class="card">
  <div class="card-header">About Miguel</div>
  <div class="card-body">
    <img style="float: right; margin: 0px 8px 8px 0px; padding: 4px; border: 1px solid #ccc;" src="../../../static/miguel.jpg" />
    <p class="card-text">Welcome to my blog!</p>
    <p class="card-text">I'm a software engineer and technical writer, currently living in Drogheda, Ireland.</p>
    <p class="card-text">You can also find me on <a href="https://twitter.com/miguelgrinberg">Twitter</a>, <a href="https://mstdn.social/@miguelgrinberg">Mastodon</a>, <a href="https://github.com/miguelgrinberg">Github</a>, <a href="http://www.linkedin.com/in/miguelgrinberg">LinkedIn</a>, <a href="https://youtube.com/miguelgrinberg">YouTube</a>, <a href="https://www.facebook.com/miguelgrinbergblog">Facebook</a> and <a href="https://patreon.com/miguelgrinberg">Patreon</a>.</p>
    <p class="card-text">Thank you for visiting!</p>
  </div>
</div>
        
        <div class="card" id="categories">
  <div class="card-header">Categories</div>
  <div class="card-body">
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/AI/feed"><img src="../../../static/rss-small.png" title="AI RSS Feed" label="AI RSS Feed" alt="AI RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/AI" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="AI" /> <small><em>2</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/AWS/feed"><img src="../../../static/rss-small.png" title="AWS RSS Feed" label="AWS RSS Feed" alt="AWS RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/AWS" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="AWS" /> <small><em>1</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Arduino/feed"><img src="../../../static/rss-small.png" title="Arduino RSS Feed" label="Arduino RSS Feed" alt="Arduino RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Arduino" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Arduino" /> <small><em>7</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Authentication/feed"><img src="../../../static/rss-small.png" title="Authentication RSS Feed" label="Authentication RSS Feed" alt="Authentication RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Authentication" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Authentication" /> <small><em>10</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Blog/feed"><img src="../../../static/rss-small.png" title="Blog RSS Feed" label="Blog RSS Feed" alt="Blog RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Blog" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Blog" /> <small><em>1</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/C++/feed"><img src="../../../static/rss-small.png" title="C++ RSS Feed" label="C++ RSS Feed" alt="C++ RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/C++" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="C++" /> <small><em>5</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/CSS/feed"><img src="../../../static/rss-small.png" title="CSS RSS Feed" label="CSS RSS Feed" alt="CSS RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/CSS" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="CSS" /> <small><em>1</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Cloud/feed"><img src="../../../static/rss-small.png" title="Cloud RSS Feed" label="Cloud RSS Feed" alt="Cloud RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Cloud" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Cloud" /> <small><em>10</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Database/feed"><img src="../../../static/rss-small.png" title="Database RSS Feed" label="Database RSS Feed" alt="Database RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Database" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Database" /> <small><em>22</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Docker/feed"><img src="../../../static/rss-small.png" title="Docker RSS Feed" label="Docker RSS Feed" alt="Docker RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Docker" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Docker" /> <small><em>5</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Filmmaking/feed"><img src="../../../static/rss-small.png" title="Filmmaking RSS Feed" label="Filmmaking RSS Feed" alt="Filmmaking RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Filmmaking" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Filmmaking" /> <small><em>6</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Flask/feed"><img src="../../../static/rss-small.png" title="Flask RSS Feed" label="Flask RSS Feed" alt="Flask RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Flask" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Flask" /> <small><em>126</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Games/feed"><img src="../../../static/rss-small.png" title="Games RSS Feed" label="Games RSS Feed" alt="Games RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Games" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Games" /> <small><em>1</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Heroku/feed"><img src="../../../static/rss-small.png" title="Heroku RSS Feed" label="Heroku RSS Feed" alt="Heroku RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Heroku" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Heroku" /> <small><em>1</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/IoT/feed"><img src="../../../static/rss-small.png" title="IoT RSS Feed" label="IoT RSS Feed" alt="IoT RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/IoT" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="IoT" /> <small><em>8</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/JavaScript/feed"><img src="../../../static/rss-small.png" title="JavaScript RSS Feed" label="JavaScript RSS Feed" alt="JavaScript RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/JavaScript" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="JavaScript" /> <small><em>35</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/MicroPython/feed"><img src="../../../static/rss-small.png" title="MicroPython RSS Feed" label="MicroPython RSS Feed" alt="MicroPython RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/MicroPython" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="MicroPython" /> <small><em>9</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Microdot/feed"><img src="../../../static/rss-small.png" title="Microdot RSS Feed" label="Microdot RSS Feed" alt="Microdot RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Microdot" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Microdot" /> <small><em>1</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Microservices/feed"><img src="../../../static/rss-small.png" title="Microservices RSS Feed" label="Microservices RSS Feed" alt="Microservices RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Microservices" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Microservices" /> <small><em>2</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Movie Reviews/feed"><img src="../../../static/rss-small.png" title="Movie Reviews RSS Feed" label="Movie Reviews RSS Feed" alt="Movie Reviews RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Movie Reviews" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Movie Reviews" /> <small><em>5</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/OpenStack/feed"><img src="../../../static/rss-small.png" title="OpenStack RSS Feed" label="OpenStack RSS Feed" alt="OpenStack RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/OpenStack" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="OpenStack" /> <small><em>1</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Personal/feed"><img src="../../../static/rss-small.png" title="Personal RSS Feed" label="Personal RSS Feed" alt="Personal RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Personal" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Personal" /> <small><em>3</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Photography/feed"><img src="../../../static/rss-small.png" title="Photography RSS Feed" label="Photography RSS Feed" alt="Photography RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Photography" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Photography" /> <small><em>7</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Product Reviews/feed"><img src="../../../static/rss-small.png" title="Product Reviews RSS Feed" label="Product Reviews RSS Feed" alt="Product Reviews RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Product Reviews" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Product Reviews" /> <small><em>2</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Programming/feed"><img src="../../../static/rss-small.png" title="Programming RSS Feed" label="Programming RSS Feed" alt="Programming RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Programming" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Programming" /> <small><em>187</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Project Management/feed"><img src="../../../static/rss-small.png" title="Project Management RSS Feed" label="Project Management RSS Feed" alt="Project Management RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Project Management" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Project Management" /> <small><em>1</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Python/feed"><img src="../../../static/rss-small.png" title="Python RSS Feed" label="Python RSS Feed" alt="Python RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Python" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Python" /> <small><em>169</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/REST/feed"><img src="../../../static/rss-small.png" title="REST RSS Feed" label="REST RSS Feed" alt="REST RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/REST" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="REST" /> <small><em>7</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Rackspace/feed"><img src="../../../static/rss-small.png" title="Rackspace RSS Feed" label="Rackspace RSS Feed" alt="Rackspace RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Rackspace" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Rackspace" /> <small><em>1</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Raspberry Pi/feed"><img src="../../../static/rss-small.png" title="Raspberry Pi RSS Feed" label="Raspberry Pi RSS Feed" alt="Raspberry Pi RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Raspberry Pi" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Raspberry Pi" /> <small><em>8</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/React/feed"><img src="../../../static/rss-small.png" title="React RSS Feed" label="React RSS Feed" alt="React RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/React" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="React" /> <small><em>18</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Robotics/feed"><img src="../../../static/rss-small.png" title="Robotics RSS Feed" label="Robotics RSS Feed" alt="Robotics RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Robotics" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Robotics" /> <small><em>6</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Security/feed"><img src="../../../static/rss-small.png" title="Security RSS Feed" label="Security RSS Feed" alt="Security RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Security" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Security" /> <small><em>12</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Video/feed"><img src="../../../static/rss-small.png" title="Video RSS Feed" label="Video RSS Feed" alt="Video RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Video" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Video" /> <small><em>22</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/WebSocket/feed"><img src="../../../static/rss-small.png" title="WebSocket RSS Feed" label="WebSocket RSS Feed" alt="WebSocket RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/WebSocket" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="WebSocket" /> <small><em>2</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Webcast/feed"><img src="../../../static/rss-small.png" title="Webcast RSS Feed" label="Webcast RSS Feed" alt="Webcast RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Webcast" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Webcast" /> <small><em>3</em></small>
      </form>
    </div>
    
    <div class="category">
      <a href="https://blog.miguelgrinberg.com/category/Windows/feed"><img src="../../../static/rss-small.png" title="Windows RSS Feed" label="Windows RSS Feed" alt="Windows RSS Feed" /></a>
      <form action="https://blog.miguelgrinberg.com/category/Windows" method="POST">
        <input type="submit" class="btn btn-primary btn-sm" value="Windows" /> <small><em>1</em></small>
      </form>
    </div>
    
  </div>
</div>
        
      </div>
    </div>
    
  </div>
  <div id="footer">
    
    <p>&copy; 2012-<script type="text/javascript">document.write(new Date().getFullYear());</script> by Miguel Grinberg. All rights reserved. <a href="mailto:webmaster _at_ miguelgrinberg _dot_ com">Questions?</a></p>
  </div>
</div>

  
    <script src="../../../../cdn.jsdelivr.net/npm/bootstrap%405.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
  <script type="text/javascript" src="../../../static/prettify.js"></script>
  <script src="../../../../cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.4/moment-with-locales.min.js" integrity="sha512-42PE0rd+wZ2hNXftlM78BSehIGzezNeQuzihiBCvUEB3CVxHvsShF86wBWwQORNxNINlBPuq7rG4WWhNiTVHFg==" crossorigin="anonymous"></script>

<script>
moment.locale("en");
function flask_moment_render(elem) {{
    const timestamp = moment(elem.dataset.timestamp);
    const func = elem.dataset.function;
    const format = elem.dataset.format;
    const timestamp2 = elem.dataset.timestamp2;
    const no_suffix = elem.dataset.nosuffix;
    const units = elem.dataset.units;
    let args = [];
    if (format)
        args.push(format);
    if (timestamp2)
        args.push(moment(timestamp2));
    if (no_suffix)
        args.push(no_suffix);
    if (units)
        args.push(units);
    elem.textContent = timestamp[func].apply(timestamp, args);
    elem.classList.remove('flask-moment');
    elem.style.display = "";
}}
function flask_moment_render_all() {{
    const moments = document.querySelectorAll('.flask-moment');
    moments.forEach(function(moment) {{
        flask_moment_render(moment);
        const refresh = moment.dataset.refresh;
        if (refresh && refresh > 0) {{
            (function(elem, interval) {{
                setInterval(function() {{
                    flask_moment_render(elem);
                }}, interval);
            }})(moment, refresh);
        }}
    }})
}}
document.addEventListener("DOMContentLoaded", flask_moment_render_all);
</script>

  
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-20EHZP9GRZ"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-20EHZP9GRZ');
  </script>
  
  <script type="text/javascript">
    function setThemeUI() {
      document.getElementById('select-theme-auto').classList.remove('active');
      document.getElementById('select-theme-light').classList.remove('active');
      document.getElementById('select-theme-dark').classList.remove('active');
      const theme = getPreferredTheme();
      const actualTheme = document.documentElement.getAttribute('data-bs-theme', 'light');
      document.getElementById('select-theme-' + theme).classList.add('active');
      document.getElementById('current-theme').href.baseVal = `#icon-theme-${actualTheme}`;
    };

    function updateTheme(theme) {
      if (theme === 'auto') {
        localStorage.removeItem('theme')
      }
      else {
        localStorage.setItem('theme', theme)
      }
      setTheme(getPreferredTheme());
    }

    setThemeUI();

    const darkModePreference = window.matchMedia("(prefers-color-scheme: dark)");
    darkModePreference.addEventListener("change", e => {
      if (getPreferredTheme() === 'auto') {
        setTheme('auto');
      }
    });

    document.addEventListener("DOMContentLoaded", () => {
      // add prettyprint class to all <pre><code></code></pre> blocks
      let prettify = false;
      document.querySelectorAll('div.post-body pre code').forEach((code) => {
        code.parentNode.classList.add('prettyprint');
        prettify = true;
      });
      prettyPrint();
    });
  </script>

  </body>

<!-- Mirrored from blog.miguelgrinberg.com/post/the-flask-mega-tutorial-part-vi-profile-page-and-avatars-2018/page/5 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 22 Oct 2024 08:51:01 GMT -->
</html>